import"../chunks/NZTpNUN0.js";import{z as X,A as Z,B as Y,p as g,f as C,x as E,a as c,E as B,v as P,g as n,aZ as S,F as k,G as h,c as j,s as A}from"../chunks/Br9SMxIB.js";import{d as rr,s as q}from"../chunks/BBzb7ThI.js";import{i as F}from"../chunks/CvXxFVm9.js";import{e as D,i as H}from"../chunks/D1-nhZYT.js";import{a as er,s as tr,c as nr}from"../chunks/DWdbj9D8.js";import{M as sr}from"../chunks/DKmGubEx.js";var u=(r=>(r[r.notOver=0]="notOver",r[r.winPlayer1=1]="winPlayer1",r[r.winPlayer2=2]="winPlayer2",r[r.draw=3]="draw",r))(u||{});const M=7,d=6,p=4;class ar extends Error{constructor(t){super("Can't play in column "+t)}}const J=(r,t)=>r[t].length!==d,ir=r=>{const t=M*d,e=r.reduce((l,f)=>l+f.length,0);return t===e},lr=r=>{for(let t=0;t<M;t++)for(let e=0;e<d;e++){if(r[t].length<e||!r[t][e])continue;const l=r[t][e];let f=0,y=0,v=0,w=0;for(let a=0;a<p;a++)e+a<=r[t].length&&r[t][e+a]===l&&f++,t+a<r.length&&r[t+a][e]===l&&y++,t+a<r.length&&e+a<=r[t+a].length&&r[t+a][e+a]===l&&v++,t+a<r.length&&e-a>=0&&r[t+a][e-a]===l&&w++;if(f===p||y===p||v===p||w===p)return l}return null},R=r=>{if(ir(r))return 3;const t=lr(r);return t===1?1:t===2?2:0},or=(r,t,e)=>{if(!J(r,e))throw new ar(e);return r[e].push(t),r},vr=(r,t,e)=>{A(t,Array.from({length:7},()=>[]),!0),A(e,1)};var cr=g("<button>Reset board</button>"),fr=g("<h4>Game Over</h4>"),ur=g("<h4> </h4>"),_r=(r,t,e,l)=>t(n(e),n(l)),mr=g('<div><button class="outer-cell svelte-1bdwycb"><div></div></button></div>'),hr=g('<!> <div class="main"><h3>Gravitrip</h3></div> <!> <!> <div> </div> <div class="board svelte-1bdwycb"></div>',1);function Pr(r,t){X(t,!0);let e=Z(Y(Array.from({length:7},()=>[]))),l=S(()=>R(n(e)));const f=Array.from({length:d},(s,i)=>i),y=Array.from({length:M},(s,i)=>i);let v=Z(1);const w=(s,i)=>{J(n(e),s)&&R(n(e))===u.notOver&&(A(e,or(n(e),i,s),!0),A(v,n(v)===1?2:1,!0))};var a=hr(),$=C(a);sr($,{title:"Gravitrip",description:"Gravitrip"});var z=P($,4);{var K=s=>{var i=cr();i.__click=[vr,e,v],c(s,i)};F(z,s=>{n(l)!==u.notOver&&s(K)})}var V=P(z,2);{var L=s=>{var i=fr();c(s,i)},N=s=>{var i=j(),b=C(i);{var I=_=>{var o=ur(),m=k(o);h(o),E(()=>q(m,`Player ${n(l)??""} wins`)),c(_,o)};F(b,_=>{(n(l)===u.winPlayer1||n(l)===u.winPlayer2)&&_(I)},!0)}c(s,i)};F(V,s=>{n(l)===u.draw?s(L):s(N,!1)})}var G=P(V,2),Q=k(G);h(G);var O=P(G,2);D(O,21,()=>f.reverse(),H,(s,i)=>{var b=j(),I=C(b);D(I,17,()=>y,H,(_,o)=>{var m=mr(),x=k(m);x.__click=[_r,w,o,v];var T=k(x);let W;h(x),h(m),E(U=>{tr(x,"aria-label","col-"+n(o)),W=nr(T,1,"cell svelte-1bdwycb",null,W,U)},[()=>({player1:n(e)[n(o)][n(i)]===1,player2:n(e)[n(o)][n(i)]===2})]),c(_,m)}),c(s,b)}),h(O),E(s=>{q(Q,`Board state: ${s??""}`),er(O,`--nb-col: ${M}; --nb-row: ${d}`)},[()=>R(n(e))]),c(r,a),B()}rr(["click"]);export{Pr as component};
