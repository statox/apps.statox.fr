import"../chunks/DsnmJJEf.js";import"../chunks/CrquYXKP.js";import{p as z,c as I,f as p,a as e,d as J,g as t,I as V,b as i,e as c,r as n,s as u,t as q}from"../chunks/C3-yz8dw.js";import{s as y,d as nt}from"../chunks/DUwLERL-.js";import{i as F}from"../chunks/Ceeih1bB.js";import{i as K}from"../chunks/C_vsOW3i.js";import{a as G,s as N}from"../chunks/k7vEulbC.js";import{u as Q}from"../chunks/Byefvy9Z.js";import{M as it}from"../chunks/cADELSPa.js";import{M as R}from"../chunks/BCRe70JM.js";import{a as vt}from"../chunks/BczP4ff2.js";import{e as B,i as C}from"../chunks/C63BUUd7.js";import{a as dt}from"../chunks/cHXO9EUa.js";import{g as mt,p as ct,P as pt}from"../chunks/C0Ua-Vak.js";import{D as lt}from"../chunks/CkcISRbr.js";import"../chunks/DgRn7El4.js";import{p as ft}from"../chunks/BQF7YunG.js";import{g as ut}from"../chunks/-sNYeQhT.js";var _t=i('<button class="emotion-item svelte-cyscl8"> </button>'),gt=i('<div class="selection"></div>'),$t=i('<div class="event svelte-cyscl8"><div class="event-date"> </div> <div class="event-value"> </div> <!></div>'),ht=i('<h4> </h4> <div class="event svelte-cyscl8"><div>Date</div> <div>Value</div> <div>Data</div></div> <!>',1),yt=i("<p>Loading events</p>");function bt(b,k){z(k,!1);const P=()=>G(ct,"$personalTrackerPassword",_),w=()=>G(Q,"$user",_),[_,v]=N(),g=async()=>(await mt(P())).reduce((a,o)=>(a[o.type]||(a[o.type]=[]),a[o.type].push(o),a),{});K();var l=I(),x=p(l);{var M=d=>{var a=I(),o=p(a);vt(o,g,m=>{var r=yt();e(m,r)},(m,r)=>{var s=I(),D=p(s);B(D,1,()=>Object.keys(t(r)),C,(T,O)=>{var U=ht(),L=p(U),W=c(L,!0);n(L);var X=u(L,4);B(X,1,()=>t(r)[t(O)],C,(Y,f)=>{const Z=V(()=>lt.fromSeconds(t(f).eventDateUnix).toLocal().toFormat("dd/MM/yy HH:mm"));var A=$t(),E=c(A),tt=c(E,!0);n(E);var H=u(E,2),at=c(H,!0);n(H);var et=u(H,2);{var rt=S=>{var j=gt();B(j,5,()=>t(f).data.emotions,C,(ot,$)=>{var h=_t(),st=c(h);n(h),q(()=>{dt(h,`--color: ${t($).color??""}`),y(st,`${t($).category??""}
                                    ${t($).subcategory??""}
                                    ${t($).emotion??""}`)}),e(ot,h)}),n(j),e(S,j)};F(et,S=>{typeof t(f).data=="object"&&t(f).data?.emotions&&S(rt)})}n(A),q(()=>{y(tt,t(Z)),y(at,t(f).data)}),e(Y,A)}),q(()=>y(W,t(O))),e(T,U)}),e(m,s)},(m,r)=>{{let s=V(()=>({level:"error",header:"Something went wrong getting events",message:t(r)}));R(m,{get item(){return t(s)}})}}),e(d,a)};F(x,d=>{w()&&d(M)})}e(b,l),J(),v()}var kt=i("<div><button>Add an entry</button></div> <!>",1),Pt=i("<!> <!>",1);function Ut(b,k){z(k,!1);const P=()=>G(Q,"$user",w),[w,_]=N(),v={name:"Personal Tracker",description:"Track me metrics",iconPath:"/personal_tracker.png",showAuthInHeader:!0};ft.set(v),K();var g=Pt(),l=p(g);it(l,{get title(){return v.name},get description(){return v.description},get iconPath(){return v.iconPath}});var x=u(l,2);{var M=a=>{pt(a,{children:(o,m)=>{var r=kt(),s=p(r),D=c(s);D.__click=()=>ut("/personal-tracker/add"),n(s);var T=u(s,2);bt(T,{}),e(o,r)},$$slots:{default:!0}})},d=a=>{R(a,{item:{level:"info",header:"Login to add an entry or see events"}})};F(x,a=>{P()?a(M):a(d,!1)})}e(b,g),J(),_()}nt(["click"]);export{Ut as component};
