import"../chunks/NZTpNUN0.js";import{a as xt}from"../chunks/DkK0P85K.js";import{x as St,y as J,z as ct,o as f,p as l,f as dt,s as j,v as K,a as b,B as pt,g as e,C as v,E as u}from"../chunks/DyWD_MJs.js";import{d as _t,s as yt}from"../chunks/BavMw1sQ.js";import{i as bt}from"../chunks/Do44c4MR.js";import{e as B,i as C}from"../chunks/j2-s9Gm3.js";import{r as S,a as ot}from"../chunks/BPTubluR.js";import{b as p}from"../chunks/Dr6R6WDT.js";import{P as ft}from"../chunks/3yfWr4Ty.js";class N extends Error{constructor(){super("Tried to divide by 0")}}class Q{x=0;y=0;constructor(t=0,n=0){this.x=t,this.y=n}addX(t){return this.x+=t.x,this}addY(t){return this.y+=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addScalarX(t){return this.x+=t,this}addScalarY(t){return this.y+=t,this}subtractX(t){return this.x-=t.x,this}subtractY(t){return this.y-=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}subtractScalar(t){return this.x-=t,this.y-=t,this}subtractScalarX(t){return this.x-=t,this}subtractScalarY(t){return this.y-=t,this}divideX(t){if(t.x===0)throw new N;return this.x/=t.x,this}divideY(t){if(t.y===0)throw new N;return this.y/=t.y,this}divide(t){if(t.x===0||t.y===0)throw new N;return this.x/=t.x,this.y/=t.y,this}divideScalar(t){if(t===0)throw new N;return this.x/=t,this.y/=t,this}divideScalarX(t){if(t===0)throw new N;return this.x/=t,this}divideScalarY(t){if(t===0)throw new N;return this.y/=t,this}multiplyX(t){return this.x*=t.x,this}multiplyY(t){return this.y*=t.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}multiplyScalarX(t){return this.x*=t,this}multiplyScalarY(t){return this.y*=t,this}invertX(){return this.x*=-1,this}invertY(){return this.y*=-1,this}invert(){return this.x*=-1,this.y*=-1,this}normalize(){const t=this.length();return this.divideScalar(t),this}norm=this.normalize;limit(t,n){return Math.abs(this.x)>t&&(this.x*=n),Math.abs(this.y)>t&&(this.y*=n),this}randomizeX(t,n){const a=Math.min(t.x,n.x),c=Math.max(t.x,n.x);return this.x=vt(a,c),this}randomizeY(t,n){const a=Math.min(t.y,n.y),c=Math.max(t.y,n.y);return this.y=vt(a,c),this}randomize(t,n){return this.randomizeX(t,n),this.randomizeY(t,n),this}randomizeAny(t,n){return Math.random()<.5?this.randomizeX(t,n):this.randomizeY(t,n),this}unfloat(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}toFixed(t=8){return this.x=Number(this.x.toFixed(t)),this.y=Number(this.y.toFixed(t)),this}mixX(t,n=.5){return this.x=(1-n)*this.x+n*t.x,this}mixY(t,n=.5){return this.y=(1-n)*this.y+n*t.y,this}mix(t,n=.5){return this.mixX(t,n),this.mixY(t,n),this}clone(){return new Q(this.x,this.y)}copyX(t){return this.x=t.x,this}copyY(t){return this.y=t.y,this}copy(t){return this.x=t.x,this.y=t.y,this}zero(){return this.x=0,this.y=0,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}projectOnto(t){const n=(this.x*t.x+this.y*t.y)/(t.x*t.x+t.y*t.y);return this.x=n*t.x,this.y=n*t.y,this}horizontalAngle(){return Math.atan2(this.y,this.x)}horizontalAngleDeg(){return ut(this.horizontalAngle())}verticalAngle(){return Math.atan2(this.x,this.y)}verticalAngleDeg(){return ut(this.verticalAngle())}angle=this.horizontalAngle;direction=this.horizontalAngle;angleDeg=this.horizontalAngleDeg;rotate(t){const n=this.x*Math.cos(t)-this.y*Math.sin(t),a=this.x*Math.sin(t)+this.y*Math.cos(t);return this.x=n,this.y=a,this}rotateDeg(t){const n=gt(t);return this.rotate(n)}rotateTo(t){return this.rotate(t-this.horizontalAngle())}rotateToDeg(t){const n=gt(t);return this.rotateTo(n)}distanceX(t){return this.x-t.x}absDistanceX(t){return Math.abs(this.distanceX(t))}distanceY(t){return this.y-t.y}absDistanceY(t){return Math.abs(this.distanceY(t))}distance(t){return Math.sqrt(this.distanceSq(t))}distanceSq(t){const n=this.distanceX(t),a=this.distanceY(t);return n*n+a*a}length(){return Math.sqrt(this.lengthSq())}magnitude=this.length;lengthSq(){return this.x*this.x+this.y*this.y}isZero(){return this.x===0&&this.y===0}isEqualTo(t){return this.x===t.x&&this.y===t.y}toString(){return`x: ${this.x}, y: ${this.y}`}toArray(){return[this.x,this.y]}toObject(){return{x:this.x,y:this.y}}}const mt=180/Math.PI;function vt(o,t){return Math.random()*(t-o)+o}function ut(o){return o*mt}function gt(o){return o/mt}const zt=function(o,t,n,a,c){return(o-t)/(n-t)*(c-a)+a},M=(o,t)=>Math.random()*(t-o)+o,I=[[119,114,37,250],[84,119,37,220],[112,181,21,190],[120,211,2,160],[173,211,2,130],[98,54,130,100],[153,83,198,70],[148,39,226,40],[226,39,113,10]],It=()=>{const o=[];o.push({allowOffspringBirthFactor:1,cellDeviationFactor:Number(M(.2,1).toFixed(4)),cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:15,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:Math.floor(M(2,4)),color:I[0]});for(let t=0;t<M(5,8);t++)o.push({allowOffspringBirthFactor:Number((1-t*.1).toFixed(4)),cellDeviationFactor:Number(M(.2,1).toFixed(4)),cellSizeVariationInSegment:Number(M(.93,.99).toFixed(4)),cellSpacingVariationInSegment:Number(M(.4,.6).toFixed(4)),nbCellsInSegment:Math.floor(M(2,6)),nextSegmentBaseCellSize:1,branchesMaxAngle:Math.floor(M(40,180)),nbBranches:Math.floor(M(2,4)),color:I[t+1]});return o[1].nbCellsInSegment=10,o},Bt=[{allowOffspringBirthFactor:1,cellDeviationFactor:.9,cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:25,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:I[0]},{allowOffspringBirthFactor:1,cellDeviationFactor:.9,cellSizeVariationInSegment:.985,cellSpacingVariationInSegment:.8,nbCellsInSegment:10,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[1]},{allowOffspringBirthFactor:1,cellDeviationFactor:.8,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[2]},{allowOffspringBirthFactor:.9,cellDeviationFactor:.8,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:1,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[3]},{allowOffspringBirthFactor:.8,cellDeviationFactor:.8,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.5,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:120,nbBranches:2,color:I[4]},{allowOffspringBirthFactor:.8,cellDeviationFactor:.7,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.4,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[5]},{allowOffspringBirthFactor:.7,cellDeviationFactor:.7,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:9,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:I[6]},{allowOffspringBirthFactor:.7,cellDeviationFactor:.7,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.8,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[7]},{allowOffspringBirthFactor:.7,cellDeviationFactor:.6,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[8]}];class Ct{genes;structure;constructor(){this.genes=Bt,this.structure=[]}grow(){this.structure=[];const t=[{cell:{position:new Q,size:20,color:[200,200,200,200]},agent:{level:0,levelStep:0,direction:new Q(0,20)}}];for(;t.length;){const{cell:n,agent:a}=t.shift();if(a.level===this.genes.length)continue;const{allowOffspringBirthFactor:c,cellDeviationFactor:V,cellSpacingVariationInSegment:Z,nbCellsInSegment:w,color:g,cellSizeVariationInSegment:U,nextSegmentBaseCellSize:H,branchesMaxAngle:P,nbBranches:A}=this.genes[a.level];if(a.levelStep>=w){const T=-P/2,R=P/2;for(let D=0;D<A;D++){const L=zt(D,0,A-1,T,R),tt={position:n.position.clone(),size:n.size*H,color:[200,200,200,200]},et={level:a.level+1,levelStep:0,direction:a.direction.clone().rotateDeg(L)};Math.random()<c&&t.push({cell:tt,agent:et})}continue}const q={...n,position:n.position.clone().add(a.direction.clone().rotateDeg(M(-45,45)*V).multiplyScalar(Z)),size:n.size*U,color:g},W={level:a.level,levelStep:a.levelStep+1,direction:a.direction.clone()};t.push({cell:q,agent:W}),this.structure.push(q)}}}const Mt=(o,t,n)=>{j(t,It(),!0),n()};var Ft=(o,t)=>j(t,!e(t)),wt=f('<div></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="1"/></div>',1),Vt=f('<div class="genes-container svelte-9clf4v"><div>Level</div> <div>allowOffspringBirthFactor</div> <div>cellDeviationFactor</div> <div>cellSizeVariationInSegment</div> <div>nbCellsInSegment</div> <div>cellSpacingVariationInSegment</div> <div>nextSegmentBaseCellSize</div> <div>branchesMaxAngle</div> <div>nbBranches</div> <!></div>'),At=f("<div></div>"),Dt=f('<div><input type="number" step="0.1"/></div>'),$t=f('<div><input type="number" step="0.1"/></div>'),Ot=f('<div><input type="number" step="0.1"/></div>'),Xt=f('<div><input type="number" step="1"/></div>'),Yt=f('<div><input type="number" step="0.1"/></div>'),kt=f('<div><input type="number" step="0.1"/></div>'),Nt=f('<div><input type="number" step="1"/></div>'),Pt=f('<div><input type="number" step="1"/></div>'),qt=f('<div class="genes-container-2 svelte-9clf4v"><div>Level</div> <!> <div>allowOffspringBirthFactor</div> <!> <div>cellDeviationFactor</div> <!> <div>cellSizeVariationInSegment</div> <!> <div>nbCellsInSegment</div> <!> <div>cellSpacingVariationInSegment</div> <!> <div>nextSegmentBaseCellSize</div> <!> <div>branchesMaxAngle</div> <!> <div>nbBranches</div> <!></div>'),Tt=f("<h1>Here be flowers</h1> <!> <div><h2>Plant info</h2> <div> </div></div> <span><h2>Genes</h2> <button>Change view</button></span> <button>Randomize plant</button> <!>",1);function Wt(o,t){St(t,!0);let n;const a=new Ct;let c=J(ct([...a.genes]));a.grow();let V=J(ct(a.structure.length)),Z=J(!0),w=J(0);const g=()=>{a.genes=e(c),a.grow(),j(V,a.structure.length,!0),j(w,0)},U=x=>{x.setup=()=>{n=x,x.createCanvas(1e3,1e3),x.noStroke()},x.draw=()=>{x.background(240,240,240);for(let z=0;z<e(w);z++){const F=a.structure[z],$=F.position.x+x.width/2,h=x.height-F.position.y,O=F.size;x.fill(F.color),x.circle($,h,O)}e(w)<e(V)&&j(w,Math.min(e(w)+50,e(V)),!0)}};xt(()=>{console.clear(),n?.remove()});var H=Tt(),P=l(dt(H),2);ft(P,{sketch:U});var A=l(P,2),q=l(v(A),2),W=v(q);u(q),u(A);var T=l(A,2),R=l(v(T),2);R.__click=[Ft,Z],u(T);var D=l(T,2);D.__click=[Mt,c,g];var L=l(D,2);{var tt=x=>{var z=Vt(),F=l(v(z),18);B(F,17,()=>e(c),C,($,h,O)=>{var E=wt(),X=dt(E);X.textContent=O;var Y=l(X,2),k=v(Y);S(k),k.__change=g,u(Y);var G=l(Y,2),d=v(G);S(d),d.__change=g,u(G);var s=l(G,2),y=v(s);S(y),y.__change=g,u(s);var i=l(s,2),r=v(i);S(r),r.__change=g,u(i);var m=l(i,2),nt=v(m);S(nt),nt.__change=g,u(m);var it=l(m,2),rt=v(it);S(rt),rt.__change=g,u(it);var at=l(it,2),st=v(at);S(st),st.__change=g,u(at);var ht=l(at,2),lt=v(ht);S(lt),lt.__change=g,u(ht),K(()=>ot(X,`color: ${e(h).color??""}`)),p(k,()=>e(h).allowOffspringBirthFactor,_=>e(h).allowOffspringBirthFactor=_),p(d,()=>e(h).cellDeviationFactor,_=>e(h).cellDeviationFactor=_),p(y,()=>e(h).cellSizeVariationInSegment,_=>e(h).cellSizeVariationInSegment=_),p(r,()=>e(h).nbCellsInSegment,_=>e(h).nbCellsInSegment=_),p(nt,()=>e(h).cellSpacingVariationInSegment,_=>e(h).cellSpacingVariationInSegment=_),p(rt,()=>e(h).nextSegmentBaseCellSize,_=>e(h).nextSegmentBaseCellSize=_),p(st,()=>e(h).branchesMaxAngle,_=>e(h).branchesMaxAngle=_),p(lt,()=>e(h).nbBranches,_=>e(h).nbBranches=_),b($,E)}),u(z),b(x,z)},et=x=>{var z=qt(),F=l(v(z),2);B(F,17,()=>e(c),C,(d,s,y)=>{var i=At();i.textContent=y,K(()=>ot(i,`color: ${e(s).color??""}`)),b(d,i)});var $=l(F,4);B($,17,()=>e(c),C,(d,s,y)=>{var i=Dt(),r=v(i);S(r),r.__change=g,u(i),p(r,()=>e(s).allowOffspringBirthFactor,m=>e(s).allowOffspringBirthFactor=m),b(d,i)});var h=l($,4);B(h,17,()=>e(c),C,(d,s,y)=>{var i=$t(),r=v(i);S(r),r.__change=g,u(i),p(r,()=>e(s).cellDeviationFactor,m=>e(s).cellDeviationFactor=m),b(d,i)});var O=l(h,4);B(O,17,()=>e(c),C,(d,s,y)=>{var i=Ot(),r=v(i);S(r),r.__change=g,u(i),p(r,()=>e(s).cellSizeVariationInSegment,m=>e(s).cellSizeVariationInSegment=m),b(d,i)});var E=l(O,4);B(E,17,()=>e(c),C,(d,s,y)=>{var i=Xt(),r=v(i);S(r),r.__change=g,u(i),p(r,()=>e(s).nbCellsInSegment,m=>e(s).nbCellsInSegment=m),b(d,i)});var X=l(E,4);B(X,17,()=>e(c),C,(d,s,y)=>{var i=Yt(),r=v(i);S(r),r.__change=g,u(i),p(r,()=>e(s).cellSpacingVariationInSegment,m=>e(s).cellSpacingVariationInSegment=m),b(d,i)});var Y=l(X,4);B(Y,17,()=>e(c),C,(d,s,y)=>{var i=kt(),r=v(i);S(r),r.__change=g,u(i),p(r,()=>e(s).nextSegmentBaseCellSize,m=>e(s).nextSegmentBaseCellSize=m),b(d,i)});var k=l(Y,4);B(k,17,()=>e(c),C,(d,s,y)=>{var i=Nt(),r=v(i);S(r),r.__change=g,u(i),p(r,()=>e(s).branchesMaxAngle,m=>e(s).branchesMaxAngle=m),b(d,i)});var G=l(k,4);B(G,17,()=>e(c),C,(d,s,y)=>{var i=Pt(),r=v(i);S(r),r.__change=g,u(i),p(r,()=>e(s).nbBranches,m=>e(s).nbBranches=m),b(d,i)}),u(z),K(()=>ot(z,`--nb-columns: ${1+e(c).length}`)),b(x,z)};bt(L,x=>{e(Z)?x(tt):x(et,!1)})}K(()=>yt(W,`Nb segments: ${e(V)??""}`)),b(o,H),pt()}_t(["click","change"]);export{Wt as component};
