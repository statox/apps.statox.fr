import"../chunks/NZTpNUN0.js";import{p as H,d as h,s as t,f as $,a as g,b as O,e as u,r as m,t as R,g as r,h as _,i as n,b4 as Y}from"../chunks/D6WCIunz.js";import{d as Z,s as z}from"../chunks/BCejqCpM.js";import{i as k}from"../chunks/kb571B70.js";import{r as x}from"../chunks/DTsamwDi.js";import{b as I}from"../chunks/BKTkIJ2h.js";import{s as B,a as C}from"../chunks/xyfN9_G_.js";import{a as G,g as J}from"../chunks/CFZpIX3S.js";import{u as K,b as Q,c as V}from"../chunks/DrxJRRsq.js";import{s as L}from"../chunks/LSE9fGGF.js";import{M as W}from"../chunks/BXcaCR0j.js";var X=h("<p> </p>"),ee=h('<div><section><label for="username">Username</label> <input id="username" name="username" type="text" autocomplete="username" required class="svelte-1my11jv"/></section> <section><label for="current-password">Password</label> <input id="current-password" name="password" type="password" autocomplete="current-password" required class="svelte-1my11jv"/></section> <button>Sign in</button></div> <!>',1),ae=h("<h2>Login</h2> <!>",1);function ce(S,U){H(U,!0);const l=()=>C(K,"$user",j),[j,q]=B();let p=_(""),d=_(""),o=_(void 0),c="/";G(({from:e})=>{e?.url.pathname!=="/auth/login"&&(c=e?.url.pathname||c)});const A=async()=>{try{await Q(r(p),r(d)),await V(),l()?.status=="logged_in"?(L.set(!0),setTimeout(()=>L.set(!1),2500),J(c)):n(o,new Error("Invalid password or username"),!0)}catch(e){if(e?.message==='{"message":"UNAUTHORIZED"}'){n(o,"Invalid password or username");return}n(o,e,!0)}};var b=ae(),E=t($(b),2);{var M=e=>{var s=X(),i=u(s);m(s),R(()=>z(i,`You are already logged in a ${l()?.user.username??""}`)),g(e,s)},N=e=>{var s=ee(),i=$(s),v=u(i),w=t(u(v),2);x(w),m(v);var f=t(v,2),y=t(u(f),2);x(y),m(f);var P=t(f,2);P.__click=A,m(i);var T=t(i,2);{var D=a=>{{let F=Y(()=>({level:"error",header:"Failed auth",message:r(o).toString()}));W(a,{get item(){return r(F)}})}};k(T,a=>{r(o)&&a(D)})}I(w,()=>r(p),a=>n(p,a)),I(y,()=>r(d),a=>n(d,a)),g(e,s)};k(E,e=>{l()?.status=="logged_in"?e(M):e(N,!1)})}g(S,b),O(),q()}Z(["click"]);export{ce as component};
