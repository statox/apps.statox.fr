import"../chunks/DsnmJJEf.js";import"../chunks/CbJJCuUa.js";import{p as L,b as I,e as f,s as n,a as w,d as U,i as d,h as g,g as e,aI as W,r as v,t as $,C as E,f as X,b5 as Y,j as Z}from"../chunks/BI5tnybL.js";import{i as ee}from"../chunks/BU96bRAZ.js";import{d as D,s as te}from"../chunks/BHBOcJDT.js";import{i as j}from"../chunks/BcTGm7Fo.js";import{e as H,i as P}from"../chunks/V4cWF7mx.js";import{r as F}from"../chunks/Db8wGxCz.js";import{b as A}from"../chunks/u1KJTtVJ.js";import{A as ae}from"../chunks/CuMzzfZD.js";import"../chunks/RZZgkjFT.js";import"../chunks/DKXeG7-1.js";import{U as re}from"../chunks/BWptIUEw.js";import{M as oe}from"../chunks/CU7smKQC.js";import{M as ne}from"../chunks/D4b6Boo_.js";import{M as ie}from"../chunks/CKwsCUeU.js";import{t as R}from"../chunks/DFOQ394W.js";import{a as se,b as le}from"../chunks/DLJbMfq2.js";import{g as Q}from"../chunks/DaC0mKj1.js";import{I as de}from"../chunks/C3LFI7Nl.js";import{o as ue}from"../chunks/CW6Daupv.js";import{p as ce}from"../chunks/DoQzWcsH.js";import"../chunks/D7ilm6In.js";import{p as me}from"../chunks/L3zL1n65.js";/* empty css                */var ve=I('<div class="option svelte-hwqdr1"> </div>'),pe=I('<div class="dropdown svelte-hwqdr1"></div>'),fe=I('<span><input type="text" class="svelte-hwqdr1"/> <!></span>');function ge(h,u){L(u,!0);const o=t=>t.normalize("NFD").replace(/[\u0300-\u036f]/g,"");let r=ce(u,"value",15),i=g(!1),c=W(()=>u.options.filter(t=>r().length<2?!1:o(t).toLowerCase().includes(o(r()).toLowerCase())));function b(t){r(t),d(i,!0)}const y=()=>{d(i,!1)};var _=fe(),s=f(_);F(s),s.__input=y;var p=n(s,2);{var M=t=>{var a=pe();H(a,21,()=>e(c),P,(m,k)=>{var x=ve();x.__click=()=>b(e(k));var q=f(x,!0);v(x),$(()=>te(q,e(k))),w(m,x)}),v(a),w(t,a)};j(p,t=>{e(c).length>0&&!e(i)&&t(M)})}v(_),A(s,r),w(h,_),U()}D(["input","click"]);var be=I('<div class="input-container svelte-yzduke"><label for="name">Ingredient</label> <!> <label for="quantity">Quantity</label> <input type="number"/> <label for="quantity">Unit</label> <input type="text"/> <button><i class="fa fa-solid fa-plus"></i></button></div>');function _e(h,u){L(u,!0);let o=g(E([])),r=g(""),i=g(void 0),c=g(void 0);const b=()=>{e(r)&&u.onAdd({name:e(r),quantity:e(i),unit:e(c)})};ue(async()=>{d(o,(await se()).ingredients.sort((t,a)=>t<a?1:0).map(t=>t.name),!0)});var y=be(),_=n(f(y),2);ge(_,{get options(){return e(o)},get value(){return e(r)},set value(t){d(r,t,!0)}});var s=n(_,4);F(s);var p=n(s,4);F(p);var M=n(p,2);M.__click=b,v(y),A(s,()=>e(i),t=>d(i,t)),A(p,()=>e(c),t=>d(c,t)),w(h,y),U()}D(["click"]);var he=I('<!> <div class="form-content svelte-1ycbaol"><label for="name">Name</label> <input type="text"/> <label for="ingredients">New ingredient</label> <div><!></div> <label for="ingredients">List of ingredients</label> <div><!></div> <label for="content">Instructions</label> <textarea rows="10" cols="50"></textarea></div> <button class="form-action svelte-1ycbaol"><!></button>',1),ye=I('<div class="contents svelte-1ycbaol"><span class="title-bar svelte-1ycbaol"><h2>Add a new recipe</h2> <button class="svelte-1ycbaol">Back to list</button></span> <!></div>');function ke(h,u){L(u,!0);let o=g(E([])),r=g(!1),i=g(""),c=g(""),b=E([]);const y=a=>{if(b.find(m=>m.name===a.name)){const m=a.name+" already added";R.push(m,{theme:{"--toastBarBackground":"#FF0000"}});return}b.push(a)},_=async()=>{if(d(o,[],!0),e(i)?.length||e(o).push({level:"error",header:"Name must be defined"}),e(c)?.length||e(o).push({level:"error",header:"Content must be defined"}),!e(o).length)try{d(r,!0),await le({name:e(i),content:e(c),ingredients:b}),d(r,!1),u.onUpload()}catch(a){d(r,!1);let m=a.message;a instanceof ae&&a.code===401?m="Invalid logged in user":a instanceof re&&(m="User is logged out");const k=`<strong>Entry not created</strong><br/> ${m}`;R.push(k,{theme:{"--toastBarBackground":"#FF0000"}})}};var s=ye(),p=f(s),M=n(f(p),2);M.__click=()=>Q("/cookbook"),v(p);var t=n(p,2);oe(t,{message:"Login to add an entry",requiredScope:"admin",children:(a,m)=>{var k=he(),x=X(k);H(x,17,()=>e(o),P,(l,z)=>{ne(l,{get item(){return e(z)}})});var q=n(x,2),B=n(f(q),2);F(B);var N=n(B,4),G=f(N);_e(G,{onAdd:y}),v(N);var S=n(N,4),J=f(S);de(J,{get ingredients(){return b},editable:!0}),v(S);var O=n(S,4);Y(O),v(q);var C=n(q,2);C.__click=_;var K=f(C);{var T=l=>{ie(l,{size:.5,unit:"em",durationSeconds:.5})},V=l=>{var z=Z("Submit");w(l,z)};j(K,l=>{e(r)?l(T):l(V,!1)})}v(C),$(()=>C.disabled=e(r)),A(B,()=>e(i),l=>d(i,l)),A(O,()=>e(c),l=>d(c,l)),w(a,k)},$$slots:{default:!0}}),v(s),w(h,s),U()}D(["click"]);function Ke(h,u){L(u,!1),me.set({name:"Cookbook",showAuthInHeader:!0});const o=()=>{Q("/cookbook")};ee(),ke(h,{onUpload:o}),U()}export{Ke as component};
