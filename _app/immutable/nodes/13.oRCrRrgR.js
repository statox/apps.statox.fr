import{s as ve,e as _,a as B,A as re,c as d,g as M,b as H,f,l as g,i as T,P as ne,E as Q,n as j,B as ge,t as ce,d as ue,z as F,h as v,j as be,C as ae,G as He,k as $e,y as ze,K as Fe}from"../chunks/scheduler.COTwWgsD.js";import{h as Ee,u as je}from"../chunks/await_block.C2TQSEMs.js";import{S as ke,i as Ce,a as x,g as ye,t as J,c as Te,b as fe,d as he,m as me,e as pe}from"../chunks/index.J-2_mda1.js";import{c as Se,o as xe}from"../chunks/store.CoQdeYNc.js";import{g as Ge,u as qe,U as Je}from"../chunks/service.BXrgs3ee.js";import{t as De,M as Ve}from"../chunks/Main.C2mFjPZG.js";import{M as Ke}from"../chunks/Main.DKTTxZq3.js";import{P as Y}from"../chunks/public.xpUinP6t.js";import{r as Qe,A as We}from"../chunks/index.B0bCEkgC.js";import{s as Xe}from"../chunks/client.C-zjehHN.js";import{e as oe}from"../chunks/each.BC3JvRW1.js";const Ye=!1,Lt=Object.freeze(Object.defineProperty({__proto__:null,ssr:Ye},Symbol.toStringTag,{value:"Module"})),Ue=()=>Qe({path:"/reactor/getEntriesForPublic"}),Ze=async n=>{const e=Y+"/reactor/addEntry",l=await Ge();typeof l=="string"&&await Xe.post(e).auth(l,{type:"bearer"}).field("name",n.name).field("commaSeparatedTags",n.commaSeparatedTags).attach("file",n.file)};function Ne(n,e,l){const t=n.slice();return t[10]=e[l],t}function Le(n,e,l){const t=n.slice();return t[13]=e[l],t}function Pe(n){let e,l=n[13]+"",t;return{c(){e=_("span"),t=ce(l),this.h()},l(r){e=d(r,"SPAN",{class:!0});var o=H(e);t=ue(o,l),o.forEach(f),this.h()},h(){g(e,"class","tag svelte-16m67n3")},m(r,o){T(r,e,o),v(e,t)},p(r,o){o&8&&l!==(l=r[13]+"")&&be(t,l)},d(r){r&&f(e)}}}function et(n){let e,l,t;return{c(){e=_("img"),this.h()},l(r){e=d(r,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){g(e,"class","medium-margin svelte-16m67n3"),ae(e.src,l=Y+n[10].uri)||g(e,"src",l),g(e,"alt",t=n[10].name)},m(r,o){T(r,e,o)},p(r,o){o&8&&!ae(e.src,l=Y+r[10].uri)&&g(e,"src",l),o&8&&t!==(t=r[10].name)&&g(e,"alt",t)},d(r){r&&f(e)}}}function tt(n){let e,l;return{c(){e=_("video"),this.h()},l(t){e=d(t,"VIDEO",{class:!0,style:!0,src:!0}),H(e).forEach(f),this.h()},h(){g(e,"class","medium-margin svelte-16m67n3"),He(e,"max-width","100%"),e.controls=!0,ae(e.src,l=Y+n[10].uri)||g(e,"src",l)},m(t,r){T(t,e,r)},p(t,r){r&8&&!ae(e.src,l=Y+t[10].uri)&&g(e,"src",l)},d(t){t&&f(e)}}}function Ie(n){let e,l,t,r=n[10].name+"",o,h,m,p,s,c,u=`<i class="fas fa-copy"></i>
                    Copy link`,b,i,k,A,D,w,$,O,z,L=oe(n[10].tags),a=[];for(let U=0;U<L.length;U+=1)a[U]=Pe(Le(n,L,U));function C(){return n[7](n[10])}function V(U,P){return P&8&&(A=null),A==null&&(A=!!U[5](U[10])),A?tt:et}let X=V(n,-1),S=X(n);return{c(){e=_("div"),l=_("div"),t=_("b"),o=ce(r),h=B(),m=_("div");for(let U=0;U<a.length;U+=1)a[U].c();p=B(),s=_("div"),c=_("button"),c.innerHTML=u,b=B(),i=_("div"),k=_("a"),S.c(),$=B(),this.h()},l(U){e=d(U,"DIV",{});var P=H(e);l=d(P,"DIV",{});var I=H(l);t=d(I,"B",{});var W=H(t);o=ue(W,r),W.forEach(f),I.forEach(f),h=M(P),m=d(P,"DIV",{class:!0});var Z=H(m);for(let E=0;E<a.length;E+=1)a[E].l(Z);Z.forEach(f),p=M(P),s=d(P,"DIV",{});var ee=H(s);c=d(ee,"BUTTON",{class:!0,"data-svelte-h":!0}),F(c)!=="svelte-2xhnct"&&(c.innerHTML=u),ee.forEach(f),P.forEach(f),b=M(U),i=d(U,"DIV",{});var te=H(i);k=d(te,"A",{href:!0,download:!0,rel:!0,target:!0});var K=H(k);S.l(K),K.forEach(f),$=M(te),te.forEach(f),this.h()},h(){g(m,"class","svelte-16m67n3"),g(c,"class","full-width svelte-16m67n3"),g(k,"href",D=Y+n[10].uri),g(k,"download",w=n[10].name),g(k,"rel","noopener noreferrer"),g(k,"target","blank")},m(U,P){T(U,e,P),v(e,l),v(l,t),v(t,o),v(e,h),v(e,m);for(let I=0;I<a.length;I+=1)a[I]&&a[I].m(m,null);v(e,p),v(e,s),v(s,c),T(U,b,P),T(U,i,P),v(i,k),S.m(k,null),v(i,$),O||(z=Q(c,"click",C),O=!0)},p(U,P){if(n=U,P&8&&r!==(r=n[10].name+"")&&be(o,r),P&8){L=oe(n[10].tags);let I;for(I=0;I<L.length;I+=1){const W=Le(n,L,I);a[I]?a[I].p(W,P):(a[I]=Pe(W),a[I].c(),a[I].m(m,null))}for(;I<a.length;I+=1)a[I].d(1);a.length=L.length}X===(X=V(n,P))&&S?S.p(n,P):(S.d(1),S=X(n),S&&(S.c(),S.m(k,null))),P&8&&D!==(D=Y+n[10].uri)&&g(k,"href",D),P&8&&w!==(w=n[10].name)&&g(k,"download",w)},d(U){U&&(f(e),f(b),f(i)),ge(a,U),S.d(),O=!1,z()}}}function Ae(n){let e,l="More...",t,r;return{c(){e=_("button"),e.textContent=l,this.h()},l(o){e=d(o,"BUTTON",{class:!0,"data-svelte-h":!0}),F(e)!=="svelte-3fputj"&&(e.textContent=l),this.h()},h(){g(e,"class","full-width medium-margin svelte-16m67n3")},m(o,h){T(o,e,h),t||(r=Q(e,"click",n[8]),t=!0)},p:j,d(o){o&&f(e),t=!1,r()}}}function lt(n){let e,l,t,r,o,h,m,p=oe(n[3]),s=[];for(let u=0;u<p.length;u+=1)s[u]=Ie(Ne(n,p,u));let c=n[2].length===0&&n[1]*de<n[0].length&&Ae(n);return{c(){e=_("input"),l=B(),t=_("div");for(let u=0;u<s.length;u+=1)s[u].c();r=B(),c&&c.c(),o=re(),this.h()},l(u){e=d(u,"INPUT",{class:!0,type:!0,placeholder:!0}),l=M(u),t=d(u,"DIV",{class:!0});var b=H(t);for(let i=0;i<s.length;i+=1)s[i].l(b);b.forEach(f),r=M(u),c&&c.l(u),o=re(),this.h()},h(){g(e,"class","full-width medium-margin svelte-16m67n3"),g(e,"type","text"),g(e,"placeholder","Search by tags or name"),g(t,"class","container svelte-16m67n3")},m(u,b){T(u,e,b),ne(e,n[2]),T(u,l,b),T(u,t,b);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(t,null);T(u,r,b),c&&c.m(u,b),T(u,o,b),h||(m=Q(e,"input",n[6]),h=!0)},p(u,[b]){if(b&4&&e.value!==u[2]&&ne(e,u[2]),b&56){p=oe(u[3]);let i;for(i=0;i<p.length;i+=1){const k=Ne(u,p,i);s[i]?s[i].p(k,b):(s[i]=Ie(k),s[i].c(),s[i].m(t,null))}for(;i<s.length;i+=1)s[i].d(1);s.length=p.length}u[2].length===0&&u[1]*de<u[0].length?c?c.p(u,b):(c=Ae(u),c.c(),c.m(o.parentNode,o)):c&&(c.d(1),c=null)},i:j,o:j,d(u){u&&(f(e),f(l),f(t),f(r),f(o)),ge(s,u),c&&c.d(u),h=!1,m()}}}const de=10;function nt(n,e,l){let{reactions:t}=e,r=1,o=[],h="";const m=(i,k)=>{if(!k.length||i.name.toLowerCase().includes(k.toLowerCase()))return!0;for(const D of i.tags)if(D.toLowerCase().includes(k.toLowerCase()))return!0;return!1},p=i=>{navigator.clipboard.writeText(Y+i.uri),De.push('<i class="fas fa-check"></i> Link copied to clipboard',{duration:1e3,theme:{"--toastBarHeight":0}})},s=i=>i.s3PresignedUrl.includes(".mp4");function c(){h=this.value,l(2,h)}const u=i=>p(i),b=()=>l(1,r++,r);return n.$$set=i=>{"reactions"in i&&l(0,t=i.reactions)},n.$$.update=()=>{n.$$.dirty&7&&l(3,o=t.filter(i=>m(i,h)).sort((i,k)=>k.creationDateUnix-i.creationDateUnix).slice(0,h.length?void 0:r*de))},[t,r,h,o,p,s,c,u,b]}class rt extends ke{constructor(e){super(),Ce(this,e,nt,lt,ve,{reactions:0})}}function Be(n,e,l){const t=n.slice();return t[14]=e[l],t}function Me(n){let e,l,t,r,o,h="Close",m,p,s,c,u="Name",b,i,k,A,D="Tags",w,$,O,z,L="File",a,C,V,X,S,U='<i class="fas fa-times-circle"></i>',P,I,W,Z,ee,te,K=oe(n[1]),E=[];for(let y=0;y<K.length;y+=1)E[y]=Oe(Be(n,K,y));const Re=y=>J(E[y],1,1,()=>{E[y]=null});function we(y,q){return y[6]?st:ot}let se=we(n),G=se(n);return{c(){e=_("div"),l=_("div"),t=_("h4"),r=ce(`Add a new file
                `),o=_("button"),o.textContent=h,m=B();for(let y=0;y<E.length;y+=1)E[y].c();p=B(),s=_("form"),c=_("label"),c.textContent=u,b=B(),i=_("input"),k=B(),A=_("label"),A.textContent=D,w=B(),$=_("input"),O=B(),z=_("label"),z.textContent=L,a=B(),C=_("span"),V=_("input"),X=B(),S=_("button"),S.innerHTML=U,P=B(),I=_("br"),W=B(),G.c(),this.h()},l(y){e=d(y,"DIV",{role:!0,class:!0});var q=H(e);l=d(q,"DIV",{class:!0});var N=H(l);t=d(N,"H4",{class:!0});var le=H(t);r=ue(le,`Add a new file
                `),o=d(le,"BUTTON",{"data-svelte-h":!0}),F(o)!=="svelte-2m9p61"&&(o.textContent=h),le.forEach(f),m=M(N);for(let _e=0;_e<E.length;_e+=1)E[_e].l(N);p=M(N),s=d(N,"FORM",{class:!0});var R=H(s);c=d(R,"LABEL",{for:!0,"data-svelte-h":!0}),F(c)!=="svelte-bs9sy6"&&(c.textContent=u),b=M(R),i=d(R,"INPUT",{type:!0}),k=M(R),A=d(R,"LABEL",{for:!0,"data-svelte-h":!0}),F(A)!=="svelte-1myp42m"&&(A.textContent=D),w=M(R),$=d(R,"INPUT",{type:!0}),O=M(R),z=d(R,"LABEL",{for:!0,"data-svelte-h":!0}),F(z)!=="svelte-180hc3e"&&(z.textContent=L),a=M(R),C=d(R,"SPAN",{});var ie=H(C);V=d(ie,"INPUT",{class:!0,type:!0}),X=M(ie),S=d(ie,"BUTTON",{"data-svelte-h":!0}),F(S)!=="svelte-4vp3x8"&&(S.innerHTML=U),ie.forEach(f),P=M(R),I=d(R,"BR",{}),W=M(R),G.l(R),R.forEach(f),N.forEach(f),q.forEach(f),this.h()},h(){g(t,"class","title-bar svelte-uq1fka"),g(c,"for","name"),g(i,"type","text"),g(A,"for","content"),g($,"type","textarea"),g(z,"for","file"),g(V,"class","file-input svelte-uq1fka"),g(V,"type","file"),g(s,"class","form-content svelte-uq1fka"),g(l,"class","contents svelte-uq1fka"),g(e,"role","dialog"),g(e,"class","modal svelte-uq1fka")},m(y,q){T(y,e,q),v(e,l),v(l,t),v(t,r),v(t,o),v(l,m);for(let N=0;N<E.length;N+=1)E[N]&&E[N].m(l,null);v(l,p),v(l,s),v(s,c),v(s,b),v(s,i),ne(i,n[2]),v(s,k),v(s,A),v(s,w),v(s,$),ne($,n[3]),v(s,O),v(s,z),v(s,a),v(s,C),v(C,V),n[12](V),v(C,X),v(C,S),v(s,P),v(s,I),v(s,W),G.m(s,null),Z=!0,ee||(te=[Q(o,"click",Se),Q(i,"input",n[9]),Q($,"input",n[10]),Q(V,"change",n[11]),Q(S,"click",n[13])],ee=!0)},p(y,q){if(q&2){K=oe(y[1]);let N;for(N=0;N<K.length;N+=1){const le=Be(y,K,N);E[N]?(E[N].p(le,q),x(E[N],1)):(E[N]=Oe(le),E[N].c(),x(E[N],1),E[N].m(l,p))}for(ye(),N=K.length;N<E.length;N+=1)Re(N);Te()}q&4&&i.value!==y[2]&&ne(i,y[2]),q&8&&ne($,y[3]),se===(se=we(y))&&G?G.p(y,q):(G.d(1),G=se(y),G&&(G.c(),G.m(s,null)))},i(y){if(!Z){for(let q=0;q<K.length;q+=1)x(E[q]);Z=!0}},o(y){E=E.filter(Boolean);for(let q=0;q<E.length;q+=1)J(E[q]);Z=!1},d(y){y&&f(e),ge(E,y),n[12](null),G.d(),ee=!1,ze(te)}}}function Oe(n){let e,l;return e=new Ve({props:{item:n[14]}}),{c(){fe(e.$$.fragment)},l(t){he(e.$$.fragment,t)},m(t,r){me(e,t,r),l=!0},p(t,r){const o={};r&2&&(o.item=t[14]),e.$set(o)},i(t){l||(x(e.$$.fragment,t),l=!0)},o(t){J(e.$$.fragment,t),l=!1},d(t){pe(e,t)}}}function ot(n){let e,l="Login to upload an entry";return{c(){e=_("span"),e.textContent=l,this.h()},l(t){e=d(t,"SPAN",{class:!0,"data-svelte-h":!0}),F(e)!=="svelte-4ab4io"&&(e.textContent=l),this.h()},h(){g(e,"class","form-action svelte-uq1fka")},m(t,r){T(t,e,r)},p:j,d(t){t&&f(e)}}}function st(n){let e,l="Submit",t,r;return{c(){e=_("button"),e.textContent=l,this.h()},l(o){e=d(o,"BUTTON",{class:!0,"data-svelte-h":!0}),F(e)!=="svelte-1nfv1d"&&(e.textContent=l),this.h()},h(){g(e,"class","form-action svelte-uq1fka")},m(o,h){T(o,e,h),t||(r=Q(e,"click",n[7]),t=!0)},p:j,d(o){o&&f(e),t=!1,r()}}}function it(n){let e,l,t=n[0]&&Me(n);return{c(){t&&t.c(),e=re()},l(r){t&&t.l(r),e=re()},m(r,o){t&&t.m(r,o),T(r,e,o),l=!0},p(r,[o]){r[0]?t?(t.p(r,o),o&1&&x(t,1)):(t=Me(r),t.c(),x(t,1),t.m(e.parentNode,e)):t&&(ye(),J(t,1,1,()=>{t=null}),Te())},i(r){l||(x(t),l=!0)},o(r){J(t),l=!1},d(r){r&&f(e),t&&t.d(r)}}}function at(n,e,l){let t;$e(n,qe,w=>l(6,t=w));let{isOpen:r}=e,{onUpload:o}=e,h=[],m,p="",s,c;const u=async()=>{l(1,h=[]),m!=null&&m.length||h.push({level:"error",header:"name must be defined"});let w;if(c&&c.length&&(w=c[0]),w||h.push({level:"error",header:"a file must be uploaded"}),!(h.length||!w))try{await Ze({name:m,commaSeparatedTags:p,file:w}),o(),Se()}catch($){let O=$.message;$ instanceof We&&$.code===401?O="Invalid logged in user":$ instanceof Je&&(O="User is logged out");const z=`<strong>Entry not created</strong><br/> ${O}`;De.push(z,{theme:{"--toastBarBackground":"#FF0000"}})}};function b(){m=this.value,l(2,m)}function i(){p=this.value,l(3,p)}function k(){c=this.files,l(5,c)}function A(w){Fe[w?"unshift":"push"](()=>{s=w,l(4,s)})}const D=()=>{l(4,s.value="",s)};return n.$$set=w=>{"isOpen"in w&&l(0,r=w.isOpen),"onUpload"in w&&l(8,o=w.onUpload)},[r,h,m,p,s,c,t,u,o,b,i,k,A,D]}class ct extends ke{constructor(e){super(),Ce(this,e,at,it,ve,{isOpen:0,onUpload:8})}}function ut(n){let e,l;return e=new Ve({props:{item:{level:"info",header:"Login to add an entry"}}}),{c(){fe(e.$$.fragment)},l(t){he(e.$$.fragment,t)},m(t,r){me(e,t,r),l=!0},p:j,i(t){l||(x(e.$$.fragment,t),l=!0)},o(t){J(e.$$.fragment,t),l=!1},d(t){pe(e,t)}}}function ft(n){let e,l="Add an entry",t,r;return{c(){e=_("button"),e.textContent=l},l(o){e=d(o,"BUTTON",{"data-svelte-h":!0}),F(e)!=="svelte-zzenq0"&&(e.textContent=l)},m(o,h){T(o,e,h),t||(r=Q(e,"click",n[3]),t=!0)},p:j,i:j,o:j,d(o){o&&f(e),t=!1,r()}}}function ht(n){let e,l="Something went wrong",t,r,o=JSON.stringify(n[5])+"",h;return{c(){e=_("p"),e.textContent=l,t=B(),r=_("p"),h=ce(o)},l(m){e=d(m,"P",{"data-svelte-h":!0}),F(e)!=="svelte-171fb2d"&&(e.textContent=l),t=M(m),r=d(m,"P",{});var p=H(r);h=ue(p,o),p.forEach(f)},m(m,p){T(m,e,p),T(m,t,p),T(m,r,p),v(r,h)},p(m,p){p&1&&o!==(o=JSON.stringify(m[5])+"")&&be(h,o)},i:j,o:j,d(m){m&&(f(e),f(t),f(r))}}}function mt(n){let e,l;return e=new rt({props:{reactions:n[4]}}),{c(){fe(e.$$.fragment)},l(t){he(e.$$.fragment,t)},m(t,r){me(e,t,r),l=!0},p(t,r){const o={};r&1&&(o.reactions=t[4]),e.$set(o)},i(t){l||(x(e.$$.fragment,t),l=!0)},o(t){J(e.$$.fragment,t),l=!1},d(t){pe(e,t)}}}function pt(n){let e,l="Loading data";return{c(){e=_("p"),e.textContent=l},l(t){e=d(t,"P",{"data-svelte-h":!0}),F(e)!=="svelte-ezyzhc"&&(e.textContent=l)},m(t,r){T(t,e,r)},p:j,i:j,o:j,d(t){t&&f(e)}}}function _t(n){let e,l,t,r="Reactor",o,h,m="Upload",p,s,c,u,b,i="Content",k,A,D,w;e=new Ke({props:{title:"Reactor",description:"My collection of memes"}});const $=[ft,ut],O=[];function z(a,C){return a[1]?0:1}s=z(n),c=O[s]=$[s](n);let L={ctx:n,current:null,token:null,hasCatch:!0,pending:pt,then:mt,catch:ht,value:4,error:5,blocks:[,,,]};return Ee(D=n[0],L),{c(){fe(e.$$.fragment),l=B(),t=_("h2"),t.textContent=r,o=B(),h=_("h3"),h.textContent=m,p=B(),c.c(),u=B(),b=_("h3"),b.textContent=i,k=B(),A=re(),L.block.c()},l(a){he(e.$$.fragment,a),l=M(a),t=d(a,"H2",{"data-svelte-h":!0}),F(t)!=="svelte-3o4hy8"&&(t.textContent=r),o=M(a),h=d(a,"H3",{"data-svelte-h":!0}),F(h)!=="svelte-18fi3zp"&&(h.textContent=m),p=M(a),c.l(a),u=M(a),b=d(a,"H3",{"data-svelte-h":!0}),F(b)!=="svelte-1qnf76d"&&(b.textContent=i),k=M(a),A=re(),L.block.l(a)},m(a,C){me(e,a,C),T(a,l,C),T(a,t,C),T(a,o,C),T(a,h,C),T(a,p,C),O[s].m(a,C),T(a,u,C),T(a,b,C),T(a,k,C),T(a,A,C),L.block.m(a,L.anchor=C),L.mount=()=>A.parentNode,L.anchor=A,w=!0},p(a,[C]){n=a;let V=s;s=z(n),s===V?O[s].p(n,C):(ye(),J(O[V],1,1,()=>{O[V]=null}),Te(),c=O[s],c?c.p(n,C):(c=O[s]=$[s](n),c.c()),x(c,1),c.m(u.parentNode,u)),L.ctx=n,C&1&&D!==(D=n[0])&&Ee(D,L)||je(L,n,C)},i(a){w||(x(e.$$.fragment,a),x(c),x(L.block),w=!0)},o(a){J(e.$$.fragment,a),J(c);for(let C=0;C<3;C+=1){const V=L.blocks[C];J(V)}w=!1},d(a){a&&(f(l),f(t),f(o),f(h),f(p),f(u),f(b),f(k),f(A)),pe(e,a),O[s].d(a),L.block.d(a),L.token=null,L=null}}}function dt(n,e,l){let t;$e(n,qe,m=>l(1,t=m));let r=Ue();const o=()=>l(0,r=Ue());return[r,t,o,()=>xe(ct,{onUpload:o})]}class Pt extends ke{constructor(e){super(),Ce(this,e,dt,_t,ve,{})}}export{Pt as component,Lt as universal};
