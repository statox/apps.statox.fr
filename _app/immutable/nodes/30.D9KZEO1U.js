import"../chunks/NZTpNUN0.js";import{a as ht}from"../chunks/eHPvmyNl.js";import{x as ot,z as R,y as tt,o as I,p as l,f as et,s as at,w as W,a as z,B as ct,C as u,g as r,E as g}from"../chunks/CF3vMb2z.js";import{d as dt,s as ut}from"../chunks/CVy4YE01.js";import{i as gt}from"../chunks/DhdTNEOV.js";import{e as C,i as f}from"../chunks/zmj_gju8.js";import{r as y,a as nt}from"../chunks/BTYzRZWn.js";import{b as p}from"../chunks/BPdl2Dks.js";import{P as vt}from"../chunks/BQ9zzujc.js";class w extends Error{constructor(){super("Tried to divide by 0")}}class N{x=0;y=0;constructor(t=0,e=0){this.x=t,this.y=e}addX(t){return this.x+=t.x,this}addY(t){return this.y+=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addScalarX(t){return this.x+=t,this}addScalarY(t){return this.y+=t,this}subtractX(t){return this.x-=t.x,this}subtractY(t){return this.y-=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}subtractScalar(t){return this.x-=t,this.y-=t,this}subtractScalarX(t){return this.x-=t,this}subtractScalarY(t){return this.y-=t,this}divideX(t){if(t.x===0)throw new w;return this.x/=t.x,this}divideY(t){if(t.y===0)throw new w;return this.y/=t.y,this}divide(t){if(t.x===0||t.y===0)throw new w;return this.x/=t.x,this.y/=t.y,this}divideScalar(t){if(t===0)throw new w;return this.x/=t,this.y/=t,this}divideScalarX(t){if(t===0)throw new w;return this.x/=t,this}divideScalarY(t){if(t===0)throw new w;return this.y/=t,this}multiplyX(t){return this.x*=t.x,this}multiplyY(t){return this.y*=t.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}multiplyScalarX(t){return this.x*=t,this}multiplyScalarY(t){return this.y*=t,this}invertX(){return this.x*=-1,this}invertY(){return this.y*=-1,this}invert(){return this.x*=-1,this.y*=-1,this}normalize(){const t=this.length();return this.divideScalar(t),this}norm=this.normalize;limit(t,e){return Math.abs(this.x)>t&&(this.x*=e),Math.abs(this.y)>t&&(this.y*=e),this}randomizeX(t,e){const i=Math.min(t.x,e.x),o=Math.max(t.x,e.x);return this.x=it(i,o),this}randomizeY(t,e){const i=Math.min(t.y,e.y),o=Math.max(t.y,e.y);return this.y=it(i,o),this}randomize(t,e){return this.randomizeX(t,e),this.randomizeY(t,e),this}randomizeAny(t,e){return Math.random()<.5?this.randomizeX(t,e):this.randomizeY(t,e),this}unfloat(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}toFixed(t=8){return this.x=Number(this.x.toFixed(t)),this.y=Number(this.y.toFixed(t)),this}mixX(t,e=.5){return this.x=(1-e)*this.x+e*t.x,this}mixY(t,e=.5){return this.y=(1-e)*this.y+e*t.y,this}mix(t,e=.5){return this.mixX(t,e),this.mixY(t,e),this}clone(){return new N(this.x,this.y)}copyX(t){return this.x=t.x,this}copyY(t){return this.y=t.y,this}copy(t){return this.x=t.x,this.y=t.y,this}zero(){return this.x=0,this.y=0,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}projectOnto(t){const e=(this.x*t.x+this.y*t.y)/(t.x*t.x+t.y*t.y);return this.x=e*t.x,this.y=e*t.y,this}horizontalAngle(){return Math.atan2(this.y,this.x)}horizontalAngleDeg(){return rt(this.horizontalAngle())}verticalAngle(){return Math.atan2(this.x,this.y)}verticalAngleDeg(){return rt(this.verticalAngle())}angle=this.horizontalAngle;direction=this.horizontalAngle;angleDeg=this.horizontalAngleDeg;rotate(t){const e=this.x*Math.cos(t)-this.y*Math.sin(t),i=this.x*Math.sin(t)+this.y*Math.cos(t);return this.x=e,this.y=i,this}rotateDeg(t){const e=st(t);return this.rotate(e)}rotateTo(t){return this.rotate(t-this.horizontalAngle())}rotateToDeg(t){const e=st(t);return this.rotateTo(e)}distanceX(t){return this.x-t.x}absDistanceX(t){return Math.abs(this.distanceX(t))}distanceY(t){return this.y-t.y}absDistanceY(t){return Math.abs(this.distanceY(t))}distance(t){return Math.sqrt(this.distanceSq(t))}distanceSq(t){const e=this.distanceX(t),i=this.distanceY(t);return e*e+i*i}length(){return Math.sqrt(this.lengthSq())}magnitude=this.length;lengthSq(){return this.x*this.x+this.y*this.y}isZero(){return this.x===0&&this.y===0}isEqualTo(t){return this.x===t.x&&this.y===t.y}toString(){return`x: ${this.x}, y: ${this.y}`}toArray(){return[this.x,this.y]}toObject(){return{x:this.x,y:this.y}}}const lt=180/Math.PI;function it(S,t){return Math.random()*(t-S)+S}function rt(S){return S*lt}function st(S){return S/lt}const xt=function(S,t,e,i,o){return(S-t)/(e-t)*(o-i)+i};class St{genes;structure;constructor(){this.genes=[{cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:25,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:"white"},{cellSizeVariationInSegment:.985,cellSpacingVariationInSegment:.8,nbCellsInSegment:10,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"red"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"orange"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:1,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"green"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.5,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:120,nbBranches:2,color:"yellow"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.4,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"lightblue"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:9,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:"lightgreen"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.8,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"lightred"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"purple"}],this.structure=[]}grow(){this.structure=[];const t=[{cell:{position:new N,size:20,color:"white"},agent:{level:0,levelStep:0,direction:new N(0,20)}}];for(;t.length;){const{cell:e,agent:i}=t.pop();if(i.level===this.genes.length)continue;const{cellSpacingVariationInSegment:o,nbCellsInSegment:P,color:T,cellSizeVariationInSegment:x,nextSegmentBaseCellSize:j,branchesMaxAngle:X,nbBranches:Y}=this.genes[i.level];if(i.levelStep>=P){const O=-X/2,$=X/2;for(let k=0;k<Y;k++){const Z=xt(k,0,Y-1,O,$),G={position:e.position.clone(),size:e.size*j,color:"white"},H={level:i.level+1,levelStep:0,direction:i.direction.clone().rotateDeg(Z)};t.push({cell:G,agent:H})}continue}const M={...e,position:e.position.clone().add(i.direction.clone().multiplyScalar(o)),size:e.size*x,color:T},E={level:i.level,levelStep:i.levelStep+1,direction:i.direction.clone()};t.push({cell:M,agent:E}),this.structure.push(M)}}}var mt=(S,t)=>at(t,!r(t)),yt=I('<div></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="1"/></div>',1),pt=I('<div class="genes-container svelte-1xx9u18"><div>Level</div> <div>cellSizeVariationInSegment</div> <div>nbCellsInSegment</div> <div>cellSpacingVariationInSegment</div> <div>nextSegmentBaseCellSize</div> <div>branchesMaxAngle</div> <div>nbBranches</div> <!></div>'),_t=I("<div></div>"),bt=I('<div><input type="number" step="0.1"/></div>'),zt=I('<div><input type="number" step="1"/></div>'),It=I('<div><input type="number" step="0.1"/></div>'),Ct=I('<div><input type="number" step="0.1"/></div>'),ft=I('<div><input type="number" step="1"/></div>'),Mt=I('<div><input type="number" step="1"/></div>'),Bt=I('<div class="genes-container-2 svelte-1xx9u18"><div>Level</div> <!> <div>cellSizeVariationInSegment</div> <!> <div>nbCellsInSegment</div> <!> <div>cellSpacingVariationInSegment</div> <!> <div>nextSegmentBaseCellSize</div> <!> <div>branchesMaxAngle</div> <!> <div>nbBranches</div> <!></div>'),At=I("<h1>Here be flowers</h1> <!> <div><h2>Plant info</h2> <div> </div></div> <span><h2>Genes</h2> <button>Change view</button></span> <!>",1);function Tt(S,t){ot(t,!0);let e;const i=new St,o=R([...i.genes]);i.grow();let P=tt(R(i.structure.length)),T=tt(!0);const x=()=>{i.genes=o,i.grow(),at(P,i.structure.length,!0)},j=c=>{c.setup=()=>{e=c,c.createCanvas(1e3,1e3),c.background("black")},c.draw=()=>{c.background("black");for(const m of i.structure){const B=m.position.x+c.width/2,A=c.height-m.position.y,h=m.size;c.fill(m.color),c.circle(B,A,h)}}};ht(()=>{console.clear(),e?.remove()});var X=At(),Y=l(et(X),2);vt(Y,{sketch:j});var M=l(Y,2),E=l(u(M),2),O=u(E);g(E),g(M);var $=l(M,2),k=l(u($),2);k.__click=[mt,T],g($);var Z=l($,2);{var G=c=>{var m=pt(),B=l(u(m),14);C(B,17,()=>o,f,(A,h,F)=>{var D=yt(),V=et(D);V.textContent=F;var q=l(V,2),d=u(q);y(d),d.__change=x,g(q);var a=l(q,2),_=u(a);y(_),_.__change=x,g(a);var n=l(a,2),s=u(n);y(s),s.__change=x,g(n);var v=l(n,2),J=u(v);y(J),J.__change=x,g(v);var K=l(v,2),Q=u(K);y(Q),Q.__change=x,g(K);var L=l(K,2),U=u(L);y(U),U.__change=x,g(L),W(()=>nt(V,`color: ${r(h).color??""}`)),p(d,()=>r(h).cellSizeVariationInSegment,b=>r(h).cellSizeVariationInSegment=b),p(_,()=>r(h).nbCellsInSegment,b=>r(h).nbCellsInSegment=b),p(s,()=>r(h).cellSpacingVariationInSegment,b=>r(h).cellSpacingVariationInSegment=b),p(J,()=>r(h).nextSegmentBaseCellSize,b=>r(h).nextSegmentBaseCellSize=b),p(Q,()=>r(h).branchesMaxAngle,b=>r(h).branchesMaxAngle=b),p(U,()=>r(h).nbBranches,b=>r(h).nbBranches=b),z(A,D)}),g(m),z(c,m)},H=c=>{var m=Bt(),B=l(u(m),2);C(B,17,()=>o,f,(d,a,_)=>{var n=_t();n.textContent=_,W(()=>nt(n,`color: ${r(a).color??""}`)),z(d,n)});var A=l(B,4);C(A,17,()=>o,f,(d,a,_)=>{var n=bt(),s=u(n);y(s),s.__change=x,g(n),p(s,()=>r(a).cellSizeVariationInSegment,v=>r(a).cellSizeVariationInSegment=v),z(d,n)});var h=l(A,4);C(h,17,()=>o,f,(d,a,_)=>{var n=zt(),s=u(n);y(s),s.__change=x,g(n),p(s,()=>r(a).nbCellsInSegment,v=>r(a).nbCellsInSegment=v),z(d,n)});var F=l(h,4);C(F,17,()=>o,f,(d,a,_)=>{var n=It(),s=u(n);y(s),s.__change=x,g(n),p(s,()=>r(a).cellSpacingVariationInSegment,v=>r(a).cellSpacingVariationInSegment=v),z(d,n)});var D=l(F,4);C(D,17,()=>o,f,(d,a,_)=>{var n=Ct(),s=u(n);y(s),s.__change=x,g(n),p(s,()=>r(a).nextSegmentBaseCellSize,v=>r(a).nextSegmentBaseCellSize=v),z(d,n)});var V=l(D,4);C(V,17,()=>o,f,(d,a,_)=>{var n=ft(),s=u(n);y(s),s.__change=x,g(n),p(s,()=>r(a).branchesMaxAngle,v=>r(a).branchesMaxAngle=v),z(d,n)});var q=l(V,4);C(q,17,()=>o,f,(d,a,_)=>{var n=Mt(),s=u(n);y(s),s.__change=x,g(n),p(s,()=>r(a).nbBranches,v=>r(a).nbBranches=v),z(d,n)}),g(m),z(c,m)};gt(Z,c=>{r(T)?c(G):c(H,!1)})}W(()=>ut(O,`Nb segments: ${r(P)??""}`)),z(S,X),ct()}dt(["click","change"]);export{Tt as component};
