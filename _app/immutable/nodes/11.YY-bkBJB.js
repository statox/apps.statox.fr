import{s as Z,A as I,i as $,f as _,k as ee,e as v,t as F,a as T,c as b,b as D,d as H,z as N,g as A,l as C,h,N as ae,E as q,O as de,B as me,y as ve,n as O}from"../chunks/scheduler.DD29IDFH.js";import{S as te,i as le,a as y,g as z,t as E,c as R,b as G,d as W,m as J,e as K}from"../chunks/index.DdAIetyJ.js";import{c as _e,o as be}from"../chunks/store.Be1KgTX-.js";import{u as ne,M as re,U as ge}from"../chunks/Main.BLA7JSmE.js";import{e as Y}from"../chunks/each.BVF7ijxy.js";import{a as ke,r as $e,A as ye}from"../chunks/index.w8126cPe.js";import{t as Ce}from"../chunks/SvelteToast.svelte_svelte_type_style_lang.BMHGeqRo.js";import{D as he}from"../chunks/datetime.nQE3q1jc.js";import{h as xe}from"../chunks/await_block.CPkDFjTD.js";const Ee=async o=>ke({path:"/personalTracker/upload",data:{event:o}}),we=async()=>await $e({path:"/personalTracker/getAll",authorize:!0});function ie(o,t,l){const e=o.slice();return e[7]=t[l],e}function ce(o){let t,l,e,n,r,i="Close",s,c,u,a,g="Weight",w,k,x,V,P,B,Q,oe,L=Y(o[1]),m=[];for(let f=0;f<L.length;f+=1)m[f]=ue(ie(o,L,f));const pe=f=>E(m[f],1,1,()=>{m[f]=null});function se(f,p){return f[3]?Te:Ue}let S=se(o),U=S(o);return{c(){t=v("div"),l=v("div"),e=v("h4"),n=F(`Add a new event
                `),r=v("button"),r.textContent=i,s=T();for(let f=0;f<m.length;f+=1)m[f].c();c=T(),u=v("form"),a=v("label"),a.textContent=g,w=T(),k=v("input"),x=T(),V=v("br"),P=T(),U.c(),this.h()},l(f){t=b(f,"DIV",{role:!0,class:!0});var p=D(t);l=b(p,"DIV",{class:!0});var d=D(l);e=b(d,"H4",{class:!0});var j=D(e);n=H(j,`Add a new event
                `),r=b(j,"BUTTON",{"data-svelte-h":!0}),N(r)!=="svelte-2m9p61"&&(r.textContent=i),j.forEach(_),s=A(d);for(let X=0;X<m.length;X+=1)m[X].l(d);c=A(d),u=b(d,"FORM",{class:!0});var M=D(u);a=b(M,"LABEL",{for:!0,"data-svelte-h":!0}),N(a)!=="svelte-1wni8ci"&&(a.textContent=g),w=A(M),k=b(M,"INPUT",{type:!0}),x=A(M),V=b(M,"BR",{}),P=A(M),U.l(M),M.forEach(_),d.forEach(_),p.forEach(_),this.h()},h(){C(e,"class","title-bar svelte-1cixduj"),C(a,"for","weight"),C(k,"type","number"),C(u,"class","form-content svelte-1cixduj"),C(l,"class","contents svelte-1cixduj"),C(t,"role","dialog"),C(t,"class","modal svelte-1cixduj")},m(f,p){$(f,t,p),h(t,l),h(l,e),h(e,n),h(e,r),h(l,s);for(let d=0;d<m.length;d+=1)m[d]&&m[d].m(l,null);h(l,c),h(l,u),h(u,a),h(u,w),h(u,k),ae(k,o[2]),h(u,x),h(u,V),h(u,P),U.m(u,null),B=!0,Q||(oe=[q(r,"click",_e),q(k,"input",o[6])],Q=!0)},p(f,p){if(p&2){L=Y(f[1]);let d;for(d=0;d<L.length;d+=1){const j=ie(f,L,d);m[d]?(m[d].p(j,p),y(m[d],1)):(m[d]=ue(j),m[d].c(),y(m[d],1),m[d].m(l,c))}for(z(),d=L.length;d<m.length;d+=1)pe(d);R()}p&4&&de(k.value)!==f[2]&&ae(k,f[2]),S===(S=se(f))&&U?U.p(f,p):(U.d(1),U=S(f),U&&(U.c(),U.m(u,null)))},i(f){if(!B){for(let p=0;p<L.length;p+=1)y(m[p]);B=!0}},o(f){m=m.filter(Boolean);for(let p=0;p<m.length;p+=1)E(m[p]);B=!1},d(f){f&&_(t),me(m,f),U.d(),Q=!1,ve(oe)}}}function ue(o){let t,l;return t=new re({props:{item:o[7]}}),{c(){G(t.$$.fragment)},l(e){W(t.$$.fragment,e)},m(e,n){J(t,e,n),l=!0},p(e,n){const r={};n&2&&(r.item=e[7]),t.$set(r)},i(e){l||(y(t.$$.fragment,e),l=!0)},o(e){E(t.$$.fragment,e),l=!1},d(e){K(t,e)}}}function Ue(o){let t,l="Login to upload an entry";return{c(){t=v("span"),t.textContent=l,this.h()},l(e){t=b(e,"SPAN",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-4ab4io"&&(t.textContent=l),this.h()},h(){C(t,"class","form-action svelte-1cixduj")},m(e,n){$(e,t,n)},p:O,d(e){e&&_(t)}}}function Te(o){let t,l="Submit",e,n;return{c(){t=v("button"),t.textContent=l,this.h()},l(r){t=b(r,"BUTTON",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-1nfv1d"&&(t.textContent=l),this.h()},h(){C(t,"class","form-action svelte-1cixduj")},m(r,i){$(r,t,i),e||(n=q(t,"click",o[4]),e=!0)},p:O,d(r){r&&_(t),e=!1,n()}}}function Ae(o){let t,l,e=o[0]&&ce(o);return{c(){e&&e.c(),t=I()},l(n){e&&e.l(n),t=I()},m(n,r){e&&e.m(n,r),$(n,t,r),l=!0},p(n,[r]){n[0]?e?(e.p(n,r),r&1&&y(e,1)):(e=ce(n),e.c(),y(e,1),e.m(t.parentNode,t)):e&&(z(),E(e,1,1,()=>{e=null}),R())},i(n){l||(y(e),l=!0)},o(n){E(e),l=!1},d(n){n&&_(t),e&&e.d(n)}}}function Ie(o,t,l){let e;ee(o,ne,a=>l(3,e=a));let{isOpen:n}=t,{onUpload:r}=t,i=[],s;const c=async()=>{if(l(1,i=[]),s!==Math.floor(s)&&i.push({level:"error",header:"Value must not have a decimal part"}),(s<80||s>110)&&i.push({level:"error",header:"Value must be in kg"}),i.length)return;const a=he.now().toUTC().toUnixInteger();try{await Ee({timestampUTC:a,type:"weight",value:s*100}),r(),_e()}catch(g){let w=g.message;g instanceof ye&&g.code===401?w="Invalid logged in user":g instanceof ge&&(w="User is logged out");const k=`<strong>Entry not created</strong><br/> ${w}`;Ce.push(k,{theme:{"--toastBarBackground":"#FF0000"}})}};function u(){s=de(this.value),l(2,s)}return o.$$set=a=>{"isOpen"in a&&l(0,n=a.isOpen),"onUpload"in a&&l(5,r=a.onUpload)},[n,i,s,e,c,r,u]}class Me extends te{constructor(t){super(),le(this,t,Ie,Ae,Z,{isOpen:0,onUpload:5})}}function De(o){o[1]=o[2].events}function Be(o,t,l){const e=o.slice();e[3]=t[l];const n=he.fromSeconds(e[3].eventDateUnix).toLocal().toFormat("dd/MM/yy HH:mm");return e[4]=n,e}function fe(o){let t,l,e={ctx:o,current:null,token:null,hasCatch:!0,pending:Ve,then:Ne,catch:Le,value:2,error:7,blocks:[,,,]};return xe(we(),e),{c(){t=I(),e.block.c()},l(n){t=I(),e.block.l(n)},m(n,r){$(n,t,r),e.block.m(n,e.anchor=r),e.mount=()=>t.parentNode,e.anchor=t,l=!0},p(n,r){o=n},i(n){l||(y(e.block),l=!0)},o(n){for(let r=0;r<3;r+=1){const i=e.blocks[r];E(i)}l=!1},d(n){n&&_(t),e.block.d(n),e.token=null,e=null}}}function Le(o){let t,l;return t=new re({props:{item:{level:"error",header:"Something went wrong getting events",message:o[7]}}}),{c(){G(t.$$.fragment)},l(e){W(t.$$.fragment,e)},m(e,n){J(t,e,n),l=!0},i(e){l||(y(t.$$.fragment,e),l=!0)},o(e){E(t.$$.fragment,e),l=!1},d(e){K(t,e)}}}function Ne(o){De(o);let t,l="<div>Date</div> <div>Type</div> <div>Value</div>",e,n,r=Y(o[1]),i=[];for(let s=0;s<r.length;s+=1)i[s]=Oe(Be(o,r,s));return{c(){t=v("div"),t.innerHTML=l,e=T();for(let s=0;s<i.length;s+=1)i[s].c();n=I(),this.h()},l(s){t=b(s,"DIV",{class:!0,"data-svelte-h":!0}),N(t)!=="svelte-cv599z"&&(t.innerHTML=l),e=A(s);for(let c=0;c<i.length;c+=1)i[c].l(s);n=I(),this.h()},h(){C(t,"class","event svelte-1lfnev1")},m(s,c){$(s,t,c),$(s,e,c);for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(s,c);$(s,n,c)},i:O,o:O,d(s){s&&(_(t),_(e),_(n)),me(i,s)}}}function Oe(o){let t,l,e,n,r,i=o[3].type+"",s,c,u,a=o[3].value+"",g,w;return{c(){t=v("div"),l=v("div"),e=F(o[4]),n=T(),r=v("div"),s=F(i),c=T(),u=v("div"),g=F(a),w=T(),this.h()},l(k){t=b(k,"DIV",{class:!0});var x=D(t);l=b(x,"DIV",{class:!0});var V=D(l);e=H(V,o[4]),V.forEach(_),n=A(x),r=b(x,"DIV",{class:!0});var P=D(r);s=H(P,i),P.forEach(_),c=A(x),u=b(x,"DIV",{class:!0});var B=D(u);g=H(B,a),B.forEach(_),w=A(x),x.forEach(_),this.h()},h(){C(l,"class","event-date"),C(r,"class","event-type"),C(u,"class","event-value"),C(t,"class","event svelte-1lfnev1")},m(k,x){$(k,t,x),h(t,l),h(l,e),h(t,n),h(t,r),h(r,s),h(t,c),h(t,u),h(u,g),h(t,w)},p:O,d(k){k&&_(t)}}}function Ve(o){let t,l="Loading events";return{c(){t=v("p"),t.textContent=l},l(e){t=b(e,"P",{"data-svelte-h":!0}),N(t)!=="svelte-aa2awf"&&(t.textContent=l)},m(e,n){$(e,t,n)},i:O,o:O,d(e){e&&_(t)}}}function Pe(o){let t,l,e=o[0]&&fe(o);return{c(){e&&e.c(),t=I()},l(n){e&&e.l(n),t=I()},m(n,r){e&&e.m(n,r),$(n,t,r),l=!0},p(n,[r]){n[0]?e?r&1&&y(e,1):(e=fe(n),e.c(),y(e,1),e.m(t.parentNode,t)):e&&(z(),E(e,1,1,()=>{e=null}),R())},i(n){l||(y(e),l=!0)},o(n){E(e),l=!1},d(n){n&&_(t),e&&e.d(n)}}}function je(o,t,l){let e;return ee(o,ne,n=>l(0,e=n)),[e]}class Se extends te{constructor(t){super(),le(this,t,je,Pe,Z,{})}}function Fe(o){let t,l;return t=new re({props:{item:{level:"info",header:"Login to add an entry or see events"}}}),{c(){G(t.$$.fragment)},l(e){W(t.$$.fragment,e)},m(e,n){J(t,e,n),l=!0},i(e){l||(y(t.$$.fragment,e),l=!0)},o(e){E(t.$$.fragment,e),l=!1},d(e){K(t,e)}}}function He(o){let t,l="Add an entry",e,n,r,i,s,c,u;return i=new Se({}),{c(){t=v("button"),t.textContent=l,e=T(),n=v("br"),r=T(),G(i.$$.fragment)},l(a){t=b(a,"BUTTON",{"data-svelte-h":!0}),N(t)!=="svelte-ank2u2"&&(t.textContent=l),e=A(a),n=b(a,"BR",{}),r=A(a),W(i.$$.fragment,a)},m(a,g){$(a,t,g),$(a,e,g),$(a,n,g),$(a,r,g),J(i,a,g),s=!0,c||(u=q(t,"click",o[1]),c=!0)},i(a){s||(y(i.$$.fragment,a),s=!0)},o(a){E(i.$$.fragment,a),s=!1},d(a){a&&(_(t),_(e),_(n),_(r)),K(i,a),c=!1,u()}}}function qe(o){let t,l,e,n;const r=[He,Fe],i=[];function s(c,u){return c[0]?0:1}return t=s(o),l=i[t]=r[t](o),{c(){l.c(),e=I()},l(c){l.l(c),e=I()},m(c,u){i[t].m(c,u),$(c,e,u),n=!0},p(c,[u]){let a=t;t=s(c),t!==a&&(z(),E(i[a],1,1,()=>{i[a]=null}),R(),l=i[t],l||(l=i[t]=r[t](c),l.c()),y(l,1),l.m(e.parentNode,e))},i(c){n||(y(l),n=!0)},o(c){E(l),n=!1},d(c){c&&_(e),i[t].d(c)}}}function ze(o,t,l){let e;return ee(o,ne,r=>l(0,e=r)),[e,()=>be(Me,{onUpload:()=>{}})]}class et extends te{constructor(t){super(),le(this,t,ze,qe,Z,{})}}export{et as component};
