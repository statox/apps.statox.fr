import"../chunks/NZTpNUN0.js";import{a as ce}from"../chunks/eHPvmyNl.js";import{x as de,z as R,y as ee,o as I,p as h,f as te,s as ae,w as W,a as z,B as ue,C as u,g as r,E as g}from"../chunks/CF3vMb2z.js";import{d as ge,s as ve}from"../chunks/CVy4YE01.js";import{i as xe}from"../chunks/DhdTNEOV.js";import{e as f,i as C}from"../chunks/zmj_gju8.js";import{r as p,a as ne}from"../chunks/BTYzRZWn.js";import{b as y}from"../chunks/BPdl2Dks.js";import{P as Se}from"../chunks/BQ9zzujc.js";class w extends Error{constructor(){super("Tried to divide by 0")}}class j{x=0;y=0;constructor(e=0,t=0){this.x=e,this.y=t}addX(e){return this.x+=e.x,this}addY(e){return this.y+=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addScalarX(e){return this.x+=e,this}addScalarY(e){return this.y+=e,this}subtractX(e){return this.x-=e.x,this}subtractY(e){return this.y-=e.y,this}subtract(e){return this.x-=e.x,this.y-=e.y,this}subtractScalar(e){return this.x-=e,this.y-=e,this}subtractScalarX(e){return this.x-=e,this}subtractScalarY(e){return this.y-=e,this}divideX(e){if(e.x===0)throw new w;return this.x/=e.x,this}divideY(e){if(e.y===0)throw new w;return this.y/=e.y,this}divide(e){if(e.x===0||e.y===0)throw new w;return this.x/=e.x,this.y/=e.y,this}divideScalar(e){if(e===0)throw new w;return this.x/=e,this.y/=e,this}divideScalarX(e){if(e===0)throw new w;return this.x/=e,this}divideScalarY(e){if(e===0)throw new w;return this.y/=e,this}multiplyX(e){return this.x*=e.x,this}multiplyY(e){return this.y*=e.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}multiplyScalarX(e){return this.x*=e,this}multiplyScalarY(e){return this.y*=e,this}invertX(){return this.x*=-1,this}invertY(){return this.y*=-1,this}invert(){return this.x*=-1,this.y*=-1,this}normalize(){const e=this.length();return this.divideScalar(e),this}norm=this.normalize;limit(e,t){return Math.abs(this.x)>e&&(this.x*=t),Math.abs(this.y)>e&&(this.y*=t),this}randomizeX(e,t){const n=Math.min(e.x,t.x),l=Math.max(e.x,t.x);return this.x=ie(n,l),this}randomizeY(e,t){const n=Math.min(e.y,t.y),l=Math.max(e.y,t.y);return this.y=ie(n,l),this}randomize(e,t){return this.randomizeX(e,t),this.randomizeY(e,t),this}randomizeAny(e,t){return Math.random()<.5?this.randomizeX(e,t):this.randomizeY(e,t),this}unfloat(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}toFixed(e=8){return this.x=Number(this.x.toFixed(e)),this.y=Number(this.y.toFixed(e)),this}mixX(e,t=.5){return this.x=(1-t)*this.x+t*e.x,this}mixY(e,t=.5){return this.y=(1-t)*this.y+t*e.y,this}mix(e,t=.5){return this.mixX(e,t),this.mixY(e,t),this}clone(){return new j(this.x,this.y)}copyX(e){return this.x=e.x,this}copyY(e){return this.y=e.y,this}copy(e){return this.x=e.x,this.y=e.y,this}zero(){return this.x=0,this.y=0,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}projectOnto(e){const t=(this.x*e.x+this.y*e.y)/(e.x*e.x+e.y*e.y);return this.x=t*e.x,this.y=t*e.y,this}horizontalAngle(){return Math.atan2(this.y,this.x)}horizontalAngleDeg(){return re(this.horizontalAngle())}verticalAngle(){return Math.atan2(this.x,this.y)}verticalAngleDeg(){return re(this.verticalAngle())}angle=this.horizontalAngle;direction=this.horizontalAngle;angleDeg=this.horizontalAngleDeg;rotate(e){const t=this.x*Math.cos(e)-this.y*Math.sin(e),n=this.x*Math.sin(e)+this.y*Math.cos(e);return this.x=t,this.y=n,this}rotateDeg(e){const t=se(e);return this.rotate(t)}rotateTo(e){return this.rotate(e-this.horizontalAngle())}rotateToDeg(e){const t=se(e);return this.rotateTo(t)}distanceX(e){return this.x-e.x}absDistanceX(e){return Math.abs(this.distanceX(e))}distanceY(e){return this.y-e.y}absDistanceY(e){return Math.abs(this.distanceY(e))}distance(e){return Math.sqrt(this.distanceSq(e))}distanceSq(e){const t=this.distanceX(e),n=this.distanceY(e);return t*t+n*n}length(){return Math.sqrt(this.lengthSq())}magnitude=this.length;lengthSq(){return this.x*this.x+this.y*this.y}isZero(){return this.x===0&&this.y===0}isEqualTo(e){return this.x===e.x&&this.y===e.y}toString(){return`x: ${this.x}, y: ${this.y}`}toArray(){return[this.x,this.y]}toObject(){return{x:this.x,y:this.y}}}const le=180/Math.PI;function ie(S,e){return Math.random()*(e-S)+S}function re(S){return S*le}function se(S){return S/le}const me=function(S,e,t,n,l){return(S-e)/(t-e)*(l-n)+n};class pe{genes;structure;constructor(){this.genes=[{cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:25,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:"white"},{cellSizeVariationInSegment:.985,cellSpacingVariationInSegment:.8,nbCellsInSegment:10,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"red"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"orange"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:1,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"green"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.5,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:120,nbBranches:2,color:"yellow"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.4,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"lightblue"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:9,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:"lightgreen"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.8,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"lightred"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"purple"}],this.structure=[]}grow(){this.structure=[];const e=[{cell:{position:new j,size:20,color:"white"},agent:{level:0,levelStep:0,direction:new j(0,20)}}];for(;e.length;){const{cell:t,agent:n}=e.pop();if(n.level===this.genes.length)continue;const{cellSpacingVariationInSegment:l,nbCellsInSegment:P,color:q,cellSizeVariationInSegment:G,nextSegmentBaseCellSize:v,branchesMaxAngle:T,nbBranches:X}=this.genes[n.level];if(n.levelStep>=P){const E=-T/2,O=T/2;for(let M=0;M<X;M++){const Z=me(M,0,X-1,E,O),F={position:t.position.clone(),size:t.size*v,color:"white"},H={level:n.level+1,levelStep:0,direction:n.direction.clone().rotateDeg(Z)};e.push({cell:F,agent:H})}continue}const Y={...t,position:t.position.clone().add(n.direction.clone().multiplyScalar(l)),size:t.size*G,color:q},$={level:n.level,levelStep:n.levelStep+1,direction:n.direction.clone()};e.push({cell:Y,agent:$}),this.structure.push(Y)}}}const ye=(S,e,t,n)=>{for(;e.length;)e.pop();e.push({cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:25,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:Math.floor(t(2,4)),color:"white"});for(let l=0;l<t(5,8);l++)e.push({cellSizeVariationInSegment:t(.93,.99),cellSpacingVariationInSegment:t(.4,.6),nbCellsInSegment:Math.floor(t(2,6)),nextSegmentBaseCellSize:1,branchesMaxAngle:Math.floor(t(40,180)),nbBranches:Math.floor(t(2,4)),color:"white"});e[1].nbCellsInSegment=10,n()};var be=(S,e)=>ae(e,!r(e)),_e=I('<div></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="1"/></div>',1),ze=I('<div class="genes-container svelte-1xx9u18"><div>Level</div> <div>cellSizeVariationInSegment</div> <div>nbCellsInSegment</div> <div>cellSpacingVariationInSegment</div> <div>nextSegmentBaseCellSize</div> <div>branchesMaxAngle</div> <div>nbBranches</div> <!></div>'),Ie=I("<div></div>"),fe=I('<div><input type="number" step="0.1"/></div>'),Ce=I('<div><input type="number" step="1"/></div>'),Me=I('<div><input type="number" step="0.1"/></div>'),Be=I('<div><input type="number" step="0.1"/></div>'),Ve=I('<div><input type="number" step="1"/></div>'),Ae=I('<div><input type="number" step="1"/></div>'),we=I('<div class="genes-container-2 svelte-1xx9u18"><div>Level</div> <!> <div>cellSizeVariationInSegment</div> <!> <div>nbCellsInSegment</div> <!> <div>cellSpacingVariationInSegment</div> <!> <div>nextSegmentBaseCellSize</div> <!> <div>branchesMaxAngle</div> <!> <div>nbBranches</div> <!></div>'),Xe=I("<h1>Here be flowers</h1> <!> <div><h2>Plant info</h2> <div> </div></div> <span><h2>Genes</h2> <button>Change view</button></span> <button>Randomize plant</button> <!>",1);function Ne(S,e){de(e,!0);let t;const n=new pe,l=R([...n.genes]);n.grow();let P=ee(R(n.structure.length)),q=ee(!0);function G(o,m){return Math.random()*(m-o)+o}const v=()=>{n.genes=l,n.grow(),ae(P,n.structure.length,!0)},T=o=>{o.setup=()=>{t=o,o.createCanvas(1e3,1e3),o.background("black")},o.draw=()=>{o.background("black");for(const m of n.structure){const B=m.position.x+o.width/2,V=o.height-m.position.y,c=m.size;o.fill(m.color),o.circle(B,V,c)}}};ce(()=>{console.clear(),t?.remove()});var X=Xe(),Y=h(te(X),2);Se(Y,{sketch:T});var $=h(Y,2),E=h(u($),2),O=u(E);g(E),g($);var M=h($,2),Z=h(u(M),2);Z.__click=[be,q],g(M);var F=h(M,2);F.__click=[ye,l,G,v];var H=h(F,2);{var he=o=>{var m=ze(),B=h(u(m),14);f(B,17,()=>l,C,(V,c,N)=>{var k=_e(),A=te(k);A.textContent=N;var D=h(A,2),d=u(D);p(d),d.__change=v,g(D);var a=h(D,2),b=u(a);p(b),b.__change=v,g(a);var i=h(a,2),s=u(i);p(s),s.__change=v,g(i);var x=h(i,2),J=u(x);p(J),J.__change=v,g(x);var K=h(x,2),Q=u(K);p(Q),Q.__change=v,g(K);var L=h(K,2),U=u(L);p(U),U.__change=v,g(L),W(()=>ne(A,`color: ${r(c).color??""}`)),y(d,()=>r(c).cellSizeVariationInSegment,_=>r(c).cellSizeVariationInSegment=_),y(b,()=>r(c).nbCellsInSegment,_=>r(c).nbCellsInSegment=_),y(s,()=>r(c).cellSpacingVariationInSegment,_=>r(c).cellSpacingVariationInSegment=_),y(J,()=>r(c).nextSegmentBaseCellSize,_=>r(c).nextSegmentBaseCellSize=_),y(Q,()=>r(c).branchesMaxAngle,_=>r(c).branchesMaxAngle=_),y(U,()=>r(c).nbBranches,_=>r(c).nbBranches=_),z(V,k)}),g(m),z(o,m)},oe=o=>{var m=we(),B=h(u(m),2);f(B,17,()=>l,C,(d,a,b)=>{var i=Ie();i.textContent=b,W(()=>ne(i,`color: ${r(a).color??""}`)),z(d,i)});var V=h(B,4);f(V,17,()=>l,C,(d,a,b)=>{var i=fe(),s=u(i);p(s),s.__change=v,g(i),y(s,()=>r(a).cellSizeVariationInSegment,x=>r(a).cellSizeVariationInSegment=x),z(d,i)});var c=h(V,4);f(c,17,()=>l,C,(d,a,b)=>{var i=Ce(),s=u(i);p(s),s.__change=v,g(i),y(s,()=>r(a).nbCellsInSegment,x=>r(a).nbCellsInSegment=x),z(d,i)});var N=h(c,4);f(N,17,()=>l,C,(d,a,b)=>{var i=Me(),s=u(i);p(s),s.__change=v,g(i),y(s,()=>r(a).cellSpacingVariationInSegment,x=>r(a).cellSpacingVariationInSegment=x),z(d,i)});var k=h(N,4);f(k,17,()=>l,C,(d,a,b)=>{var i=Be(),s=u(i);p(s),s.__change=v,g(i),y(s,()=>r(a).nextSegmentBaseCellSize,x=>r(a).nextSegmentBaseCellSize=x),z(d,i)});var A=h(k,4);f(A,17,()=>l,C,(d,a,b)=>{var i=Ve(),s=u(i);p(s),s.__change=v,g(i),y(s,()=>r(a).branchesMaxAngle,x=>r(a).branchesMaxAngle=x),z(d,i)});var D=h(A,4);f(D,17,()=>l,C,(d,a,b)=>{var i=Ae(),s=u(i);p(s),s.__change=v,g(i),y(s,()=>r(a).nbBranches,x=>r(a).nbBranches=x),z(d,i)}),g(m),z(o,m)};xe(H,o=>{r(q)?o(he):o(oe,!1)})}W(()=>ve(O,`Nb segments: ${r(P)??""}`)),z(S,X),ue()}ge(["click","change"]);export{Ne as component};
