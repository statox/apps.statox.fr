import"../chunks/NZTpNUN0.js";import{p as Z,g as y,G as P,h as a,b as G,s as f,i as x,r as g,t as U,a as w,F as me,e as u,d as ee,f as L,a$ as ve,a_ as $,j as z,c as pe}from"../chunks/tjCGPzdr.js";import{d as te,s as V,e as de}from"../chunks/DOKer7p_.js";import{i as I}from"../chunks/BsrVr-Z0.js";import{e as re,i as ae}from"../chunks/An4e5j9g.js";import{r as J,b as ne}from"../chunks/DKsZ4ghV.js";import{M as he}from"../chunks/CJFchB7S.js";import{m as T,g as q,c as D,b as B,B as d,d as Q,a as fe,n as be,e as ge,i as _e,f as we}from"../chunks/CBhOl9Kc.js";import{b as X}from"../chunks/B25JaP4K.js";import"../chunks/CqiQQVFS.js";import{p as ye}from"../chunks/BhZD_YXM.js";const Me=t=>{const r=q(t),e=Math.floor(Math.random()*r.length);return r[e]},Ce=(t,r)=>{const e=Me(t);return{board:T(t,r,e),move:e}},xe=(t,r,e)=>{const n=Ge(t,r,e.iterations,e.c);return{board:T(t,r,n),move:n}};class oe{board;player;move;parent;children=[];visits=0;wins=0;constructor(r,e,n=null,i=null){this.board=r,this.player=e,this.move=n,this.parent=i}isFullyExpanded(){return this.children.length===q(this.board).length}isTerminal(){return B(this.board)!==d.notOver}}function Y(t,r,e,n=Math.sqrt(2)){return e===0?1/0:r/e+n*Math.sqrt(Math.log(t)/e)}function Se(t,r){for(;!t.isTerminal();)if(t.isFullyExpanded())t=Pe(t,r);else return ke(t);return t}function ke(t){const r=t.children.map(s=>s.move),n=q(t.board).filter(s=>!r.includes(s)),i=n[Math.floor(Math.random()*n.length)],l=D(t.board);T(l,t.player,i);const c=new oe(l,t.player===1?2:1,i,t);return t.children.push(c),c}function Pe(t,r){return t.children.reduce((e,n)=>{const i=Y(t.visits,e.wins,e.visits,r);return Y(t.visits,n.wins,n.visits,r)>i?n:e})}function Be(t){const r=D(t.board);let e=t.player;for(;;){const n=B(r);if(n!==d.notOver)return n;const i=q(r),l=i[Math.floor(Math.random()*i.length)];T(r,e,l),e=e===1?2:1}}function Te(t,r){let e=t;for(;e!==null;)e.visits+=1,r===d.winPlayer1&&e.parent?.player===1||r===d.winPlayer2&&e.parent?.player===2?e.wins+=1:r===d.draw&&(e.wins+=.5),e=e.parent}function Ge(t,r,e=1e3,n=Math.sqrt(2)){const i=new oe(D(t),r,null,null);for(let c=0;c<e;c++){const s=Se(i,n),m=Be(s);Te(s,m)}return i.children.reduce((c,s)=>c.visits>s.visits?c:s).move}var qe=(t,r,e,n,i)=>{a(r)&&(u(e,a(r).iterations,!0),u(n,a(r).c,!0),i())},Oe=G("<option> </option>"),Re=(t,r,e)=>{u(r,null),e()},Fe=(t,r,e)=>{u(r,null),e()},Ne=G(`<div><h4>Monte Carlo Tree Search parameters</h4> <label for="mcts-preset">Preset difficulty</label> <select></select> <br/><br/> <label for="mcts-iterations">Iterations:</label> <input id="mcts-iterations" type="number" min="0"/> <small>Number of simulations MCTS will run before choosing a move. Higher values usually mean
        stronger play but slower decisions.</small> <br/><br/> <label for="mcts-c">C (exploration constant):</label> <input id="mcts-c" type="number" min="0" step="0.1"/> <small>Controls the balance between exploration and exploitation. Lower values (e.g. 0.5, 0.7)
        favor tested moves, higher values (e.g. 2.0, 5.0) explore more. A typical default is √2 ≈
        1.41.</small></div>`);function Ee(t,r){Z(r,!0);const e=[{name:"easy",iterations:200,c:2},{name:"medium",iterations:1e3,c:1.41},{name:"hard",iterations:5e3,c:.7}];let n=y(P(e[1])),i=y(P(a(n).iterations)),l=y(P(a(n).c));const c=()=>{r.onUpdate({iterations:a(i),c:a(l)})};var s=Ne(),m=f(x(s),4);m.__change=[qe,n,i,l,c],re(m,21,()=>e,ae,(p,S)=>{var b=Oe(),O=x(b,!0);g(b);var k={};U(()=>{V(O,a(S).name),k!==(k=a(S))&&(b.value=(b.__value=a(S))??"")}),w(p,b)}),g(m);var h=f(m,7);J(h),h.__change=[Re,n,c];var M=f(h,9);J(M),M.__change=[Fe,n,c],me(2),g(s),ne(m,()=>a(n),p=>u(n,p)),X(h,()=>a(i),p=>u(i,p)),X(M,()=>a(l),p=>u(l,p)),w(t,s),ee()}te(["change"]);var Ie=G("<option> </option>"),Ue=G('<!> <div class="main"><h3>Gravitrip</h3></div> <div>See <a href="https://www.quora.com/What-is-the-winning-strategy-for-the-first-player-in-Connect-Four-games">this quora thread</a> for some tips on the winning strategy</div> <div>Computer stategy: <select></select></div> <!> <span><button>Restart game</button> <span style="font-weight: bold"><!></span></span> <!>',1);function Qe(t,r){Z(r,!0),ye.set("Gravitrip");let e=y(P(Q())),n=$(()=>B(a(e))),i=$(()=>we(a(e))),l=y("mcts"),c=y(P({iterations:1e3,c:1.41})),s=y(1),m=1,h=2;const M=()=>{u(e,Q(),!0),u(s,1),[m,h]=[h,m],h===a(s)&&b()},p=()=>u(s,a(s)===1?2:1,!0),S=o=>{m===a(s)&&_e(a(e),o)&&B(a(e))===d.notOver&&(u(e,T(a(e),m,o),!0),p(),setTimeout(()=>b(),200))},b=()=>{if(h!==a(s)||B(a(e))!==d.notOver)return;let o;if(a(l)==="random")o=Ce(a(e),a(s));else if(a(l)==="mcts")o=xe(a(e),a(s),a(c));else throw new Error("computer strategy not implemented");const{board:v}=o;u(e,v,!0),p()},O=o=>{switch(o.key){case"r":M();break}};var k=Ue();de("keydown",ve,O);var W=L(k);he(W,{title:"Gravitrip",description:"Gravitrip"});var R=f(W,6),F=f(x(R));re(F,20,()=>["mcts","random"],ae,(o,v)=>{var _=Ie(),E=x(_,!0);g(_);var C={};U(()=>{V(E,v),C!==(C=v)&&(_.value=(_.__value=v)??"")}),w(o,_)}),g(F),g(R);var j=f(R,2);{var se=o=>{Ee(o,{onUpdate:v=>u(c,v,!0)})};I(j,o=>{a(l)==="mcts"&&o(se)})}var N=f(j,2),A=x(N);A.__click=M;var H=f(A,2),ie=x(H);{var le=o=>{var v=z("Game Over");w(o,v)},ce=o=>{var v=pe(),_=L(v);{var E=C=>{var K=z();U(()=>V(K,`Player ${a(n)??""} wins`)),w(C,K)};I(_,C=>{(a(n)===d.winPlayer1||a(n)===d.winPlayer2)&&C(E)},!0)}w(o,v)};I(ie,o=>{a(n)===d.draw?o(le):o(ce,!1)})}g(H),g(N);var ue=f(N,2);fe(ue,{get nbColumns(){return ge},get nbRows(){return be},get board(){return a(e)},get winningCells(){return a(i)},onMove:S}),ne(F,()=>a(l),o=>u(l,o)),w(t,k),ee()}te(["click"]);export{Qe as component};
