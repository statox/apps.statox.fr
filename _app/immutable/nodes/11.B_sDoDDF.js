import"../chunks/CWj6FrbW.js";import{i as G}from"../chunks/DcwgafQl.js";import{p as I,aA as t,w as n,aB as r,n as C,k as H,a4 as _,g as a,v as T}from"../chunks/CLEsLeyf.js";import{t as S,a as h}from"../chunks/ChHSw3SP.js";import{M as Z}from"../chunks/BOTPG7TT.js";import{p as aa}from"../chunks/WVobhDRT.js";import{s as g}from"../chunks/yxnpV5re.js";import{a as ea}from"../chunks/Cvpi8u3q.js";import{a as j}from"../chunks/dozwfbcP.js";import{M as ta}from"../chunks/DDUw1nZK.js";import"../chunks/BiSfE-z7.js";import"../chunks/CkmFSGKM.js";import{A as f,g as ra}from"../chunks/TFg3xzEI.js";import{a as A}from"../chunks/Ct5AeG1w.js";import{i as oa}from"../chunks/CY3BqXyN.js";import{e as V,i as q}from"../chunks/DU7BiW-J.js";import{p as ia}from"../chunks/BFAS3Suf.js";const B=e=>{if(e===f.NEW)return"https://upload.wikimedia.org/wikipedia/commons/d/dd/New_Moon.jpg";if(e===f.WAXING_CRESCENT)return"https://upload.wikimedia.org/wikipedia/commons/e/e3/Waxing_Crescent_Moon_on_4-1-17_%2833627493622%29.jpg";if(e===f.FIRST_QUARTER)return"https://upload.wikimedia.org/wikipedia/commons/4/4d/Daniel_Hershman_-_march_moon_%28by%29.jpg";if(e===f.WAXING_GIBBOUS)return"https://upload.wikimedia.org/wikipedia/commons/2/2b/Lune-Nikon-600-F4_Luc_Viatour.jpg";if(e===f.FULL)return"https://upload.wikimedia.org/wikipedia/commons/b/b5/20110319_Supermoon.jpg";if(e===f.WANING_GIBBOUS)return"https://upload.wikimedia.org/wikipedia/commons/7/7d/2013-01-02_00-00-55-Waning-gibbous-moon.jpg";if(e===f.LAST_QUARTER)return"https://upload.wikimedia.org/wikipedia/commons/b/b2/Waning_gibbous_moon_near_last_quarter_-_23_Sept._2016.png";if(e===f.WANING_CRESCENT)return"https://upload.wikimedia.org/wikipedia/commons/3/35/Waning_Crescent_Moon%287Sep15%29.jpg";throw new Error("UNKOWN_LUNAR_PHASE")},na=async()=>{const e=await ra(),{moonState:c,sunState:o,upcomingLunarStates:m}=e;return{moonState:c,sunState:{goldenHour:A.fromMillis(o.goldenHour),solarNoon:A.fromMillis(o.solarNoon),sunrise:A.fromMillis(o.sunrise),sunset:A.fromMillis(o.sunset)},upcomingLunarStates:m.map(i=>({date:A.fromMillis(i.tsMillis),lunarState:{...i.lunarState,phasePictureUrl:B(i.lunarState.moonPhase)}}))}};var sa=S('<div class="day-header svelte-izihcx"> </div>'),ma=S("<div> </div> <div> </div>",1),pa=S('<div class="entry svelte-izihcx"><div><img class="phase-img svelte-izihcx"></div> <!></div>'),da=S('<div class="container svelte-izihcx"><!> <!></div>');function va(e,c){I(c,!1);let o=ia(c,"upcomingLunarStates",8);G();var m=da(),i=t(m);V(i,1,()=>o().slice(0,7),q,(v,s)=>{let p=()=>a(s).date;var w=sa(),l=t(w,!0);r(w),H(u=>g(l,u),[()=>p().setLocale("fr").toLocaleString({weekday:"long"})],_),h(v,w)});var d=n(i,2);V(d,1,o,q,(v,s,p)=>{let w=()=>a(s).date,l=()=>a(s).lunarState;var u=pa(),k=t(u),x=t(k);r(k);var W=n(k,2);{var b=L=>{var N=ma(),M=T(N),E=t(M,!0);r(M);var F=n(M,2),P=t(F,!0);r(F),H(R=>{g(E,R),g(P,l().moonPhaseFr)},[()=>w().setLocale("fr").toLocaleString({day:"2-digit",month:"2-digit"})],_),h(L,N)};oa(W,L=>{(p===0||p===29||o()[p-1].lunarState.moonPhaseFr!==l().moonPhaseFr)&&L(b)})}r(u),H(L=>{j(x,"alt",l().moonPhase),j(x,"src",L)},[()=>B(l().moonPhase)],_),h(v,u)}),r(m),h(e,m),C()}var la=S('<div class="title svelte-11kiwvj">Ephemerides</div> <div class="content svelte-11kiwvj"><div class="data svelte-11kiwvj"><span>Moon phase</span> <span> </span> <span>Moon age</span> <span> </span> <span>Moon visible</span> <span> </span> <span>Sun rise/set</span> <span> </span> <span>Solar noon</span> <span> </span> <span>Golden hour</span> <span> </span></div> <img class="phase-img svelte-11kiwvj"></div> <!>',1),ua=S("<p>Loading ephemerides data</p>"),_a=S('<div class="container svelte-11kiwvj"><!></div>');function ga(e,c){I(c,!1),G();var o=_a(),m=t(o);ea(m,na,i=>{var d=ua();h(i,d)},(i,d)=>{var v=_(()=>{var{moonState:U,sunState:$,upcomingLunarStates:y}=a(d);return{moonState:U,sunState:$,upcomingLunarStates:y}}),s=_(()=>a(v).moonState),p=_(()=>a(v).sunState),w=_(()=>a(v).upcomingLunarStates),l=la(),u=n(T(l),2),k=t(u),x=n(t(k),2),W=t(x,!0);r(x);var b=n(x,4),L=t(b);r(b);var N=n(b,4),M=t(N);r(N);var E=n(N,4),F=t(E);r(E);var P=n(E,4),R=t(P,!0);r(P);var z=n(P,4),D=t(z,!0);r(z),r(k);var O=n(k,2);r(u);var Q=n(u,2);va(Q,{get upcomingLunarStates(){return a(w)}}),H((U,$,y,X,K,J,Y)=>{g(W,a(s).moonPhaseFr),g(L,`${U??""} days (${$??""}%)`),g(M,`${a(s).moonVisibilityWindow[0]??""} - ${a(s).moonVisibilityWindow[1]??""}`),g(F,`${y??""} - ${X??""}`),g(R,K),g(D,J),j(O,"alt",a(s).moonPhase),j(O,"src",Y)},[()=>a(s).lunarAge.toFixed(1),()=>(a(s).lunarAgePercent*100).toFixed(0),()=>a(p).sunrise.toFormat("HH:mm"),()=>a(p).sunset.toFormat("HH:mm"),()=>a(p).solarNoon.toFormat("HH:mm"),()=>a(p).goldenHour.toFormat("HH:mm"),()=>B(a(s).moonPhase)],_),h(i,l)},(i,d)=>{const v=_(()=>({level:"error",header:"Something went wrong getting lunar data",message:a(d)}));ta(i,{get item(){return a(v)}})}),r(o),h(e,o),C()}var ca=S('<!> <div class="content svelte-6iu9d1"><!></div>',1);function Ra(e,c){I(c,!1),aa.set("Ephemerides"),G();var o=ca(),m=T(o);Z(m,{title:"Ephemerides",description:"Get the ephemerides"});var i=n(m,2),d=t(i);ga(d,{}),r(i),h(e,o),C()}export{Ra as component};
