import"../chunks/NZTpNUN0.js";import{a as ge}from"../chunks/DkK0P85K.js";import{x as me,y as K,z as ve,o as x,f as de,s as q,p as a,v as Q,a as f,B as Se,g as e,C as o,E as c}from"../chunks/DyWD_MJs.js";import{d as _e,s as ue}from"../chunks/BavMw1sQ.js";import{i as he}from"../chunks/Do44c4MR.js";import{e as B,i as z}from"../chunks/j2-s9Gm3.js";import{r as m,a as ce}from"../chunks/BPTubluR.js";import{b as S}from"../chunks/C6Ffm4eX.js";import{P as be}from"../chunks/3yfWr4Ty.js";import{V as pe}from"../chunks/CGriAZoZ.js";const fe=function(h,s,F,p,g){return(h-s)/(F-s)*(g-p)+p},C=(h,s)=>Math.random()*(s-h)+h,w=[[119,114,37,250],[84,119,37,220],[112,181,21,190],[120,211,2,160],[173,211,2,130],[98,54,130,100],[153,83,198,70],[148,39,226,40],[226,39,113,10]],xe=()=>{const h=[];h.push({upwardForce:0,allowOffspringBirthFactor:1,cellDeviationFactor:Number(C(.2,1).toFixed(4)),cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:15,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:Math.floor(C(2,4)),color:w[0]});for(let s=0;s<C(5,8);s++)h.push({upwardForce:0,allowOffspringBirthFactor:Number((1-s*.1).toFixed(4)),cellDeviationFactor:Number(C(.2,1).toFixed(4)),cellSizeVariationInSegment:Number(C(.93,.99).toFixed(4)),cellSpacingVariationInSegment:Number(C(.4,.6).toFixed(4)),nbCellsInSegment:Math.floor(C(2,6)),nextSegmentBaseCellSize:1,branchesMaxAngle:Math.floor(C(40,180)),nbBranches:Math.floor(C(2,4)),color:w[s+1]});return h[1].nbCellsInSegment=10,h},Fe=[{upwardForce:0,allowOffspringBirthFactor:1,cellDeviationFactor:.9,cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:25,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:w[0]},{upwardForce:0,allowOffspringBirthFactor:1,cellDeviationFactor:.9,cellSizeVariationInSegment:.985,cellSpacingVariationInSegment:.8,nbCellsInSegment:10,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:w[1]},{upwardForce:0,allowOffspringBirthFactor:1,cellDeviationFactor:.8,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:w[2]},{upwardForce:0,allowOffspringBirthFactor:.9,cellDeviationFactor:.8,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:1,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:w[3]},{upwardForce:0,allowOffspringBirthFactor:.8,cellDeviationFactor:.8,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.5,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:120,nbBranches:2,color:w[4]},{upwardForce:0,allowOffspringBirthFactor:.8,cellDeviationFactor:.7,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.4,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:w[5]},{upwardForce:0,allowOffspringBirthFactor:.7,cellDeviationFactor:.7,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:9,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:w[6]},{upwardForce:0,allowOffspringBirthFactor:.7,cellDeviationFactor:.7,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.8,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:w[7]},{upwardForce:0,allowOffspringBirthFactor:.7,cellDeviationFactor:.6,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:w[8]}];class Ie{genes;structure;constructor(){this.genes=Fe,this.structure=[]}grow(){this.structure=[];const s=[{cell:{position:new pe,size:20,color:[200,200,200,200]},agent:{level:0,levelStep:0,direction:new pe(0,20)}}];for(;s.length;){const{cell:F,agent:p}=s.shift();if(p.level===this.genes.length)continue;const{allowOffspringBirthFactor:g,cellDeviationFactor:M,cellSpacingVariationInSegment:H,nbCellsInSegment:y,color:v,cellSizeVariationInSegment:U,nextSegmentBaseCellSize:J,branchesMaxAngle:L,nbBranches:A}=this.genes[p.level];if(p.levelStep>=y){const E=-L/2,X=L/2;for(let D=0;D<A;D++){const Y=fe(D,0,A-1,E,X),Z={position:F.position.clone(),size:F.size*J,color:[200,200,200,200]},ee={level:p.level+1,levelStep:0,direction:p.direction.clone().rotateDeg(Y)};Math.random()<g&&s.push({cell:Z,agent:ee})}continue}const R={...F,position:F.position.clone().add(p.direction.clone().rotateDeg(C(-45,45)*M).multiplyScalar(H)),size:F.size*U,color:v},W={level:p.level,levelStep:p.levelStep+1,direction:p.direction.clone()};s.push({cell:R,agent:W}),this.structure.push(R)}}}const Be=(h,s,F)=>{q(s,xe(),!0),F()};var ze=(h,s)=>q(s,!e(s)),we=x('<div></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="1"/></div>',1),Ce=x('<div class="genes-container svelte-yvhszb"><div>Level</div> <div>upwardForce</div> <div>allowOffspringBirthFactor</div> <div>cellDeviationFactor</div> <div>cellSizeVariationInSegment</div> <div>nbCellsInSegment</div> <div>cellSpacingVariationInSegment</div> <div>nextSegmentBaseCellSize</div> <div>branchesMaxAngle</div> <div>nbBranches</div> <!></div>'),Ve=x("<div></div>"),ye=x('<div><input type="number" step="0.1"/></div>'),Me=x('<div><input type="number" step="0.1"/></div>'),Ae=x('<div><input type="number" step="0.1"/></div>'),De=x('<div><input type="number" step="0.1"/></div>'),$e=x('<div><input type="number" step="1"/></div>'),Oe=x('<div><input type="number" step="0.1"/></div>'),ke=x('<div><input type="number" step="0.1"/></div>'),Pe=x('<div><input type="number" step="1"/></div>'),Ne=x('<div><input type="number" step="1"/></div>'),Ge=x('<div class="genes-container-2 svelte-yvhszb"><div>Level</div> <!> <div>upwardForce</div> <!> <div>allowOffspringBirthFactor</div> <!> <div>cellDeviationFactor</div> <!> <div>cellSizeVariationInSegment</div> <!> <div>nbCellsInSegment</div> <!> <div>cellSpacingVariationInSegment</div> <!> <div>nextSegmentBaseCellSize</div> <!> <div>branchesMaxAngle</div> <!> <div>nbBranches</div> <!></div>'),Le=x("<!> <div><h2>Plant info</h2> <div> </div></div> <span><h2>Genes</h2> <button>Change view</button></span> <button>Randomize plant</button> <!>",1);function We(h,s){me(s,!0);let F;const p=new Ie;let g=K(ve([...p.genes]));p.grow();let M=K(ve(p.structure.length)),H=K(!0),y=K(0);const v=()=>{p.genes=e(g),p.grow(),q(M,p.structure.length,!0),q(y,0)},U=_=>{_.setup=()=>{F=_,_.createCanvas(1e3,600),_.noStroke()},_.draw=()=>{_.background(240,240,240);for(let I=0;I<e(y);I++){const V=p.structure[I],$=V.position.x+_.width/2,r=_.height-V.position.y,O=V.size;_.fill(V.color),_.circle($,r,O)}e(y)<e(M)&&q(y,Math.min(e(y)+50,e(M)),!0)}};ge(()=>{console.clear(),F?.remove()});var J=Le(),L=de(J);be(L,{sketch:U});var A=a(L,2),R=a(o(A),2),W=o(R);c(R),c(A);var E=a(A,2),X=a(o(E),2);X.__click=[ze,H],c(E);var D=a(E,2);D.__click=[Be,g,v];var Y=a(D,2);{var Z=_=>{var I=Ce(),V=a(o(I),20);B(V,17,()=>e(g),z,($,r,O)=>{var T=we(),k=de(T);k.textContent=O;var P=a(k,2),N=o(P);m(N),N.__change=v,c(P);var G=a(P,2),j=o(G);m(j),j.__change=v,c(G);var l=a(G,2),i=o(l);m(i),i.__change=v,c(l);var b=a(l,2),n=o(b);m(n),n.__change=v,c(b);var t=a(b,2),d=o(t);m(d),d.__change=v,c(t);var ne=a(t,2),te=o(ne);m(te),te.__change=v,c(ne);var ie=a(ne,2),ae=o(ie);m(ae),ae.__change=v,c(ie);var re=a(ie,2),le=o(re);m(le),le.__change=v,c(re);var se=a(re,2),oe=o(se);m(oe),oe.__change=v,c(se),Q(()=>ce(k,`color: ${e(r).color??""}`)),S(N,()=>e(r).upwardForce,u=>e(r).upwardForce=u),S(j,()=>e(r).allowOffspringBirthFactor,u=>e(r).allowOffspringBirthFactor=u),S(i,()=>e(r).cellDeviationFactor,u=>e(r).cellDeviationFactor=u),S(n,()=>e(r).cellSizeVariationInSegment,u=>e(r).cellSizeVariationInSegment=u),S(d,()=>e(r).nbCellsInSegment,u=>e(r).nbCellsInSegment=u),S(te,()=>e(r).cellSpacingVariationInSegment,u=>e(r).cellSpacingVariationInSegment=u),S(ae,()=>e(r).nextSegmentBaseCellSize,u=>e(r).nextSegmentBaseCellSize=u),S(le,()=>e(r).branchesMaxAngle,u=>e(r).branchesMaxAngle=u),S(oe,()=>e(r).nbBranches,u=>e(r).nbBranches=u),f($,T)}),c(I),f(_,I)},ee=_=>{var I=Ge(),V=a(o(I),2);B(V,17,()=>e(g),z,(l,i,b)=>{var n=Ve();n.textContent=b,Q(()=>ce(n,`color: ${e(i).color??""}`)),f(l,n)});var $=a(V,4);B($,17,()=>e(g),z,(l,i,b)=>{var n=ye(),t=o(n);m(t),t.__change=v,c(n),S(t,()=>e(i).upwardForce,d=>e(i).upwardForce=d),f(l,n)});var r=a($,4);B(r,17,()=>e(g),z,(l,i,b)=>{var n=Me(),t=o(n);m(t),t.__change=v,c(n),S(t,()=>e(i).allowOffspringBirthFactor,d=>e(i).allowOffspringBirthFactor=d),f(l,n)});var O=a(r,4);B(O,17,()=>e(g),z,(l,i,b)=>{var n=Ae(),t=o(n);m(t),t.__change=v,c(n),S(t,()=>e(i).cellDeviationFactor,d=>e(i).cellDeviationFactor=d),f(l,n)});var T=a(O,4);B(T,17,()=>e(g),z,(l,i,b)=>{var n=De(),t=o(n);m(t),t.__change=v,c(n),S(t,()=>e(i).cellSizeVariationInSegment,d=>e(i).cellSizeVariationInSegment=d),f(l,n)});var k=a(T,4);B(k,17,()=>e(g),z,(l,i,b)=>{var n=$e(),t=o(n);m(t),t.__change=v,c(n),S(t,()=>e(i).nbCellsInSegment,d=>e(i).nbCellsInSegment=d),f(l,n)});var P=a(k,4);B(P,17,()=>e(g),z,(l,i,b)=>{var n=Oe(),t=o(n);m(t),t.__change=v,c(n),S(t,()=>e(i).cellSpacingVariationInSegment,d=>e(i).cellSpacingVariationInSegment=d),f(l,n)});var N=a(P,4);B(N,17,()=>e(g),z,(l,i,b)=>{var n=ke(),t=o(n);m(t),t.__change=v,c(n),S(t,()=>e(i).nextSegmentBaseCellSize,d=>e(i).nextSegmentBaseCellSize=d),f(l,n)});var G=a(N,4);B(G,17,()=>e(g),z,(l,i,b)=>{var n=Pe(),t=o(n);m(t),t.__change=v,c(n),S(t,()=>e(i).branchesMaxAngle,d=>e(i).branchesMaxAngle=d),f(l,n)});var j=a(G,4);B(j,17,()=>e(g),z,(l,i,b)=>{var n=Ne(),t=o(n);m(t),t.__change=v,c(n),S(t,()=>e(i).nbBranches,d=>e(i).nbBranches=d),f(l,n)}),c(I),Q(()=>ce(I,`--nb-columns: ${1+e(g).length}`)),f(_,I)};he(Y,_=>{e(H)?_(Z):_(ee,!1)})}Q(()=>ue(W,`Nb segments: ${e(M)??""}`)),f(h,J),Se()}_e(["click","change"]);export{We as component};
