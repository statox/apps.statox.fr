import"../chunks/CWj6FrbW.js";import{p as Y,y as w,z as Z,s as k,g as e,f as j,o as l,C as n,n as ee,an as ve,B as d,k as N}from"../chunks/D4gDm57G.js";import{s as J}from"../chunks/s4055cqB.js";import{f as _,a as m,c as fe,t as de}from"../chunks/Vh0HsYHt.js";import{a as ue}from"../chunks/CykI4KT5.js";import{i as O}from"../chunks/McHEF-Jg.js";import{d as te}from"../chunks/vhkTqBca.js";import{s as re,a as oe}from"../chunks/BmusxFuE.js";import{m as pe}from"../chunks/n10vgu6d.js";import{g as _e,u as se,U as ge}from"../chunks/CcVlM4qF.js";import{M as ie}from"../chunks/Dg9v8Btr.js";import{M as be}from"../chunks/BFODdGrM.js";import{P as I}from"../chunks/CpX8xF_L.js";import{r as he,A as ke}from"../chunks/BRnwoQCQ.js";import{s as ye}from"../chunks/IjK5GOwn.js";import{e as K,i as Q}from"../chunks/BnSyOJPK.js";import{r as W,a as z}from"../chunks/Xqw48ZgO.js";import{b as X,c as we}from"../chunks/9XGeKPA3.js";import{r as xe}from"../chunks/Z9tre8Hv.js";import{t as ne}from"../chunks/DD1O5wo4.js";import{b as Se}from"../chunks/BRRsJXzH.js";import{M as Te}from"../chunks/DnUd6Mm3.js";import"../chunks/Bmw8lZQ2.js";import{p as Ue}from"../chunks/U2TU-HKj.js";const Le=!1,bt=Object.freeze(Object.defineProperty({__proto__:null,ssr:Le},Symbol.toStringTag,{value:"Module"})),ae=()=>he({path:"/reactor/getEntriesForPublic"}),Me=async u=>{const o=I+"/reactor/addEntry",g=await _e();typeof g=="string"&&await ye.post(o).auth(g,{type:"bearer"}).field("name",u.name).field("commaSeparatedTags",u.commaSeparatedTags).attach("file",u.file)};var Ce=_('<span class="tag svelte-16m67n3"> </span>'),Ae=(u,o,g)=>o(e(g)),Pe=_('<video class="medium-margin svelte-16m67n3" style="max-width: 100%" controls></video>',2),Re=_('<img class="medium-margin svelte-16m67n3"/>'),Ee=_('<div><div><b> </b></div> <div class="svelte-16m67n3"></div> <div><button class="full-width svelte-16m67n3"><i class="fas fa-copy"></i> Copy link</button></div></div> <div><a rel="noopener noreferrer" target="blank"><!></a></div>',1),Fe=(u,o)=>ve(o),Be=_('<button class="full-width medium-margin svelte-16m67n3">More...</button>'),Ne=_('<input class="full-width medium-margin svelte-16m67n3" type="text" placeholder="Search by tags or name"/> <div class="container svelte-16m67n3"></div> <!>',1);function Oe(u,o){Y(o,!0);const g=10;let L=w(1),C=w(Z([])),v=w("");const x=(a,t)=>{if(!t.length||a.name.toLowerCase().includes(t.toLowerCase()))return!0;for(const c of a.tags)if(c.toLowerCase().includes(t.toLowerCase()))return!0;return!1},S=a=>{navigator.clipboard.writeText(I+a.uri),ne.push('<i class="fas fa-check"></i> Link copied to clipboard',{duration:1e3,theme:{"--toastBarHeight":0}})},T=a=>a.s3PresignedUrl.includes(".mp4");xe(()=>{k(C,o.reactions.filter(a=>x(a,e(v))).sort((a,t)=>t.creationDateUnix-a.creationDateUnix).slice(0,e(v).length?void 0:e(L)*g),!0)});var b=Ne(),h=j(b);W(h);var M=l(h,2);K(M,21,()=>e(C),Q,(a,t)=>{var p=Ee(),c=j(p),f=d(c),P=d(f),D=d(P,!0);n(P),n(f);var R=l(f,2);K(R,21,()=>e(t).tags,Q,(y,r)=>{var i=Ce(),H=d(i,!0);n(i),N(()=>J(H,e(r))),m(y,i)}),n(R);var E=l(R,2),$=d(E);$.__click=[Ae,S,t],n(E),n(c);var F=l(c,2),U=d(F),V=d(U);{var q=y=>{var r=Pe();N(()=>z(r,"src",I+e(t).uri)),m(y,r)},G=y=>{var r=Re();N(()=>{z(r,"src",I+e(t).uri),z(r,"alt",e(t).name)}),m(y,r)};O(V,y=>{T(e(t))?y(q):y(G,!1)})}n(U),n(F),N(()=>{J(D,e(t).name),z(U,"href",I+e(t).uri),z(U,"download",e(t).name)}),m(a,p)}),n(M);var A=l(M,2);{var s=a=>{var t=Be();t.__click=[Fe,L],m(a,t)};O(A,a=>{e(v).length===0&&e(L)*g<o.reactions.length&&a(s)})}X(h,()=>e(v),a=>k(v,a)),m(u,b),ee()}te(["click"]);var $e=(u,o)=>{e(o)!==void 0&&(e(o).value="")},ze=_('<button class="form-action svelte-1f930i6"><!></button>'),Ie=_('<span class="form-action svelte-1f930i6">Login to upload an entry</span>'),je=_('<div role="dialog" class="modal svelte-1f930i6"><div class="contents svelte-1f930i6"><h4 class="title-bar svelte-1f930i6">Add a new file <button>Close</button></h4> <!> <form class="form-content svelte-1f930i6"><label for="name">Name</label> <input type="text"/> <label for="content">Tags</label> <input type="textarea"/> <label for="file">File</label> <span><input class="file-input svelte-1f930i6" type="file"/> <button aria-label="delete file"><i class="fas fa-times-circle"></i></button></span> <br/> <!></form></div></div>');function De(u,o){Y(o,!0);const[g,L]=re(),C=()=>oe(se,"$user",g);let v=w(Z([])),x=w(""),S=w(""),T=w(void 0),b=w(void 0),h=w(!1);const M=async()=>{var p;k(v,[],!0),(p=e(x))!=null&&p.length||e(v).push({level:"error",header:"name must be defined"});let t;if(e(b)&&e(b).length&&(t=e(b)[0]),t||e(v).push({level:"error",header:"a file must be uploaded"}),!(e(v).length||!t))try{k(h,!0),await Me({name:e(x),commaSeparatedTags:e(S),file:t}),k(h,!1),o.onUpload(),o.close()}catch(c){k(h,!1);let f=c.message;c instanceof ke&&c.code===401?f="Invalid logged in user":c instanceof ge&&(f="User is logged out");const P=`<strong>Entry not created</strong><br/> ${f}`;ne.push(P,{theme:{"--toastBarBackground":"#FF0000"}})}};var A=fe(),s=j(A);{var a=t=>{var p=je(),c=d(p),f=d(c),P=l(d(f));P.__click=function(...r){var i;(i=o.close)==null||i.apply(this,r)},n(f);var D=l(f,2);K(D,17,()=>e(v),Q,(r,i)=>{ie(r,{get item(){return e(i)}})});var R=l(D,2),E=l(d(R),2);W(E);var $=l(E,4);W($);var F=l($,4),U=d(F);Se(U,r=>k(T,r),()=>e(T));var V=l(U,2);V.__click=[$e,T],n(F);var q=l(F,4);{var G=r=>{var i=ze();i.__click=M;var H=d(i);{var le=B=>{Te(B,{size:.5,unit:"em",durationSeconds:.5})},ce=B=>{var me=de("Submit");m(B,me)};O(H,B=>{e(h)?B(le):B(ce,!1)})}n(i),N(()=>i.disabled=e(h)),m(r,i)},y=r=>{var i=Ie();m(r,i)};O(q,r=>{C()?r(G):r(y,!1)})}n(R),n(c),n(p),X(E,()=>e(x),r=>k(x,r)),X($,()=>e(S),r=>k(S,r)),we(U,()=>e(b),r=>k(b,r)),m(t,p)};O(s,t=>{o.isOpen&&t(a)})}m(u,A),ee(),L()}te(["click"]);var Ve=(u,o)=>pe.open(De,{onUpload:o}),qe=_("<button>Add an entry</button>"),Ge=_("<p>Something went wrong</p> <p> </p>",1),He=_("<p>Loading data</p>"),Je=_("<!> <h2>Upload</h2> <!> <h2>Content</h2> <!>",1);function ht(u,o){Y(o,!0);const[g,L]=re(),C=()=>oe(se,"$user",g);Ue.set("Reactor");let v=w(Z(ae()));const x=()=>k(v,ae(),!0);var S=Je(),T=j(S);be(T,{title:"Reactor",description:"My collection of memes"});var b=l(T,4);{var h=s=>{var a=qe();a.__click=[Ve,x],m(s,a)},M=s=>{ie(s,{item:{level:"info",header:"Login to add an entry"}})};O(b,s=>{C()?s(h):s(M,!1)})}var A=l(b,4);ue(A,()=>e(v),s=>{var a=He();m(s,a)},(s,a)=>{Oe(s,{get reactions(){return e(a)}})},(s,a)=>{var t=Ge(),p=l(j(t),2),c=d(p,!0);n(p),N(f=>J(c,f),[()=>JSON.stringify(e(a))]),m(s,t)}),m(u,S),ee(),L()}te(["click"]);export{ht as component,bt as universal};
