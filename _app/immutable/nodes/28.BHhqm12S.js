import"../chunks/NZTpNUN0.js";import{p as Y,h,a5 as Z,i as _,g as e,b as u,f as $,s,e as d,r as o,t as O,a as c,d as ee,ag as me,c as ve,j as ue}from"../chunks/OOCdeaM4.js";import{d as te,s as G}from"../chunks/DBBHR-3t.js";import{a as fe}from"../chunks/Bfiui_HV.js";import{i as B}from"../chunks/BMFH8sZT.js";import{s as re,a as oe}from"../chunks/BY6cWyRb.js";import{m as pe}from"../chunks/Dg7M2ZgA.js";import{u as se}from"../chunks/bMdrnNxv.js";import{M as ie}from"../chunks/DKcpRBkl.js";import{M as ge}from"../chunks/C8MJLfl1.js";import{P as z}from"../chunks/CELBgAxi.js";import{c as _e}from"../chunks/DPSdUY9Q.js";import{s as be}from"../chunks/BgJCQexd.js";import{e as K,i as Q}from"../chunks/80iJqotc.js";import{r as W,s as j}from"../chunks/C2XHBoXy.js";import{b as X,d as he}from"../chunks/CCHh_OeQ.js";import{r as ye}from"../chunks/Dg8bHZSE.js";import{t as ne}from"../chunks/Du_j8uFv.js";import{b as xe}from"../chunks/BZoYCivA.js";import{A as ke,U as we}from"../chunks/BI4tYcJk.js";import{M as Me}from"../chunks/C1Xki9n9.js";import"../chunks/DRxGxY2p.js";import"../chunks/DiYuexAL.js";import{p as Se}from"../chunks/BOKhb25Z.js";const Ue=!1,ut=Object.freeze(Object.defineProperty({__proto__:null,ssr:Ue},Symbol.toStringTag,{value:"Module"})),ae=_e.reactor.getEntriesForPublic,Le=async y=>{const m=z+"/reactor/addEntry";await be.post(m).withCredentials().field("name",y.name).field("commaSeparatedTags",y.commaSeparatedTags).attach("file",y.file)};var Te=u('<span class="tag svelte-noox7t"> </span>'),Ce=u('<video class="medium-margin svelte-noox7t" style="max-width: 100%" controls></video>',2),Ee=u('<img class="medium-margin svelte-noox7t"/>'),Pe=u('<div><div><b> </b></div> <div class="svelte-noox7t"></div> <div><button class="full-width svelte-noox7t"><i class="fas fa-copy"></i> Copy link</button></div></div> <div><a rel="noopener noreferrer" target="blank"><!></a></div>',1),Re=u('<button class="full-width medium-margin svelte-noox7t">More...</button>'),Ae=u('<input class="full-width medium-margin svelte-noox7t" type="text" placeholder="Search by tags or name"/> <div class="container svelte-noox7t"></div> <!>',1);function Fe(y,m){Y(m,!0);const L=10;let M=h(1),T=h(Z([])),i=h("");const x=(a,t)=>{if(!t.length||a.name.toLowerCase().includes(t.toLowerCase()))return!0;for(const l of a.tags)if(l.toLowerCase().includes(t.toLowerCase()))return!0;return!1},S=a=>{navigator.clipboard.writeText(z+a.uri),ne.push('<i class="fas fa-check"></i> Link copied to clipboard',{duration:1e3,theme:{"--toastBarHeight":0}})},k=a=>a.s3PresignedUrl.includes(".mp4");ye(()=>{_(T,m.reactions.filter(a=>x(a,e(i))).sort((a,t)=>t.creationDateUnix-a.creationDateUnix).slice(0,e(i).length?void 0:e(M)*L),!0)});var g=Ae(),f=$(g);W(f);var U=s(f,2);K(U,21,()=>e(T),Q,(a,t)=>{var n=Pe(),l=$(n),p=d(l),E=d(p),D=d(E,!0);o(E),o(p);var P=s(p,2);K(P,21,()=>e(t).tags,Q,(b,r)=>{var v=Te(),q=d(v,!0);o(v),O(()=>G(q,e(r))),c(b,v)}),o(P);var R=s(P,2),N=d(R);N.__click=()=>S(e(t)),o(R),o(l);var A=s(l,2),w=d(A),V=d(w);{var H=b=>{var r=Ce();O(()=>j(r,"src",z+e(t).uri)),c(b,r)},J=b=>{var r=Ee();O(()=>{j(r,"src",z+e(t).uri),j(r,"alt",e(t).name)}),c(b,r)};B(V,b=>{k(e(t))?b(H):b(J,!1)})}o(w),o(A),O(()=>{G(D,e(t).name),j(w,"href",z+e(t).uri),j(w,"download",e(t).name)}),c(a,n)}),o(U);var C=s(U,2);{var I=a=>{var t=Re();t.__click=()=>me(M),c(a,t)};B(C,a=>{e(i).length===0&&e(M)*L<m.reactions.length&&a(I)})}X(f,()=>e(i),a=>_(i,a)),c(y,g),ee()}te(["click"]);var Oe=u('<button class="form-action svelte-1kgynly"><!></button>'),Be=u('<span class="form-action svelte-1kgynly">Login to upload an entry</span>'),Ie=u('<div role="dialog" class="modal svelte-1kgynly"><div class="contents svelte-1kgynly"><h4 class="title-bar svelte-1kgynly">Add a new file <button>Close</button></h4> <!> <form class="form-content svelte-1kgynly"><label for="name">Name</label> <input type="text"/> <label for="content">Tags</label> <input type="textarea"/> <label for="file">File</label> <span><input class="file-input svelte-1kgynly" type="file"/> <button aria-label="delete file"><i class="fas fa-times-circle"></i></button></span> <br/> <!></form></div></div>');function Ne(y,m){Y(m,!0);const L=()=>oe(se,"$user",M),[M,T]=re();let i=h(Z([])),x=h(""),S=h(""),k=h(void 0),g=h(void 0),f=h(!1);const U=async()=>{_(i,[],!0),e(x)?.length||e(i).push({level:"error",header:"name must be defined"});let t;if(e(g)&&e(g).length&&(t=e(g)[0]),t||e(i).push({level:"error",header:"a file must be uploaded"}),!(e(i).length||!t))try{_(f,!0),await Le({name:e(x),commaSeparatedTags:e(S),file:t}),_(f,!1),m.onUpload(),m.close()}catch(n){_(f,!1);let l=n.message;n instanceof ke&&n.code===401?l="Invalid logged in user":n instanceof we&&(l="User is logged out");const p=`<strong>Entry not created</strong><br/> ${l}`;ne.push(p,{theme:{"--toastBarBackground":"#FF0000"}})}};var C=ve(),I=$(C);{var a=t=>{var n=Ie(),l=d(n),p=d(l),E=s(d(p));E.__click=function(...r){m.close?.apply(this,r)},o(p);var D=s(p,2);K(D,17,()=>e(i),Q,(r,v)=>{ie(r,{get item(){return e(v)}})});var P=s(D,2),R=s(d(P),2);W(R);var N=s(R,4);W(N);var A=s(N,4),w=d(A);xe(w,r=>_(k,r),()=>e(k));var V=s(w,2);V.__click=()=>{e(k)!==void 0&&(e(k).value="")},o(A);var H=s(A,4);{var J=r=>{var v=Oe();v.__click=U;var q=d(v);{var le=F=>{Me(F,{size:.5,unit:"em",durationSeconds:.5})},ce=F=>{var de=ue("Submit");c(F,de)};B(q,F=>{e(f)?F(le):F(ce,!1)})}o(v),O(()=>v.disabled=e(f)),c(r,v)},b=r=>{var v=Be();c(r,v)};B(H,r=>{L()?r(J):r(b,!1)})}o(P),o(l),o(n),X(R,()=>e(x),r=>_(x,r)),X(N,()=>e(S),r=>_(S,r)),he(w,()=>e(g),r=>_(g,r)),c(t,n)};B(I,t=>{m.isOpen&&t(a)})}c(y,C),ee(),T()}te(["click"]);var je=u("<button>Add an entry</button>"),ze=u("<p>Something went wrong</p> <p> </p>",1),$e=u("<p>Loading data</p>"),De=u("<!> <h2>Upload</h2> <!> <h2>Content</h2> <!>",1);function ft(y,m){Y(m,!0);const L=()=>oe(se,"$user",M),[M,T]=re(),i={name:"Reactor",description:"My collection of memes"};Se.set(i);let x=h(Z(ae()));const S=()=>_(x,ae(),!0);var k=De(),g=$(k);ge(g,{get title(){return i.name},get description(){return i.description}});var f=s(g,4);{var U=a=>{var t=je();t.__click=()=>pe.open(Ne,{onUpload:S}),c(a,t)},C=a=>{ie(a,{item:{level:"info",header:"Login to add an entry"}})};B(f,a=>{L()?a(U):a(C,!1)})}var I=s(f,4);fe(I,()=>e(x),a=>{var t=$e();c(a,t)},(a,t)=>{Fe(a,{get reactions(){return e(t)}})},(a,t)=>{var n=ze(),l=s($(n),2),p=d(l,!0);o(l),O(E=>G(p,E),[()=>JSON.stringify(e(t))]),c(a,n)}),c(y,k),ee(),T()}te(["click"]);export{ft as component,ut as universal};
