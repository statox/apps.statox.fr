import"../chunks/NZTpNUN0.js";import{o as X,a as Z}from"../chunks/D8ZVDlyY.js";import{p as $,b as g,s as S,f as c,a as o,d as ee,e as t,g as i,h as r,i as x,r as R,t as O,c as C,j as L}from"../chunks/tjCGPzdr.js";import{d as ae,s as W}from"../chunks/DOKer7p_.js";import{i as m}from"../chunks/BsrVr-Z0.js";import{B,a as te}from"../chunks/BLGMfthj.js";import{P as re}from"../chunks/CpX8xF_L.js";var oe=g("<p> </p> <button>New game</button>",1),se=g("<p>Connecting…</p>"),ne=g("<p>Waiting for another player…</p>"),le=g("<p> </p>"),fe=g('<h3>Simple WebSocket Client</h3> <!> <span style="font-weight: bold"><!></span> <!>',1);function ce(M,U){$(U,!0);let s,w=i(!1),b=i(!1),N=i(null),_=i(null),p=i(null),h=i(!1),P=i("");const I=re.replace(/^http?/,"ws");X(()=>{A()}),Z(()=>{s&&s.close()});const A=()=>{s=new WebSocket(I),t(_,null),s.onopen=()=>{t(w,!0),t(h,!1),t(P,null)},s.onclose=e=>{t(w,!1),t(h,!0),t(b,!1),t(P,e.reason,!0)},s.onmessage=e=>{const a=JSON.parse(e.data);a.type==="game_ready"?(t(b,!0),t(N,a.youAre,!0),t(_,a.board,!0)):a.type==="update_board"?(t(_,a.board,!0),t(p,a.boardState,!0)):a.type==="waiting_for_opponent"&&(t(b,!1),t(p,null))}},J=e=>{if(!s||s.readyState!==WebSocket.OPEN)return;const a=JSON.stringify({move:e});s.send(a)};var E=fe(),G=S(c(E),2);{var j=e=>{var a=oe(),l=c(a),u=x(l);R(l);var f=S(l,2);f.__click=A,O(()=>W(u,`Game over - ${r(P)??""}`)),o(e,a)},D=e=>{var a=C(),l=c(a);{var u=n=>{var y=se();o(n,y)},f=n=>{var y=C(),H=c(y);{var K=v=>{var d=ne();o(v,d)},Q=v=>{var d=le(),T=x(d);R(d),O(()=>W(T,`Game started! You are Player ${r(N)??""}`)),o(v,d)};m(H,v=>{r(b)?v(Q,!1):v(K)},!0)}o(n,y)};m(l,n=>{r(w)?n(f,!1):n(u)},!0)}o(e,a)};m(G,e=>{r(h)?e(j):e(D,!1)})}var k=S(G,2),V=x(k);{var Y=e=>{var a=L("Game Over");o(e,a)},q=e=>{var a=C(),l=c(a);{var u=f=>{var n=L();O(()=>W(n,`Player ${r(p)??""} wins`)),o(f,n)};m(l,f=>{(r(p)===B.winPlayer1||r(p)===B.winPlayer2)&&f(u)},!0)}o(e,a)};m(V,e=>{r(p)===B.draw?e(Y):e(q,!1)})}R(k);var z=S(k,2);{var F=e=>{te(e,{nbColumns:7,nbRows:6,get board(){return r(_)},winningCells:null,onMove:J})};m(z,e=>{r(_)!==null&&e(F)})}o(M,E),ee()}ae(["click"]);export{ce as component};
