import"../chunks/NZTpNUN0.js";import{z as re,A as V,B as se,p as L,f as O,F as P,x as R,a as m,E as le,v as E,s as w,g as s,aZ as Z,G as M,a_ as j,c as q}from"../chunks/Br9SMxIB.js";import{d as ie,s as ae}from"../chunks/BBzb7ThI.js";import{i as D}from"../chunks/CvXxFVm9.js";import{e as H,i as J}from"../chunks/D1-nhZYT.js";import{a as oe,s as ce,c as K}from"../chunks/DWdbj9D8.js";import{M as ue}from"../chunks/DKmGubEx.js";var _=(t=>(t[t.notOver=0]="notOver",t[t.winPlayer1=1]="winPlayer1",t[t.winPlayer2=2]="winPlayer2",t[t.draw=3]="draw",t))(_||{});const x=7,p=6,u=4;class fe extends Error{constructor(n){super("Can't play in column "+n)}}const N=(t,n)=>t[n].length!==p,ve=t=>{const n=[];for(let e=0;e<t.length;e++)t[e].length<p&&n.push(e);return n},ge=t=>{const n=x*p,e=t.reduce((l,c)=>l+c.length,0);return n===e},he=t=>{for(let n=0;n<x;n++)for(let e=0;e<p;e++){if(t[n].length<e||!t[n][e])continue;const l=t[n][e];let c=0,f=0,v=0,i=0;for(let r=0;r<u;r++)e+r<=t[n].length&&t[n][e+r]===l&&c++,n+r<t.length&&t[n+r][e]===l&&f++,n+r<t.length&&e+r<=t[n+r].length&&t[n+r][e+r]===l&&v++,n+r<t.length&&e-r>=0&&t[n+r][e-r]===l&&i++;if(c===u||f===u||v===u||i===u)return l}return null},pe=t=>{if(k(t)===0)return null;for(let n=0;n<x;n++)for(let e=0;e<p;e++){if(t[n].length<e||!t[n][e])continue;const l=t[n][e],c=[],f=[],v=[],i=[];for(let r=0;r<u;r++)e+r<=t[n].length&&t[n][e+r]===l&&c.push([e+r,n]),n+r<t.length&&t[n+r][e]===l&&f.push([e,n+r]),n+r<t.length&&e+r<=t[n+r].length&&t[n+r][e+r]===l&&v.push([e+r,n+r]),n+r<t.length&&e-r>=0&&t[n+r][e-r]===l&&i.push([e-r,n+r]);if(c.length===u)return c;if(f.length===u)return f;if(v.length===u)return v;if(i.length===u)return i}return null},k=t=>{if(ge(t))return 3;const n=he(t);return n===1?1:n===2?2:0},Q=(t,n,e)=>{if(!N(t,e))throw new fe(e);return t[e].push(n),t},me=t=>{const n=ve(t),e=Math.floor(Math.random()*n.length);return n[e]},_e=(t,n)=>{const e=me(t);return Q(t,n,e)},we=(t,n,e)=>{w(n,Array.from({length:7},()=>[]),!0),w(e,1)};var ye=(t,n,e,l)=>n(s(e),s(l)),de=L("<div><button><div></div></button></div>"),Me=L('<!> <div class="main"><h3>Gravitrip</h3></div> <span><button>Restart game</button> <span style="font-weight: bold"><!></span></span> <div class="board svelte-1bdwycb"></div>',1);function Oe(t,n){re(n,!0);let e=V(se(Array.from({length:7},()=>[]))),l=Z(()=>k(s(e))),c=Z(()=>pe(s(e)));const f=Array.from({length:p},(o,a)=>a),v=Array.from({length:x},(o,a)=>a);let i=V(1);const r=(o,a)=>{s(i)===1&&N(s(e),o)&&k(s(e))===_.notOver&&(w(e,Q(s(e),a,o),!0),w(i,s(i)===1?2:1,!0),setTimeout(()=>U(),300))},U=()=>{s(i)===2&&k(s(e))===_.notOver&&(w(e,_e(s(e),s(i)),!0),w(i,s(i)===1?2:1,!0))},X=(o,a)=>s(c)===null?!1:s(c).filter(h=>h[0]===o&&h[1]===a).length>0;var W=Me(),F=O(W);ue(F,{title:"Gravitrip",description:"Gravitrip"});var A=E(F,4),$=P(A);$.__click=[we,e,i];var b=E($,2),Y=P(b);{var B=o=>{var a=j("Game Over");m(o,a)},S=o=>{var a=q(),h=O(a);{var G=y=>{var g=j();R(()=>ae(g,`Player ${s(l)??""} wins`)),m(y,g)};D(h,y=>{(s(l)===_.winPlayer1||s(l)===_.winPlayer2)&&y(G)},!0)}m(o,a)};D(Y,o=>{s(l)===_.draw?o(B):o(S,!1)})}M(b),M(A);var C=E(A,2);H(C,21,()=>f.reverse(),J,(o,a)=>{var h=q(),G=O(h);H(G,17,()=>v,J,(y,g)=>{var I=de(),d=P(I);let z;d.__click=[ye,r,g,i];var ee=P(d);let T;M(d),M(I),R((te,ne)=>{ce(d,"aria-label","col-"+s(g)),z=K(d,1,"outer-cell svelte-1bdwycb",null,z,te),T=K(ee,1,"cell svelte-1bdwycb",null,T,ne)},[()=>({"winning-cell":X(s(a),s(g))}),()=>({player1:s(e)[s(g)][s(a)]===1,player2:s(e)[s(g)][s(a)]===2})]),m(y,I)}),m(o,h)}),M(C),R(()=>oe(C,`--nb-col: ${x}; --nb-row: ${p}`)),m(t,W),le()}ie(["click"]);export{Oe as component};
