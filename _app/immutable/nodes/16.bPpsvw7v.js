import"../chunks/NZTpNUN0.js";import{z as Y,A as V,B,p as H,f as I,F as M,x as O,a as u,E as S,v as R,s as m,g as n,aZ as ee,G as g,a_ as W,c as Z}from"../chunks/Br9SMxIB.js";import{d as te,s as re}from"../chunks/BBzb7ThI.js";import{i as j}from"../chunks/CvXxFVm9.js";import{e as q,i as D}from"../chunks/D1-nhZYT.js";import{a as ne,s as se,c as ae}from"../chunks/DWdbj9D8.js";import{M as ie}from"../chunks/DKmGubEx.js";var f=(e=>(e[e.notOver=0]="notOver",e[e.winPlayer1=1]="winPlayer1",e[e.winPlayer2=2]="winPlayer2",e[e.draw=3]="draw",e))(f||{});const x=7,p=6,h=4;class le extends Error{constructor(r){super("Can't play in column "+r)}}const J=(e,r)=>e[r].length!==p,oe=e=>{const r=x*p,t=e.reduce((s,v)=>s+v.length,0);return r===t},ce=e=>{for(let r=0;r<x;r++)for(let t=0;t<p;t++){if(e[r].length<t||!e[r][t])continue;const s=e[r][t];let v=0,d=0,o=0,y=0;for(let a=0;a<h;a++)t+a<=e[r].length&&e[r][t+a]===s&&v++,r+a<e.length&&e[r+a][t]===s&&d++,r+a<e.length&&t+a<=e[r+a].length&&e[r+a][t+a]===s&&o++,r+a<e.length&&t-a>=0&&e[r+a][t-a]===s&&y++;if(v===h||d===h||o===h||y===h)return s}return null},C=e=>{if(oe(e))return 3;const r=ce(e);return r===1?1:r===2?2:0},K=(e,r,t)=>{if(!J(e,t))throw new le(t);return e[t].push(r),e},ve=e=>{const r=[];for(let s=0;s<e.length;s++)e[s].length<p&&r.push(s);const t=Math.floor(Math.random()*r.length);return r[t]},ue=(e,r)=>{const t=ve(e);return K(e,r,t)},fe=(e,r,t)=>{m(r,Array.from({length:7},()=>[]),!0),m(t,1)};var me=(e,r,t,s)=>r(n(t),n(s)),pe=H('<div><button class="outer-cell svelte-1bdwycb"><div></div></button></div>'),_e=H('<!> <div class="main"><h3>Gravitrip</h3></div> <span><button>Restart game</button> <span style="font-weight: bold"><!></span></span> <div class="board svelte-1bdwycb"></div>',1);function xe(e,r){Y(r,!0);let t=V(B(Array.from({length:7},()=>[]))),s=ee(()=>C(n(t)));const v=Array.from({length:p},(i,l)=>l),d=Array.from({length:x},(i,l)=>l);let o=V(1);const y=(i,l)=>{n(o)===1&&J(n(t),i)&&C(n(t))===f.notOver&&(m(t,K(n(t),l,i),!0),m(o,n(o)===1?2:1,!0),setTimeout(()=>a(),300))},a=()=>{n(o)===2&&C(n(t))===f.notOver&&(m(t,ue(n(t),n(o)),!0),m(o,n(o)===1?2:1,!0))};var E=_e(),F=I(E);ie(F,{title:"Gravitrip",description:"Gravitrip"});var k=R(F,4),$=M(k);$.__click=[fe,t,o];var z=R($,2),L=M(z);{var N=i=>{var l=W("Game Over");u(i,l)},Q=i=>{var l=Z(),w=I(l);{var A=_=>{var c=W();O(()=>re(c,`Player ${n(s)??""} wins`)),u(_,c)};j(w,_=>{(n(s)===f.winPlayer1||n(s)===f.winPlayer2)&&_(A)},!0)}u(i,l)};j(L,i=>{n(s)===f.draw?i(N):i(Q,!1)})}g(z),g(k);var P=R(k,2);q(P,21,()=>v.reverse(),D,(i,l)=>{var w=Z(),A=I(w);q(A,17,()=>d,D,(_,c)=>{var G=pe(),b=M(G);b.__click=[me,y,c,o];var U=M(b);let T;g(b),g(G),O(X=>{se(b,"aria-label","col-"+n(c)),T=ae(U,1,"cell svelte-1bdwycb",null,T,X)},[()=>({player1:n(t)[n(c)][n(l)]===1,player2:n(t)[n(c)][n(l)]===2})]),u(_,G)}),u(i,w)}),g(P),O(()=>ne(P,`--nb-col: ${x}; --nb-row: ${p}`)),u(e,E),S()}te(["click"]);export{xe as component};
