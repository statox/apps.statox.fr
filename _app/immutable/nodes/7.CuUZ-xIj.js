import"../chunks/NZTpNUN0.js";import{p as O,b as h,s,f as y,a as g,d as R,e as u,r as m,t as Y,g as a,h as _,i as n,u as Z}from"../chunks/D1gec7hp.js";import{s as j}from"../chunks/DqykZqCX.js";import{i as k}from"../chunks/BQPfd91e.js";import{r as x}from"../chunks/CwBosGx5.js";import{d as z}from"../chunks/DBXcV7xI.js";import{b as I}from"../chunks/cDPM8xt1.js";import{s as B,a as C}from"../chunks/CTwF8py8.js";import{a as G,g as J}from"../chunks/DfBDZx0T.js";import{u as K,l as Q,c as V}from"../chunks/UCEXYAMP.js";import{s as L}from"../chunks/L7JTY0uw.js";import{M as W}from"../chunks/BE8lkt7b.js";var X=h("<p> </p>"),ee=h('<div><section><label for="username">Username</label> <input id="username" name="username" type="text" autocomplete="username" required/></section> <section><label for="current-password">Password</label> <input id="current-password" name="password" type="password" autocomplete="current-password" required/></section> <button>Sign in</button></div> <!>',1),re=h("<h2>Login</h2> <!>",1);function fe(S,U){O(U,!0);const p=()=>C(K,"$user",q),[q,A]=B();let l=_(""),d=_(""),o=_(void 0),c="/";G(({from:e})=>{e?.url.pathname!=="/auth/login"&&(c=e?.url.pathname||c)});const E=async()=>{try{await Q(a(l),a(d)),await V(),p()?.status=="logged_in"?(L.set(!0),setTimeout(()=>L.set(!1),2500),J(c)):n(o,new Error("Invalid password or username"),!0)}catch(e){if(e?.message==='{"message":"UNAUTHORIZED"}'){n(o,"Invalid password or username");return}n(o,e,!0)}};var w=re(),M=s(y(w),2);{var N=e=>{var t=X(),i=u(t);m(t),Y(()=>j(i,`You are already logged in a ${p()?.user.username??""}`)),g(e,t)},P=e=>{var t=ee(),i=y(t),f=u(i),b=s(u(f),2);x(b),m(f);var v=s(f,2),$=s(u(v),2);x($),m(v);var T=s(v,2);T.__click=E,m(i);var D=s(i,2);{var F=r=>{{let H=Z(()=>({level:"error",header:"Failed auth",message:a(o).toString()}));W(r,{get item(){return a(H)}})}};k(D,r=>{a(o)&&r(F)})}I(b,()=>a(l),r=>n(l,r)),I($,()=>a(d),r=>n(d,r)),g(e,t)};k(M,e=>{p()?.status=="logged_in"?e(N):e(P,!1)})}g(S,w),R(),A()}z(["click"]);export{fe as component};
