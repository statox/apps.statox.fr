import"../chunks/NZTpNUN0.js";import{p as Y,e as y,a8 as Z,h as b,g as e,b as f,f as $,s as i,r as s,a as l,d as ee,ai as ve,i as v,t as I,c as me,k as ue}from"../chunks/BjuhH6lp.js";import{d as te,s as J}from"../chunks/BHQPUIUI.js";import{a as fe}from"../chunks/m6IlzdLY.js";import{i as N}from"../chunks/Cw8fytvj.js";import{a as re,s as oe}from"../chunks/u5ZAmcyg.js";import{m as pe}from"../chunks/BqWwabYr.js";import{r as ge,g as _e,u as se,A as be,U as he}from"../chunks/DHfKupDm.js";import{M as ie}from"../chunks/DaF2b9q9.js";import{M as ye}from"../chunks/C496T15D.js";import{P as z}from"../chunks/CpX8xF_L.js";import{s as ke}from"../chunks/BgJCQexd.js";import{e as K,i as Q}from"../chunks/CLKJSt8A.js";import{r as W,a as B}from"../chunks/DEs50KOR.js";import{b as X,d as xe}from"../chunks/BszEGJcu.js";import{r as we}from"../chunks/Du8u8s6E.js";import{t as ne}from"../chunks/Djhp2DQ4.js";import{b as Se}from"../chunks/vjjVwZwv.js";import{M as Te}from"../chunks/Cm6lANdz.js";import"../chunks/DvQ7C2d6.js";import{p as Ue}from"../chunks/DEIc314f.js";const Le=!1,vt=Object.freeze(Object.defineProperty({__proto__:null,ssr:Le},Symbol.toStringTag,{value:"Module"})),ae=()=>ge({path:"/reactor/getEntriesForPublic"}),Me=async k=>{const m=z+"/reactor/addEntry",x=await _e();typeof x=="string"&&await ke.post(m).auth(x,{type:"bearer"}).field("name",k.name).field("commaSeparatedTags",k.commaSeparatedTags).attach("file",k.file)};var Ce=f('<span class="tag svelte-noox7t"> </span>'),Ae=f('<video class="medium-margin svelte-noox7t" style="max-width: 100%" controls></video>',2),Pe=f('<img class="medium-margin svelte-noox7t"/>'),Re=f('<div><div><b> </b></div> <div class="svelte-noox7t"></div> <div><button class="full-width svelte-noox7t"><i class="fas fa-copy"></i> Copy link</button></div></div> <div><a rel="noopener noreferrer" target="blank"><!></a></div>',1),Ee=f('<button class="full-width medium-margin svelte-noox7t">More...</button>'),Fe=f('<input class="full-width medium-margin svelte-noox7t" type="text" placeholder="Search by tags or name"/> <div class="container svelte-noox7t"></div> <!>',1);function Ie(k,m){Y(m,!0);const x=10;let L=y(1),C=y(Z([])),c=y("");const S=(a,t)=>{if(!t.length||a.name.toLowerCase().includes(t.toLowerCase()))return!0;for(const d of a.tags)if(d.toLowerCase().includes(t.toLowerCase()))return!0;return!1},T=a=>{navigator.clipboard.writeText(z+a.uri),ne.push('<i class="fas fa-check"></i> Link copied to clipboard',{duration:1e3,theme:{"--toastBarHeight":0}})},w=a=>a.s3PresignedUrl.includes(".mp4");we(()=>{b(C,m.reactions.filter(a=>S(a,e(c))).sort((a,t)=>t.creationDateUnix-a.creationDateUnix).slice(0,e(c).length?void 0:e(L)*x),!0)});var g=Fe(),_=$(g);W(_);var M=i(_,2);K(M,21,()=>e(C),Q,(a,t)=>{var n=Re(),d=$(n),p=v(d),j=v(p),D=v(j,!0);s(j),s(p);var P=i(p,2);K(P,21,()=>e(t).tags,Q,(h,r)=>{var u=Ce(),H=v(u,!0);s(u),I(()=>J(H,e(r))),l(h,u)}),s(P);var R=i(P,2),O=v(R);O.__click=()=>T(e(t)),s(R),s(d);var E=i(d,2),U=v(E),V=v(U);{var q=h=>{var r=Ae();I(()=>B(r,"src",z+e(t).uri)),l(h,r)},G=h=>{var r=Pe();I(()=>{B(r,"src",z+e(t).uri),B(r,"alt",e(t).name)}),l(h,r)};N(V,h=>{w(e(t))?h(q):h(G,!1)})}s(U),s(E),I(()=>{J(D,e(t).name),B(U,"href",z+e(t).uri),B(U,"download",e(t).name)}),l(a,n)}),s(M);var A=i(M,2);{var o=a=>{var t=Ee();t.__click=()=>ve(L),l(a,t)};N(A,a=>{e(c).length===0&&e(L)*x<m.reactions.length&&a(o)})}X(_,()=>e(c),a=>b(c,a)),l(k,g),ee()}te(["click"]);var Ne=f('<button class="form-action svelte-1kgynly"><!></button>'),Oe=f('<span class="form-action svelte-1kgynly">Login to upload an entry</span>'),Be=f('<div role="dialog" class="modal svelte-1kgynly"><div class="contents svelte-1kgynly"><h4 class="title-bar svelte-1kgynly">Add a new file <button>Close</button></h4> <!> <form class="form-content svelte-1kgynly"><label for="name">Name</label> <input type="text"/> <label for="content">Tags</label> <input type="textarea"/> <label for="file">File</label> <span><input class="file-input svelte-1kgynly" type="file"/> <button aria-label="delete file"><i class="fas fa-times-circle"></i></button></span> <br/> <!></form></div></div>');function ze(k,m){Y(m,!0);const x=()=>oe(se,"$user",L),[L,C]=re();let c=y(Z([])),S=y(""),T=y(""),w=y(void 0),g=y(void 0),_=y(!1);const M=async()=>{b(c,[],!0),e(S)?.length||e(c).push({level:"error",header:"name must be defined"});let t;if(e(g)&&e(g).length&&(t=e(g)[0]),t||e(c).push({level:"error",header:"a file must be uploaded"}),!(e(c).length||!t))try{b(_,!0),await Me({name:e(S),commaSeparatedTags:e(T),file:t}),b(_,!1),m.onUpload(),m.close()}catch(n){b(_,!1);let d=n.message;n instanceof be&&n.code===401?d="Invalid logged in user":n instanceof he&&(d="User is logged out");const p=`<strong>Entry not created</strong><br/> ${d}`;ne.push(p,{theme:{"--toastBarBackground":"#FF0000"}})}};var A=me(),o=$(A);{var a=t=>{var n=Be(),d=v(n),p=v(d),j=i(v(p));j.__click=function(...r){m.close?.apply(this,r)},s(p);var D=i(p,2);K(D,17,()=>e(c),Q,(r,u)=>{ie(r,{get item(){return e(u)}})});var P=i(D,2),R=i(v(P),2);W(R);var O=i(R,4);W(O);var E=i(O,4),U=v(E);Se(U,r=>b(w,r),()=>e(w));var V=i(U,2);V.__click=()=>{e(w)!==void 0&&(e(w).value="")},s(E);var q=i(E,4);{var G=r=>{var u=Ne();u.__click=M;var H=v(u);{var le=F=>{Te(F,{size:.5,unit:"em",durationSeconds:.5})},ce=F=>{var de=ue("Submit");l(F,de)};N(H,F=>{e(_)?F(le):F(ce,!1)})}s(u),I(()=>u.disabled=e(_)),l(r,u)},h=r=>{var u=Oe();l(r,u)};N(q,r=>{x()?r(G):r(h,!1)})}s(P),s(d),s(n),X(R,()=>e(S),r=>b(S,r)),X(O,()=>e(T),r=>b(T,r)),xe(U,()=>e(g),r=>b(g,r)),l(t,n)};N(o,t=>{m.isOpen&&t(a)})}l(k,A),ee(),C()}te(["click"]);var $e=f("<button>Add an entry</button>"),je=f("<p>Something went wrong</p> <p> </p>",1),De=f("<p>Loading data</p>"),Ve=f("<!> <h2>Upload</h2> <!> <h2>Content</h2> <!>",1);function mt(k,m){Y(m,!0);const x=()=>oe(se,"$user",L),[L,C]=re();Ue.set("Reactor");let c=y(Z(ae()));const S=()=>b(c,ae(),!0);var T=Ve(),w=$(T);ye(w,{title:"Reactor",description:"My collection of memes"});var g=i(w,4);{var _=o=>{var a=$e();a.__click=()=>pe.open(ze,{onUpload:S}),l(o,a)},M=o=>{ie(o,{item:{level:"info",header:"Login to add an entry"}})};N(g,o=>{x()?o(_):o(M,!1)})}var A=i(g,4);fe(A,()=>e(c),o=>{var a=De();l(o,a)},(o,a)=>{Ie(o,{get reactions(){return e(a)}})},(o,a)=>{var t=je(),n=i($(t),2),d=v(n,!0);s(n),I(p=>J(d,p),[()=>JSON.stringify(e(a))]),l(o,t)}),l(k,T),ee(),C()}te(["click"]);export{mt as component,vt as universal};
