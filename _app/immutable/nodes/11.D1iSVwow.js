import"../chunks/CWj6FrbW.js";import{i as G}from"../chunks/DcwgafQl.js";import{p as I,aA as t,w as p,aB as o,k as F,a4 as f,n as j,g as d,v as U}from"../chunks/CLEsLeyf.js";import{t as b,a as L}from"../chunks/ChHSw3SP.js";import{a as Q}from"../chunks/Cvpi8u3q.js";import"../chunks/Bpzo92iQ.js";import"../chunks/gSwGzEo6.js";import{A as k,g as X}from"../chunks/BYVm19O9.js";import{a as E}from"../chunks/Ct5AeG1w.js";import{M as K}from"../chunks/BOTPG7TT.js";import{p as J}from"../chunks/asTiDTTE.js";import{M as T}from"../chunks/DDUw1nZK.js";import{s as c}from"../chunks/yxnpV5re.js";import{a as H}from"../chunks/dozwfbcP.js";import{p as y}from"../chunks/BFAS3Suf.js";import{i as Y}from"../chunks/CY3BqXyN.js";import{e as q,i as B}from"../chunks/DU7BiW-J.js";const C=e=>{if(e===k.NEW)return"https://upload.wikimedia.org/wikipedia/commons/d/dd/New_Moon.jpg";if(e===k.WAXING_CRESCENT)return"https://upload.wikimedia.org/wikipedia/commons/e/e3/Waxing_Crescent_Moon_on_4-1-17_%2833627493622%29.jpg";if(e===k.FIRST_QUARTER)return"https://upload.wikimedia.org/wikipedia/commons/4/4d/Daniel_Hershman_-_march_moon_%28by%29.jpg";if(e===k.WAXING_GIBBOUS)return"https://upload.wikimedia.org/wikipedia/commons/2/2b/Lune-Nikon-600-F4_Luc_Viatour.jpg";if(e===k.FULL)return"https://upload.wikimedia.org/wikipedia/commons/b/b5/20110319_Supermoon.jpg";if(e===k.WANING_GIBBOUS)return"https://upload.wikimedia.org/wikipedia/commons/7/7d/2013-01-02_00-00-55-Waning-gibbous-moon.jpg";if(e===k.LAST_QUARTER)return"https://upload.wikimedia.org/wikipedia/commons/b/b2/Waning_gibbous_moon_near_last_quarter_-_23_Sept._2016.png";if(e===k.WANING_CRESCENT)return"https://upload.wikimedia.org/wikipedia/commons/3/35/Waning_Crescent_Moon%287Sep15%29.jpg";throw new Error("UNKOWN_LUNAR_PHASE")},Z=async()=>{const e=await X(),{moonState:_,sunState:a,upcomingLunarStates:i}=e;return{moonState:_,sunState:{goldenHour:E.fromMillis(a.goldenHour),solarNoon:E.fromMillis(a.solarNoon),sunrise:E.fromMillis(a.sunrise),sunset:E.fromMillis(a.sunset)},upcomingLunarStates:i.map(n=>({date:E.fromMillis(n.tsMillis),lunarState:{...n.lunarState,phasePictureUrl:C(n.lunarState.moonPhase)}}))}};var aa=b('<div class="container svelte-aoqlu7"><div class="content svelte-aoqlu7"><div class="data svelte-aoqlu7"><span>Moon phase</span> <span> </span> <span>Moon age</span> <span> </span> <span>Moon visible</span> <span> </span> <span>Sun rise/set</span> <span> </span> <span>Solar noon</span> <span> </span> <span>Golden hour</span> <span> </span></div> <img class="phase-img svelte-aoqlu7"></div></div>');function ea(e,_){I(_,!1);let a=y(_,"moonState",8),i=y(_,"sunState",8);G();var n=aa(),N=t(n),s=t(N),r=p(t(s),2),m=t(r,!0);o(r);var u=p(r,4),g=t(u);o(u);var l=p(u,4),S=t(l);o(l);var h=p(l,4),M=t(h);o(h);var v=p(h,4),P=t(v,!0);o(v);var w=p(v,4),A=t(w,!0);o(w),o(s);var x=p(s,2);o(N),o(n),F((W,R,$,z,O,V,D)=>{c(m,a().moonPhaseFr),c(g,`${W??""} days (${R??""}%)`),c(S,`${a().moonVisibilityWindow[0]??""} - ${a().moonVisibilityWindow[1]??""}`),c(M,`${$??""} - ${z??""}`),c(P,O),c(A,V),H(x,"alt",a().moonPhase),H(x,"src",D)},[()=>a().lunarAge.toFixed(1),()=>(a().lunarAgePercent*100).toFixed(0),()=>i().sunrise.toFormat("HH:mm"),()=>i().sunset.toFormat("HH:mm"),()=>i().solarNoon.toFormat("HH:mm"),()=>i().goldenHour.toFormat("HH:mm"),()=>C(a().moonPhase)],f),L(e,n),j()}var ta=b('<div class="day-header svelte-1eu73z"> </div>'),oa=b("<div> </div> <div> </div>",1),ra=b('<div class="entry svelte-1eu73z"><img class="phase-img svelte-1eu73z"> <!></div>'),ia=b('<div class="container svelte-1eu73z"><!> <!></div>');function na(e,_){I(_,!1);let a=y(_,"upcomingLunarStates",8);G();var i=ia(),n=t(i);q(n,1,()=>a().slice(0,7),B,(s,r)=>{let m=()=>d(r).date;var u=ta(),g=t(u,!0);o(u),F(l=>c(g,l),[()=>m().setLocale("fr").toLocaleString({weekday:"long"})],f),L(s,u)});var N=p(n,2);q(N,1,a,B,(s,r,m)=>{let u=()=>d(r).date,g=()=>d(r).lunarState;var l=ra(),S=t(l),h=p(S,2);{var M=v=>{var P=oa(),w=U(P),A=t(w,!0);o(w);var x=p(w,2),W=t(x,!0);o(x),F(R=>{c(A,R),c(W,g().moonPhaseFr)},[()=>u().setLocale("fr").toLocaleString({day:"2-digit",month:"2-digit"})],f),L(v,P)};Y(h,v=>{(m===0||m===29||a()[m-1].lunarState.moonPhaseFr!==g().moonPhaseFr)&&v(M)})}o(l),F(v=>{H(S,"alt",g().moonPhase),H(S,"src",v)},[()=>C(g().moonPhase)],f),L(s,l)}),o(i),L(e,i),j()}var sa=b("<!> <br> <!> <br> <!>",1),ma=b("<p>Loading ephemerides data</p>"),pa=b('<!> <div class="content"><!></div>',1);function Aa(e,_){I(_,!1),J.set("Ephemerides"),G();var a=pa(),i=U(a);K(i,{title:"Ephemerides",description:"Get the ephemerides"});var n=p(i,2),N=t(n);Q(N,Z,s=>{var r=ma();L(s,r)},(s,r)=>{var m=f(()=>{var{moonState:P,sunState:w,upcomingLunarStates:A}=d(r);return{moonState:P,sunState:w,upcomingLunarStates:A}}),u=f(()=>d(m).moonState),g=f(()=>d(m).sunState),l=f(()=>d(m).upcomingLunarStates),S=sa(),h=U(S);ea(h,{get moonState(){return d(u)},get sunState(){return d(g)}});var M=p(h,4);na(M,{get upcomingLunarStates(){return d(l)}});var v=p(M,4);T(v,{item:{level:"info",message:"All data is computed for Paris, France"}}),L(s,S)},(s,r)=>{const m=f(()=>({level:"error",header:"Something went wrong getting ephemerides data",message:d(r)}));T(s,{get item(){return d(m)}})}),o(n),L(e,a),j()}export{Aa as component};
