import"../chunks/NZTpNUN0.js";import{a as ge}from"../chunks/CPGr-zPk.js";import{x as Se,y as J,z as se,o as z,p as l,f as le,s as j,w as re,a as b,B as me,g as n,C as v,E as u}from"../chunks/CF3vMb2z.js";import{d as xe,s as pe}from"../chunks/CK0MUMJY.js";import{i as ye}from"../chunks/DhdTNEOV.js";import{e as B,i as V}from"../chunks/zmj_gju8.js";import{r as x,a as oe}from"../chunks/Cjffvopl.js";import{b as p}from"../chunks/U96Opfl6.js";import{P as _e}from"../chunks/TU7-fKk4.js";class k extends Error{constructor(){super("Tried to divide by 0")}}class K{x=0;y=0;constructor(e=0,t=0){this.x=e,this.y=t}addX(e){return this.x+=e.x,this}addY(e){return this.y+=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addScalarX(e){return this.x+=e,this}addScalarY(e){return this.y+=e,this}subtractX(e){return this.x-=e.x,this}subtractY(e){return this.y-=e.y,this}subtract(e){return this.x-=e.x,this.y-=e.y,this}subtractScalar(e){return this.x-=e,this.y-=e,this}subtractScalarX(e){return this.x-=e,this}subtractScalarY(e){return this.y-=e,this}divideX(e){if(e.x===0)throw new k;return this.x/=e.x,this}divideY(e){if(e.y===0)throw new k;return this.y/=e.y,this}divide(e){if(e.x===0||e.y===0)throw new k;return this.x/=e.x,this.y/=e.y,this}divideScalar(e){if(e===0)throw new k;return this.x/=e,this.y/=e,this}divideScalarX(e){if(e===0)throw new k;return this.x/=e,this}divideScalarY(e){if(e===0)throw new k;return this.y/=e,this}multiplyX(e){return this.x*=e.x,this}multiplyY(e){return this.y*=e.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}multiplyScalarX(e){return this.x*=e,this}multiplyScalarY(e){return this.y*=e,this}invertX(){return this.x*=-1,this}invertY(){return this.y*=-1,this}invert(){return this.x*=-1,this.y*=-1,this}normalize(){const e=this.length();return this.divideScalar(e),this}norm=this.normalize;limit(e,t){return Math.abs(this.x)>e&&(this.x*=t),Math.abs(this.y)>e&&(this.y*=t),this}randomizeX(e,t){const a=Math.min(e.x,t.x),c=Math.max(e.x,t.x);return this.x=he(a,c),this}randomizeY(e,t){const a=Math.min(e.y,t.y),c=Math.max(e.y,t.y);return this.y=he(a,c),this}randomize(e,t){return this.randomizeX(e,t),this.randomizeY(e,t),this}randomizeAny(e,t){return Math.random()<.5?this.randomizeX(e,t):this.randomizeY(e,t),this}unfloat(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}toFixed(e=8){return this.x=Number(this.x.toFixed(e)),this.y=Number(this.y.toFixed(e)),this}mixX(e,t=.5){return this.x=(1-t)*this.x+t*e.x,this}mixY(e,t=.5){return this.y=(1-t)*this.y+t*e.y,this}mix(e,t=.5){return this.mixX(e,t),this.mixY(e,t),this}clone(){return new K(this.x,this.y)}copyX(e){return this.x=e.x,this}copyY(e){return this.y=e.y,this}copy(e){return this.x=e.x,this.y=e.y,this}zero(){return this.x=0,this.y=0,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}projectOnto(e){const t=(this.x*e.x+this.y*e.y)/(e.x*e.x+e.y*e.y);return this.x=t*e.x,this.y=t*e.y,this}horizontalAngle(){return Math.atan2(this.y,this.x)}horizontalAngleDeg(){return ce(this.horizontalAngle())}verticalAngle(){return Math.atan2(this.x,this.y)}verticalAngleDeg(){return ce(this.verticalAngle())}angle=this.horizontalAngle;direction=this.horizontalAngle;angleDeg=this.horizontalAngleDeg;rotate(e){const t=this.x*Math.cos(e)-this.y*Math.sin(e),a=this.x*Math.sin(e)+this.y*Math.cos(e);return this.x=t,this.y=a,this}rotateDeg(e){const t=de(e);return this.rotate(t)}rotateTo(e){return this.rotate(e-this.horizontalAngle())}rotateToDeg(e){const t=de(e);return this.rotateTo(t)}distanceX(e){return this.x-e.x}absDistanceX(e){return Math.abs(this.distanceX(e))}distanceY(e){return this.y-e.y}absDistanceY(e){return Math.abs(this.distanceY(e))}distance(e){return Math.sqrt(this.distanceSq(e))}distanceSq(e){const t=this.distanceX(e),a=this.distanceY(e);return t*t+a*a}length(){return Math.sqrt(this.lengthSq())}magnitude=this.length;lengthSq(){return this.x*this.x+this.y*this.y}isZero(){return this.x===0&&this.y===0}isEqualTo(e){return this.x===e.x&&this.y===e.y}toString(){return`x: ${this.x}, y: ${this.y}`}toArray(){return[this.x,this.y]}toObject(){return{x:this.x,y:this.y}}}const ve=180/Math.PI;function he(o,e){return Math.random()*(e-o)+o}function ce(o){return o*ve}function de(o){return o/ve}const be=function(o,e,t,a,c){return(o-e)/(t-e)*(c-a)+a},C=(o,e)=>Math.random()*(e-o)+o,f=[[10,110,30,250],[255,0,0,220],[255,200,0,190],[0,255,0,160],[255,255,0,130],[0,200,255,100],[200,255,0,70],[255,0,200,40],[255,0,255,10]],ze=()=>{const o=[];o.push({cellDeviationFactor:C(.2,1),cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:15,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:Math.floor(C(2,4)),color:f[0]});for(let e=0;e<C(5,8);e++)o.push({cellDeviationFactor:C(.2,1),cellSizeVariationInSegment:C(.93,.99),cellSpacingVariationInSegment:C(.4,.6),nbCellsInSegment:Math.floor(C(2,6)),nextSegmentBaseCellSize:1,branchesMaxAngle:Math.floor(C(40,180)),nbBranches:Math.floor(C(2,4)),color:f[e+1]});return o[1].nbCellsInSegment=10,o},Ie=[{cellDeviationFactor:.9,cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:25,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:f[0]},{cellDeviationFactor:.9,cellSizeVariationInSegment:.985,cellSpacingVariationInSegment:.8,nbCellsInSegment:10,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:f[1]},{cellDeviationFactor:.8,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:f[2]},{cellDeviationFactor:.8,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:1,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:f[3]},{cellDeviationFactor:.8,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.5,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:120,nbBranches:2,color:f[4]},{cellDeviationFactor:.7,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.4,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:f[5]},{cellDeviationFactor:.7,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:9,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:f[6]},{cellDeviationFactor:.7,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.8,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:f[7]},{cellDeviationFactor:.6,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:f[8]}];class fe{genes;structure;constructor(){this.genes=Ie,this.structure=[]}grow(){this.structure=[];const e=[{cell:{position:new K,size:20,color:[200,200,200,200]},agent:{level:0,levelStep:0,direction:new K(0,20)}}];for(;e.length;){const{cell:t,agent:a}=e.shift();if(a.level===this.genes.length)continue;const{cellDeviationFactor:c,cellSpacingVariationInSegment:D,nbCellsInSegment:O,color:A,cellSizeVariationInSegment:g,nextSegmentBaseCellSize:Q,branchesMaxAngle:P,nbBranches:q}=this.genes[a.level];if(a.levelStep>=O){const U=-P/2,T=P/2;for(let E=0;E<q;E++){const H=be(E,0,q-1,U,T),W={position:t.position.clone(),size:t.size*Q,color:[200,200,200,200]},R={level:a.level+1,levelStep:0,direction:a.direction.clone().rotateDeg(H)};e.push({cell:W,agent:R})}continue}const w={...t,position:t.position.clone().add(a.direction.clone().rotateDeg(C(-45,45)*c).multiplyScalar(D)),size:t.size*g,color:A},Z={level:a.level,levelStep:a.levelStep+1,direction:a.direction.clone()};e.push({cell:w,agent:Z}),this.structure.push(w)}}}const Ce=(o,e,t)=>{j(e,ze(),!0),t()};var Me=(o,e)=>j(e,!n(e)),Be=z('<div></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="1"/></div>',1),Ve=z('<div class="genes-container svelte-oh8uui"><div>Level</div> <div>cellDeviationFactor</div> <div>cellSizeVariationInSegment</div> <div>nbCellsInSegment</div> <div>cellSpacingVariationInSegment</div> <div>nextSegmentBaseCellSize</div> <div>branchesMaxAngle</div> <div>nbBranches</div> <!></div>'),Ae=z("<div></div>"),De=z('<div><input type="number" step="0.1"/></div>'),we=z('<div><input type="number" step="0.1"/></div>'),Fe=z('<div><input type="number" step="1"/></div>'),Xe=z('<div><input type="number" step="0.1"/></div>'),Ye=z('<div><input type="number" step="0.1"/></div>'),$e=z('<div><input type="number" step="1"/></div>'),ke=z('<div><input type="number" step="1"/></div>'),Pe=z('<div class="genes-container-2 svelte-oh8uui"><div>Level</div> <!> <div>cellDeviationFactor</div> <!> <div>cellSizeVariationInSegment</div> <!> <div>nbCellsInSegment</div> <!> <div>cellSpacingVariationInSegment</div> <!> <div>nextSegmentBaseCellSize</div> <!> <div>branchesMaxAngle</div> <!> <div>nbBranches</div> <!></div>'),qe=z("<h1>Here be flowers</h1> <!> <div><h2>Plant info</h2> <div> </div></div> <span><h2>Genes</h2> <button>Change view</button></span> <button>Randomize plant</button> <!>",1);function Ke(o,e){Se(e,!0);let t;const a=new fe;let c=J(se([...a.genes]));a.grow();let D=J(se(a.structure.length)),O=J(!0),A=J(0);const g=()=>{a.genes=n(c),a.grow(),j(D,a.structure.length,!0),j(A,0)},Q=S=>{S.setup=()=>{t=S,S.createCanvas(1e3,1e3),S.noStroke()},S.draw=()=>{S.background(240,240,240);for(let I=0;I<n(A);I++){const M=a.structure[I],F=M.position.x+S.width/2,h=S.height-M.position.y,X=M.size;S.fill(M.color),S.circle(F,h,X)}n(A)<n(D)&&j(A,Math.min(n(A)+50,n(D)),!0)}};ge(()=>{console.clear(),t?.remove()});var P=qe(),q=l(le(P),2);_e(q,{sketch:Q});var w=l(q,2),Z=l(v(w),2),U=v(Z);u(Z),u(w);var T=l(w,2),E=l(v(T),2);E.__click=[Me,O],u(T);var H=l(T,2);H.__click=[Ce,c,g];var W=l(H,2);{var R=S=>{var I=Ve(),M=l(v(I),16);B(M,17,()=>n(c),V,(F,h,X)=>{var G=Be(),Y=le(G);Y.textContent=X;var $=l(Y,2),N=v($);x(N),N.__change=g,u($);var d=l($,2),s=v(d);x(s),s.__change=g,u(d);var _=l(d,2),i=v(_);x(i),i.__change=g,u(_);var r=l(_,2),m=v(r);x(m),m.__change=g,u(r);var L=l(r,2),ee=v(L);x(ee),ee.__change=g,u(L);var te=l(L,2),ne=v(te);x(ne),ne.__change=g,u(te);var ae=l(te,2),ie=v(ae);x(ie),ie.__change=g,u(ae),re(()=>oe(Y,`color: ${n(h).color??""}`)),p(N,()=>n(h).cellDeviationFactor,y=>n(h).cellDeviationFactor=y),p(s,()=>n(h).cellSizeVariationInSegment,y=>n(h).cellSizeVariationInSegment=y),p(i,()=>n(h).nbCellsInSegment,y=>n(h).nbCellsInSegment=y),p(m,()=>n(h).cellSpacingVariationInSegment,y=>n(h).cellSpacingVariationInSegment=y),p(ee,()=>n(h).nextSegmentBaseCellSize,y=>n(h).nextSegmentBaseCellSize=y),p(ne,()=>n(h).branchesMaxAngle,y=>n(h).branchesMaxAngle=y),p(ie,()=>n(h).nbBranches,y=>n(h).nbBranches=y),b(F,G)}),u(I),b(S,I)},ue=S=>{var I=Pe(),M=l(v(I),2);B(M,17,()=>n(c),V,(d,s,_)=>{var i=Ae();i.textContent=_,re(()=>oe(i,`color: ${n(s).color??""}`)),b(d,i)});var F=l(M,4);B(F,17,()=>n(c),V,(d,s,_)=>{var i=De(),r=v(i);x(r),r.__change=g,u(i),p(r,()=>n(s).cellDeviationFactor,m=>n(s).cellDeviationFactor=m),b(d,i)});var h=l(F,4);B(h,17,()=>n(c),V,(d,s,_)=>{var i=we(),r=v(i);x(r),r.__change=g,u(i),p(r,()=>n(s).cellSizeVariationInSegment,m=>n(s).cellSizeVariationInSegment=m),b(d,i)});var X=l(h,4);B(X,17,()=>n(c),V,(d,s,_)=>{var i=Fe(),r=v(i);x(r),r.__change=g,u(i),p(r,()=>n(s).nbCellsInSegment,m=>n(s).nbCellsInSegment=m),b(d,i)});var G=l(X,4);B(G,17,()=>n(c),V,(d,s,_)=>{var i=Xe(),r=v(i);x(r),r.__change=g,u(i),p(r,()=>n(s).cellSpacingVariationInSegment,m=>n(s).cellSpacingVariationInSegment=m),b(d,i)});var Y=l(G,4);B(Y,17,()=>n(c),V,(d,s,_)=>{var i=Ye(),r=v(i);x(r),r.__change=g,u(i),p(r,()=>n(s).nextSegmentBaseCellSize,m=>n(s).nextSegmentBaseCellSize=m),b(d,i)});var $=l(Y,4);B($,17,()=>n(c),V,(d,s,_)=>{var i=$e(),r=v(i);x(r),r.__change=g,u(i),p(r,()=>n(s).branchesMaxAngle,m=>n(s).branchesMaxAngle=m),b(d,i)});var N=l($,4);B(N,17,()=>n(c),V,(d,s,_)=>{var i=ke(),r=v(i);x(r),r.__change=g,u(i),p(r,()=>n(s).nbBranches,m=>n(s).nbBranches=m),b(d,i)}),u(I),b(S,I)};ye(W,S=>{n(O)?S(R):S(ue,!1)})}re(()=>pe(U,`Nb segments: ${n(D)??""}`)),b(o,P),me()}xe(["click","change"]);export{Ke as component};
