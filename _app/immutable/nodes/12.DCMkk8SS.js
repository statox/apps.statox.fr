import"../chunks/NZTpNUN0.js";import"../chunks/B2E521tF.js";import{p as U,b as w,e as h,h as y,s as m,g as e,a$ as te,r as b,a as k,d as A,t as j,i as p,aj as z,b6 as ae,j as re,c as oe,f as ne}from"../chunks/CAng7chV.js";import{i as $}from"../chunks/D8trZI8D.js";import{i as se}from"../chunks/BSvMLZ5U.js";import{a as D,s as O}from"../chunks/DueeSYB5.js";import{u as R,U as ie}from"../chunks/DNN2QcUe.js";import{M as Q}from"../chunks/ap-v-anE.js";import{d as S,s as le}from"../chunks/B31O6ZDe.js";import{e as G,i as H}from"../chunks/BjJWMaWl.js";import{r as F}from"../chunks/h-aEY1xR.js";import{b as N}from"../chunks/B4T-OeiH.js";import{A as de}from"../chunks/DbZds5bN.js";import{M as ue}from"../chunks/BdbkdRz4.js";import{t as J}from"../chunks/Cho2_ESd.js";import{a as ce,b as ve}from"../chunks/CZatiwl7.js";import{g as me}from"../chunks/C-Z6awDl.js";import{I as fe}from"../chunks/CU4ph5eh.js";import{a as pe}from"../chunks/DczscSsP.js";import{p as ge}from"../chunks/CFmQBWvH.js";import{p as be}from"../chunks/SdzEE8ls.js";const _e=(g,t)=>{p(t,!1)};var he=(g,t,i)=>t(e(i)),ye=w('<div class="option svelte-hwqdr1"> </div>'),ke=w('<div class="dropdown svelte-hwqdr1"></div>'),xe=w('<span><input type="text" class="svelte-hwqdr1"/> <!></span>');function we(g,t){U(t,!0);const i=a=>a.normalize("NFD").replace(/[\u0300-\u036f]/g,"");let o=ge(t,"value",15),n=y(!1),c=te(()=>t.options.filter(a=>o().length<2?!1:i(a).toLowerCase().includes(i(o()).toLowerCase())));function d(a){o(a),p(n,!0)}var s=xe(),r=h(s);F(r),r.__input=[_e,n];var u=m(r,2);{var f=a=>{var _=ke();G(_,21,()=>e(c),H,(B,q)=>{var x=ye();x.__click=[he,d,q];var L=h(x,!0);b(x),j(()=>le(L,e(q))),k(B,x)}),b(_),k(a,_)};$(u,a=>{e(c).length>0&&!e(n)&&a(f)})}b(s),N(r,o),k(g,s),A()}S(["input","click"]);const Ie=(g,t,i,o,n)=>{e(t)&&i.onAdd({name:e(t),quantity:e(o),unit:e(n)})};var qe=w('<div class="input-container svelte-yzduke"><label for="name">Ingredient</label> <!> <label for="quantity">Quantity</label> <input type="number"/> <label for="quantity">Unit</label> <input type="text"/> <button><i class="fa fa-solid fa-plus"></i></button></div>');function Le(g,t){U(t,!0);let i=y(z([])),o=y(""),n=y(void 0),c=y(void 0);pe(async()=>{p(i,(await ce()).ingredients.sort((a,_)=>a<_?1:0).map(a=>a.name),!0)});var d=qe(),s=m(h(d),2);we(s,{get options(){return e(i)},get value(){return e(o)},set value(a){p(o,a,!0)}});var r=m(s,4);F(r);var u=m(r,4);F(u);var f=m(u,2);f.__click=[Ie,o,t,n,c],b(d),N(r,()=>e(n),a=>p(n,a)),N(u,()=>e(c),a=>p(c,a)),k(g,d),A()}S(["click"]);const Ne=async(g,t,i,o,n,c,d)=>{if(p(t,[],!0),e(i)?.length||e(t).push({level:"error",header:"Name must be defined"}),e(o)?.length||e(t).push({level:"error",header:"Content must be defined"}),!e(t).length)try{p(n,!0),await ve({name:e(i),content:e(o),ingredients:c}),p(n,!1),d.onUpload()}catch(s){p(n,!1);let r=s.message;s instanceof de&&s.code===401?r="Invalid logged in user":s instanceof ie&&(r="User is logged out");const u=`<strong>Entry not created</strong><br/> ${r}`;J.push(u,{theme:{"--toastBarBackground":"#FF0000"}})}};var $e=()=>me("/cookbook"),Fe=w('<button class="form-action svelte-1ycbaol"><!></button>'),Ue=w('<span class="form-action svelte-1ycbaol">Login to upload an entry</span>'),Ae=w('<div class="contents svelte-1ycbaol"><span class="title-bar svelte-1ycbaol"><h2>Add a new recipe</h2> <button class="svelte-1ycbaol">Back to list</button></span> <!> <div class="form-content svelte-1ycbaol"><label for="name">Name</label> <input type="text"/> <label for="ingredients">New ingredient</label> <div><!></div> <label for="ingredients">List of ingredients</label> <div><!></div> <label for="content">Instructions</label> <textarea rows="10" cols="50"></textarea></div> <!></div>');function Be(g,t){U(t,!0);const i=()=>D(R,"$user",o),[o,n]=O();let c=y(z([])),d=y(!1),s=y(""),r=y(""),u=z([]);const f=l=>{if(u.find(v=>v.name===l.name)){const v=l.name+" already added";J.push(v,{theme:{"--toastBarBackground":"#FF0000"}});return}u.push(l)};var a=Ae(),_=h(a),B=m(h(_),2);B.__click=[$e],b(_);var q=m(_,2);G(q,17,()=>e(c),H,(l,v)=>{Q(l,{get item(){return e(v)}})});var x=m(q,2),L=m(h(x),2);F(L);var C=m(L,4),K=h(C);Le(K,{onAdd:f}),b(C);var M=m(C,4),P=h(M);fe(P,{get ingredients(){return u},editable:!0}),b(M);var E=m(M,4);ae(E),b(x);var T=m(x,2);{var V=l=>{var v=Fe();v.__click=[Ne,c,s,r,d,u,t];var X=h(v);{var Y=I=>{ue(I,{size:.5,unit:"em",durationSeconds:.5})},Z=I=>{var ee=re("Submit");k(I,ee)};$(X,I=>{e(d)?I(Y):I(Z,!1)})}b(v),j(()=>v.disabled=e(d)),k(l,v)},W=l=>{var v=Ue();k(l,v)};$(T,l=>{i()?l(V):l(W,!1)})}b(a),N(L,()=>e(s),l=>p(s,l)),N(E,()=>e(r),l=>p(r,l)),k(g,a),A(),n()}S(["click"]);function et(g,t){U(t,!1);const i=()=>D(R,"$user",o),[o,n]=O();be.set("Cookbook");const c=()=>{console.log("New recipe created")};se();var d=oe(),s=ne(d);{var r=f=>{Be(f,{onUpload:c})},u=f=>{Q(f,{item:{level:"info",header:"Login to add an entry"}})};$(s,f=>{i()?f(r):f(u,!1)})}k(g,d),A(),n()}export{et as component};
