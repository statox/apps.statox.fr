import"../chunks/NZTpNUN0.js";import{a as de}from"../chunks/eHPvmyNl.js";import{x as ue,z as te,y as L,o as I,p as o,f as ne,s as O,w as R,a as z,B as ge,C as u,g as n,E as g}from"../chunks/CF3vMb2z.js";import{d as ve,s as xe}from"../chunks/CVy4YE01.js";import{i as Se}from"../chunks/DhdTNEOV.js";import{e as C,i as M}from"../chunks/zmj_gju8.js";import{r as y,a as ie}from"../chunks/BTYzRZWn.js";import{b as p}from"../chunks/BPdl2Dks.js";import{P as me}from"../chunks/BQ9zzujc.js";class Y extends Error{constructor(){super("Tried to divide by 0")}}class Z{x=0;y=0;constructor(e=0,t=0){this.x=e,this.y=t}addX(e){return this.x+=e.x,this}addY(e){return this.y+=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addScalarX(e){return this.x+=e,this}addScalarY(e){return this.y+=e,this}subtractX(e){return this.x-=e.x,this}subtractY(e){return this.y-=e.y,this}subtract(e){return this.x-=e.x,this.y-=e.y,this}subtractScalar(e){return this.x-=e,this.y-=e,this}subtractScalarX(e){return this.x-=e,this}subtractScalarY(e){return this.y-=e,this}divideX(e){if(e.x===0)throw new Y;return this.x/=e.x,this}divideY(e){if(e.y===0)throw new Y;return this.y/=e.y,this}divide(e){if(e.x===0||e.y===0)throw new Y;return this.x/=e.x,this.y/=e.y,this}divideScalar(e){if(e===0)throw new Y;return this.x/=e,this.y/=e,this}divideScalarX(e){if(e===0)throw new Y;return this.x/=e,this}divideScalarY(e){if(e===0)throw new Y;return this.y/=e,this}multiplyX(e){return this.x*=e.x,this}multiplyY(e){return this.y*=e.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}multiplyScalarX(e){return this.x*=e,this}multiplyScalarY(e){return this.y*=e,this}invertX(){return this.x*=-1,this}invertY(){return this.y*=-1,this}invert(){return this.x*=-1,this.y*=-1,this}normalize(){const e=this.length();return this.divideScalar(e),this}norm=this.normalize;limit(e,t){return Math.abs(this.x)>e&&(this.x*=t),Math.abs(this.y)>e&&(this.y*=t),this}randomizeX(e,t){const i=Math.min(e.x,t.x),l=Math.max(e.x,t.x);return this.x=re(i,l),this}randomizeY(e,t){const i=Math.min(e.y,t.y),l=Math.max(e.y,t.y);return this.y=re(i,l),this}randomize(e,t){return this.randomizeX(e,t),this.randomizeY(e,t),this}randomizeAny(e,t){return Math.random()<.5?this.randomizeX(e,t):this.randomizeY(e,t),this}unfloat(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}toFixed(e=8){return this.x=Number(this.x.toFixed(e)),this.y=Number(this.y.toFixed(e)),this}mixX(e,t=.5){return this.x=(1-t)*this.x+t*e.x,this}mixY(e,t=.5){return this.y=(1-t)*this.y+t*e.y,this}mix(e,t=.5){return this.mixX(e,t),this.mixY(e,t),this}clone(){return new Z(this.x,this.y)}copyX(e){return this.x=e.x,this}copyY(e){return this.y=e.y,this}copy(e){return this.x=e.x,this.y=e.y,this}zero(){return this.x=0,this.y=0,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}projectOnto(e){const t=(this.x*e.x+this.y*e.y)/(e.x*e.x+e.y*e.y);return this.x=t*e.x,this.y=t*e.y,this}horizontalAngle(){return Math.atan2(this.y,this.x)}horizontalAngleDeg(){return se(this.horizontalAngle())}verticalAngle(){return Math.atan2(this.x,this.y)}verticalAngleDeg(){return se(this.verticalAngle())}angle=this.horizontalAngle;direction=this.horizontalAngle;angleDeg=this.horizontalAngleDeg;rotate(e){const t=this.x*Math.cos(e)-this.y*Math.sin(e),i=this.x*Math.sin(e)+this.y*Math.cos(e);return this.x=t,this.y=i,this}rotateDeg(e){const t=ae(e);return this.rotate(t)}rotateTo(e){return this.rotate(e-this.horizontalAngle())}rotateToDeg(e){const t=ae(e);return this.rotateTo(t)}distanceX(e){return this.x-e.x}absDistanceX(e){return Math.abs(this.distanceX(e))}distanceY(e){return this.y-e.y}absDistanceY(e){return Math.abs(this.distanceY(e))}distance(e){return Math.sqrt(this.distanceSq(e))}distanceSq(e){const t=this.distanceX(e),i=this.distanceY(e);return t*t+i*i}length(){return Math.sqrt(this.lengthSq())}magnitude=this.length;lengthSq(){return this.x*this.x+this.y*this.y}isZero(){return this.x===0&&this.y===0}isEqualTo(e){return this.x===e.x&&this.y===e.y}toString(){return`x: ${this.x}, y: ${this.y}`}toArray(){return[this.x,this.y]}toObject(){return{x:this.x,y:this.y}}}const le=180/Math.PI;function re(S,e){return Math.random()*(e-S)+S}function se(S){return S*le}function ae(S){return S/le}const ye=function(S,e,t,i,l){return(S-e)/(t-e)*(l-i)+i};class pe{genes;structure;constructor(){this.genes=[{cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:25,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:"white"},{cellSizeVariationInSegment:.985,cellSpacingVariationInSegment:.8,nbCellsInSegment:10,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"red"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"orange"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:1,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"green"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.5,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:120,nbBranches:2,color:"yellow"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.4,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"lightblue"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:9,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:"lightgreen"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.8,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"lightred"},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:"purple"}],this.structure=[]}grow(){this.structure=[];const e=[{cell:{position:new Z,size:20,color:"white"},agent:{level:0,levelStep:0,direction:new Z(0,20)}}];for(;e.length;){const{cell:t,agent:i}=e.shift();if(i.level===this.genes.length)continue;const{cellSpacingVariationInSegment:l,nbCellsInSegment:V,color:E,cellSizeVariationInSegment:B,nextSegmentBaseCellSize:H,branchesMaxAngle:v,nbBranches:F}=this.genes[i.level];if(i.levelStep>=V){const k=-v/2,j=v/2;for(let D=0;D<F;D++){const P=ye(D,0,F-1,k,j),J={position:t.position.clone(),size:t.size*H,color:"white"},G={level:i.level+1,levelStep:0,direction:i.direction.clone().rotateDeg(P)};e.push({cell:J,agent:G})}continue}const $={...t,position:t.position.clone().add(i.direction.clone().multiplyScalar(l)),size:t.size*B,color:E},N={level:i.level,levelStep:i.levelStep+1,direction:i.direction.clone()};e.push({cell:$,agent:N}),this.structure.push($)}}}const be=(S,e,t,i)=>{for(;e.length;)e.pop();e.push({cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:25,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:Math.floor(t(2,4)),color:"white"});for(let l=0;l<t(5,8);l++)e.push({cellSizeVariationInSegment:t(.93,.99),cellSpacingVariationInSegment:t(.4,.6),nbCellsInSegment:Math.floor(t(2,6)),nextSegmentBaseCellSize:1,branchesMaxAngle:Math.floor(t(40,180)),nbBranches:Math.floor(t(2,4)),color:"white"});e[1].nbCellsInSegment=10,i()};var _e=(S,e)=>O(e,!n(e)),ze=I('<div></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="1"/></div>',1),Ie=I('<div class="genes-container svelte-1xx9u18"><div>Level</div> <div>cellSizeVariationInSegment</div> <div>nbCellsInSegment</div> <div>cellSpacingVariationInSegment</div> <div>nextSegmentBaseCellSize</div> <div>branchesMaxAngle</div> <div>nbBranches</div> <!></div>'),fe=I("<div></div>"),Ce=I('<div><input type="number" step="0.1"/></div>'),Me=I('<div><input type="number" step="1"/></div>'),Be=I('<div><input type="number" step="0.1"/></div>'),Ve=I('<div><input type="number" step="0.1"/></div>'),Ae=I('<div><input type="number" step="1"/></div>'),we=I('<div><input type="number" step="1"/></div>'),Xe=I('<div class="genes-container-2 svelte-1xx9u18"><div>Level</div> <!> <div>cellSizeVariationInSegment</div> <!> <div>nbCellsInSegment</div> <!> <div>cellSpacingVariationInSegment</div> <!> <div>nextSegmentBaseCellSize</div> <!> <div>branchesMaxAngle</div> <!> <div>nbBranches</div> <!></div>'),Ye=I("<h1>Here be flowers</h1> <!> <div><h2>Plant info</h2> <div> </div></div> <span><h2>Genes</h2> <button>Change view</button></span> <button>Randomize plant</button> <!>",1);function je(S,e){ue(e,!0);let t;const i=new pe,l=te([...i.genes]);i.grow();let V=L(te(i.structure.length)),E=L(!0),B=L(0);function H(h,m){return Math.random()*(m-h)+h}const v=()=>{i.genes=l,i.grow(),O(V,i.structure.length,!0),O(B,0)},F=h=>{h.setup=()=>{t=h,h.createCanvas(1e3,1e3),h.background("black"),h.noStroke()},h.draw=()=>{h.background("black");for(let m=0;m<n(B);m++){const f=i.structure[m],A=f.position.x+h.width/2,c=h.height-f.position.y,w=f.size;h.fill(f.color),h.circle(A,c,w)}n(B)<n(V)&&O(B,Math.min(n(B)+50,n(V)),!0)}};de(()=>{console.clear(),t?.remove()});var $=Ye(),N=o(ne($),2);me(N,{sketch:F});var k=o(N,2),j=o(u(k),2),D=u(j);g(j),g(k);var P=o(k,2),J=o(u(P),2);J.__click=[_e,E],g(P);var G=o(P,2);G.__click=[be,l,H,v];var he=o(G,2);{var oe=h=>{var m=Ie(),f=o(u(m),14);C(f,17,()=>l,M,(A,c,w)=>{var q=ze(),X=ne(q);X.textContent=w;var T=o(X,2),d=u(T);y(d),d.__change=v,g(T);var a=o(T,2),b=u(a);y(b),b.__change=v,g(a);var r=o(a,2),s=u(r);y(s),s.__change=v,g(r);var x=o(r,2),K=u(x);y(K),K.__change=v,g(x);var Q=o(x,2),U=u(Q);y(U),U.__change=v,g(Q);var ee=o(Q,2),W=u(ee);y(W),W.__change=v,g(ee),R(()=>ie(X,`color: ${n(c).color??""}`)),p(d,()=>n(c).cellSizeVariationInSegment,_=>n(c).cellSizeVariationInSegment=_),p(b,()=>n(c).nbCellsInSegment,_=>n(c).nbCellsInSegment=_),p(s,()=>n(c).cellSpacingVariationInSegment,_=>n(c).cellSpacingVariationInSegment=_),p(K,()=>n(c).nextSegmentBaseCellSize,_=>n(c).nextSegmentBaseCellSize=_),p(U,()=>n(c).branchesMaxAngle,_=>n(c).branchesMaxAngle=_),p(W,()=>n(c).nbBranches,_=>n(c).nbBranches=_),z(A,q)}),g(m),z(h,m)},ce=h=>{var m=Xe(),f=o(u(m),2);C(f,17,()=>l,M,(d,a,b)=>{var r=fe();r.textContent=b,R(()=>ie(r,`color: ${n(a).color??""}`)),z(d,r)});var A=o(f,4);C(A,17,()=>l,M,(d,a,b)=>{var r=Ce(),s=u(r);y(s),s.__change=v,g(r),p(s,()=>n(a).cellSizeVariationInSegment,x=>n(a).cellSizeVariationInSegment=x),z(d,r)});var c=o(A,4);C(c,17,()=>l,M,(d,a,b)=>{var r=Me(),s=u(r);y(s),s.__change=v,g(r),p(s,()=>n(a).nbCellsInSegment,x=>n(a).nbCellsInSegment=x),z(d,r)});var w=o(c,4);C(w,17,()=>l,M,(d,a,b)=>{var r=Be(),s=u(r);y(s),s.__change=v,g(r),p(s,()=>n(a).cellSpacingVariationInSegment,x=>n(a).cellSpacingVariationInSegment=x),z(d,r)});var q=o(w,4);C(q,17,()=>l,M,(d,a,b)=>{var r=Ve(),s=u(r);y(s),s.__change=v,g(r),p(s,()=>n(a).nextSegmentBaseCellSize,x=>n(a).nextSegmentBaseCellSize=x),z(d,r)});var X=o(q,4);C(X,17,()=>l,M,(d,a,b)=>{var r=Ae(),s=u(r);y(s),s.__change=v,g(r),p(s,()=>n(a).branchesMaxAngle,x=>n(a).branchesMaxAngle=x),z(d,r)});var T=o(X,4);C(T,17,()=>l,M,(d,a,b)=>{var r=we(),s=u(r);y(s),s.__change=v,g(r),p(s,()=>n(a).nbBranches,x=>n(a).nbBranches=x),z(d,r)}),g(m),z(h,m)};Se(he,h=>{n(E)?h(oe):h(ce,!1)})}R(()=>xe(D,`Nb segments: ${n(V)??""}`)),z(S,$),ge()}ve(["click","change"]);export{je as component};
