import"../chunks/NZTpNUN0.js";import{z as Y,A as x,B as Z,s as y,g as e,p,f as I,v as n,G as i,a as c,E as ee,aA as de,F as m,x as B,c as me,a_ as ue}from"../chunks/Br9SMxIB.js";import{d as te,s as J}from"../chunks/BBzb7ThI.js";import{a as fe}from"../chunks/WbxJrN1C.js";import{i as N}from"../chunks/CvXxFVm9.js";import{s as re,a as oe}from"../chunks/Bpxd_8Tl.js";import{m as pe}from"../chunks/B81YP0Pw.js";import{g as ge,u as se,U as _e}from"../chunks/CrkKZsz5.js";import{M as ie}from"../chunks/BhRFzXHd.js";import{M as be}from"../chunks/DKmGubEx.js";import{P as z}from"../chunks/CpX8xF_L.js";import{r as he,A as ye}from"../chunks/DBA9JrQY.js";import{s as ke}from"../chunks/BgJCQexd.js";import{e as K,i as Q}from"../chunks/D1-nhZYT.js";import{r as W,s as $}from"../chunks/DWdbj9D8.js";import{b as X,d as xe}from"../chunks/C6S4cPPP.js";import{r as we}from"../chunks/4XIfIEs8.js";import{t as ne}from"../chunks/D-rGHmBV.js";import{b as Se}from"../chunks/BXX3-uSK.js";import{M as Te}from"../chunks/CjZqUvd1.js";import"../chunks/BUWzxVIb.js";import{p as Ue}from"../chunks/DC3Hgdmt.js";const Le=!1,gt=Object.freeze(Object.defineProperty({__proto__:null,ssr:Le},Symbol.toStringTag,{value:"Module"})),ae=()=>he({path:"/reactor/getEntriesForPublic"}),Me=async u=>{const o=z+"/reactor/addEntry",_=await ge();typeof _=="string"&&await ke.post(o).auth(_,{type:"bearer"}).field("name",u.name).field("commaSeparatedTags",u.commaSeparatedTags).attach("file",u.file)};var Ae=p('<span class="tag svelte-noox7t"> </span>'),Ce=(u,o,_)=>o(e(_)),Ee=p('<video class="medium-margin svelte-noox7t" style="max-width: 100%" controls></video>',2),Pe=p('<img class="medium-margin svelte-noox7t"/>'),Re=p('<div><div><b> </b></div> <div class="svelte-noox7t"></div> <div><button class="full-width svelte-noox7t"><i class="fas fa-copy"></i> Copy link</button></div></div> <div><a rel="noopener noreferrer" target="blank"><!></a></div>',1),Fe=(u,o)=>de(o),Be=p('<button class="full-width medium-margin svelte-noox7t">More...</button>'),Ne=p('<input class="full-width medium-margin svelte-noox7t" type="text" placeholder="Search by tags or name"/> <div class="container svelte-noox7t"></div> <!>',1);function Oe(u,o){Y(o,!0);const _=10;let L=x(1),A=x(Z([])),v=x("");const w=(a,t)=>{if(!t.length||a.name.toLowerCase().includes(t.toLowerCase()))return!0;for(const d of a.tags)if(d.toLowerCase().includes(t.toLowerCase()))return!0;return!1},S=a=>{navigator.clipboard.writeText(z+a.uri),ne.push('<i class="fas fa-check"></i> Link copied to clipboard',{duration:1e3,theme:{"--toastBarHeight":0}})},T=a=>a.s3PresignedUrl.includes(".mp4");we(()=>{y(A,o.reactions.filter(a=>w(a,e(v))).sort((a,t)=>t.creationDateUnix-a.creationDateUnix).slice(0,e(v).length?void 0:e(L)*_),!0)});var b=Ne(),h=I(b);W(h);var M=n(h,2);K(M,21,()=>e(A),Q,(a,t)=>{var l=Re(),d=I(l),g=m(d),j=m(g),D=m(j,!0);i(j),i(g);var E=n(g,2);K(E,21,()=>e(t).tags,Q,(k,r)=>{var f=Ae(),H=m(f,!0);i(f),B(()=>J(H,e(r))),c(k,f)}),i(E);var P=n(E,2),O=m(P);O.__click=[Ce,S,t],i(P),i(d);var R=n(d,2),U=m(R),G=m(U);{var V=k=>{var r=Ee();B(()=>$(r,"src",z+e(t).uri)),c(k,r)},q=k=>{var r=Pe();B(()=>{$(r,"src",z+e(t).uri),$(r,"alt",e(t).name)}),c(k,r)};N(G,k=>{T(e(t))?k(V):k(q,!1)})}i(U),i(R),B(()=>{J(D,e(t).name),$(U,"href",z+e(t).uri),$(U,"download",e(t).name)}),c(a,l)}),i(M);var C=n(M,2);{var s=a=>{var t=Be();t.__click=[Fe,L],c(a,t)};N(C,a=>{e(v).length===0&&e(L)*_<o.reactions.length&&a(s)})}X(h,()=>e(v),a=>y(v,a)),c(u,b),ee()}te(["click"]);var $e=(u,o)=>{e(o)!==void 0&&(e(o).value="")},ze=p('<button class="form-action svelte-1kgynly"><!></button>'),Ie=p('<span class="form-action svelte-1kgynly">Login to upload an entry</span>'),je=p('<div role="dialog" class="modal svelte-1kgynly"><div class="contents svelte-1kgynly"><h4 class="title-bar svelte-1kgynly">Add a new file <button>Close</button></h4> <!> <form class="form-content svelte-1kgynly"><label for="name">Name</label> <input type="text"/> <label for="content">Tags</label> <input type="textarea"/> <label for="file">File</label> <span><input class="file-input svelte-1kgynly" type="file"/> <button aria-label="delete file"><i class="fas fa-times-circle"></i></button></span> <br/> <!></form></div></div>');function De(u,o){Y(o,!0);const _=()=>oe(se,"$user",L),[L,A]=re();let v=x(Z([])),w=x(""),S=x(""),T=x(void 0),b=x(void 0),h=x(!1);const M=async()=>{y(v,[],!0),e(w)?.length||e(v).push({level:"error",header:"name must be defined"});let t;if(e(b)&&e(b).length&&(t=e(b)[0]),t||e(v).push({level:"error",header:"a file must be uploaded"}),!(e(v).length||!t))try{y(h,!0),await Me({name:e(w),commaSeparatedTags:e(S),file:t}),y(h,!1),o.onUpload(),o.close()}catch(l){y(h,!1);let d=l.message;l instanceof ye&&l.code===401?d="Invalid logged in user":l instanceof _e&&(d="User is logged out");const g=`<strong>Entry not created</strong><br/> ${d}`;ne.push(g,{theme:{"--toastBarBackground":"#FF0000"}})}};var C=me(),s=I(C);{var a=t=>{var l=je(),d=m(l),g=m(d),j=n(m(g));j.__click=function(...r){o.close?.apply(this,r)},i(g);var D=n(g,2);K(D,17,()=>e(v),Q,(r,f)=>{ie(r,{get item(){return e(f)}})});var E=n(D,2),P=n(m(E),2);W(P);var O=n(P,4);W(O);var R=n(O,4),U=m(R);Se(U,r=>y(T,r),()=>e(T));var G=n(U,2);G.__click=[$e,T],i(R);var V=n(R,4);{var q=r=>{var f=ze();f.__click=M;var H=m(f);{var le=F=>{Te(F,{size:.5,unit:"em",durationSeconds:.5})},ce=F=>{var ve=ue("Submit");c(F,ve)};N(H,F=>{e(h)?F(le):F(ce,!1)})}i(f),B(()=>f.disabled=e(h)),c(r,f)},k=r=>{var f=Ie();c(r,f)};N(V,r=>{_()?r(q):r(k,!1)})}i(E),i(d),i(l),X(P,()=>e(w),r=>y(w,r)),X(O,()=>e(S),r=>y(S,r)),xe(U,()=>e(b),r=>y(b,r)),c(t,l)};N(s,t=>{o.isOpen&&t(a)})}c(u,C),ee(),A()}te(["click"]);var Ge=(u,o)=>pe.open(De,{onUpload:o}),Ve=p("<button>Add an entry</button>"),qe=p("<p>Something went wrong</p> <p> </p>",1),He=p("<p>Loading data</p>"),Je=p("<!> <h2>Upload</h2> <!> <h2>Content</h2> <!>",1);function _t(u,o){Y(o,!0);const _=()=>oe(se,"$user",L),[L,A]=re();Ue.set("Reactor");let v=x(Z(ae()));const w=()=>y(v,ae(),!0);var S=Je(),T=I(S);be(T,{title:"Reactor",description:"My collection of memes"});var b=n(T,4);{var h=s=>{var a=Ve();a.__click=[Ge,w],c(s,a)},M=s=>{ie(s,{item:{level:"info",header:"Login to add an entry"}})};N(b,s=>{_()?s(h):s(M,!1)})}var C=n(b,4);fe(C,()=>e(v),s=>{var a=He();c(s,a)},(s,a)=>{Oe(s,{get reactions(){return e(a)}})},(s,a)=>{var t=qe(),l=n(I(t),2),d=m(l,!0);i(l),B(g=>J(d,g),[()=>JSON.stringify(e(a))]),c(s,t)}),c(u,S),ee(),A()}te(["click"]);export{_t as component,gt as universal};
