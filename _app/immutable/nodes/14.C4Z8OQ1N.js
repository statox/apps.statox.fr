import"../chunks/DsnmJJEf.js";import"../chunks/CbJJCuUa.js";import{p as S,h as u,C as L,b as $,s as r,e as v,g as e,a as x,d as C,i as s,r as g,f as J,t as K,b5 as T,j as V}from"../chunks/BI5tnybL.js";import{i as W}from"../chunks/BU96bRAZ.js";import{d as j}from"../chunks/BHBOcJDT.js";import{i as X}from"../chunks/BcTGm7Fo.js";import{e as Y,i as Z}from"../chunks/V4cWF7mx.js";import{r as N}from"../chunks/Db8wGxCz.js";import{b as I}from"../chunks/u1KJTtVJ.js";import{A as ee}from"../chunks/CuMzzfZD.js";import"../chunks/RZZgkjFT.js";import"../chunks/DKXeG7-1.js";import{U as te}from"../chunks/BWptIUEw.js";import{M as ae}from"../chunks/BwGSCHVW.js";import{M as re}from"../chunks/D4b6Boo_.js";import{M as oe}from"../chunks/CKwsCUeU.js";import{t as R}from"../chunks/DFOQ394W.js";import{a as ne,b as ie}from"../chunks/DLJbMfq2.js";import{g as H}from"../chunks/_6DNfr-g.js";import{I as se}from"../chunks/WypujlhA.js";import{o as le}from"../chunks/CW6Daupv.js";import{M as de}from"../chunks/joYRPwlW.js";import"../chunks/kGrLKQVa.js";import{p as me}from"../chunks/L3zL1n65.js";/* empty css                */var ue=$('<div class="input-container svelte-yzduke"><label for="name">Ingredient</label> <!> <label for="quantity">Quantity</label> <input type="number"/> <label for="quantity">Unit</label> <input type="text"/> <button><i class="fa fa-solid fa-plus"></i></button></div>');function ce(_,c){S(c,!0);let n=u(L([])),i=u(""),l=u(void 0),d=u(void 0);const b=()=>{e(i)&&c.onAdd({name:e(i),quantity:e(l),unit:e(d)})};le(async()=>{s(n,(await ne()).ingredients.sort((o,t)=>o<t?1:0).map(o=>o.name),!0)});var h=ue(),y=r(v(h),2);de(y,{get options(){return e(n)},get value(){return e(i)},set value(o){s(i,o,!0)}});var p=r(y,4);N(p);var f=r(p,4);N(f);var w=r(f,2);w.__click=b,g(h),I(p,()=>e(l),o=>s(l,o)),I(f,()=>e(d),o=>s(d,o)),x(_,h),C()}j(["click"]);var pe=$('<!> <div class="form-content svelte-1ycbaol"><label for="name">Name</label> <input type="text"/> <label for="ingredients">New ingredient</label> <div><!></div> <label for="ingredients">List of ingredients</label> <div><!></div> <label for="content">Instructions</label> <textarea rows="10" cols="50"></textarea></div> <button class="form-action svelte-1ycbaol"><!></button>',1),fe=$('<div class="contents svelte-1ycbaol"><span class="title-bar svelte-1ycbaol"><h2>Add a new recipe</h2> <button class="svelte-1ycbaol">Back to list</button></span> <!></div>');function ve(_,c){S(c,!0);let n=u(L([])),i=u(!1),l=u(""),d=u(""),b=L([]);const h=t=>{if(b.find(m=>m.name===t.name)){const m=t.name+" already added";R.push(m,{theme:{"--toastBarBackground":"#FF0000"}});return}b.push(t)},y=async()=>{if(s(n,[],!0),e(l)?.length||e(n).push({level:"error",header:"Name must be defined"}),e(d)?.length||e(n).push({level:"error",header:"Content must be defined"}),!e(n).length)try{s(i,!0),await ie({name:e(l),content:e(d),ingredients:b}),s(i,!1),c.onUpload()}catch(t){s(i,!1);let m=t.message;t instanceof ee&&t.code===401?m="Invalid logged in user":t instanceof te&&(m="User is logged out");const k=`<strong>Entry not created</strong><br/> ${m}`;R.push(k,{theme:{"--toastBarBackground":"#FF0000"}})}};var p=fe(),f=v(p),w=r(v(f),2);w.__click=()=>H("/cookbook"),g(f);var o=r(f,2);ae(o,{message:"Login to add an entry",requiredScope:"admin",children:(t,m)=>{var k=pe(),E=J(k);Y(E,17,()=>e(n),Z,(a,F)=>{re(a,{get item(){return e(F)}})});var A=r(E,2),U=r(v(A),2);N(U);var q=r(U,4),O=v(q);ce(O,{onAdd:h}),g(q);var B=r(q,4),P=v(B);se(P,{get ingredients(){return b},editable:!0}),g(B);var z=r(B,4);T(z),g(A);var M=r(A,2);M.__click=y;var Q=v(M);{var D=a=>{oe(a,{size:.5,unit:"em",durationSeconds:.5})},G=a=>{var F=V("Submit");x(a,F)};X(Q,a=>{e(i)?a(D):a(G,!1)})}g(M),K(()=>M.disabled=e(i)),I(U,()=>e(l),a=>s(l,a)),I(z,()=>e(d),a=>s(d,a)),x(t,k)},$$slots:{default:!0}}),g(p),x(_,p),C()}j(["click"]);function Oe(_,c){S(c,!1),me.set({name:"Cookbook",showAuthInHeader:!0});const n=()=>{H("/cookbook")};W(),ve(_,{onUpload:n}),C()}export{Oe as component};
