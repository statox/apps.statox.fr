import"../chunks/NZTpNUN0.js";import{a as ue}from"../chunks/CPGr-zPk.js";import{x as ge,y as H,z as ie,o as f,p as o,f as re,s as F,w as te,a as z,B as ve,g as n,C as g,E as v}from"../chunks/CF3vMb2z.js";import{d as xe,s as Se}from"../chunks/CK0MUMJY.js";import{i as me}from"../chunks/DhdTNEOV.js";import{e as M,i as B}from"../chunks/zmj_gju8.js";import{r as m,a as se}from"../chunks/Cjffvopl.js";import{b as p}from"../chunks/U96Opfl6.js";import{P as pe}from"../chunks/TU7-fKk4.js";class k extends Error{constructor(){super("Tried to divide by 0")}}class J{x=0;y=0;constructor(e=0,t=0){this.x=e,this.y=t}addX(e){return this.x+=e.x,this}addY(e){return this.y+=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addScalarX(e){return this.x+=e,this}addScalarY(e){return this.y+=e,this}subtractX(e){return this.x-=e.x,this}subtractY(e){return this.y-=e.y,this}subtract(e){return this.x-=e.x,this.y-=e.y,this}subtractScalar(e){return this.x-=e,this.y-=e,this}subtractScalarX(e){return this.x-=e,this}subtractScalarY(e){return this.y-=e,this}divideX(e){if(e.x===0)throw new k;return this.x/=e.x,this}divideY(e){if(e.y===0)throw new k;return this.y/=e.y,this}divide(e){if(e.x===0||e.y===0)throw new k;return this.x/=e.x,this.y/=e.y,this}divideScalar(e){if(e===0)throw new k;return this.x/=e,this.y/=e,this}divideScalarX(e){if(e===0)throw new k;return this.x/=e,this}divideScalarY(e){if(e===0)throw new k;return this.y/=e,this}multiplyX(e){return this.x*=e.x,this}multiplyY(e){return this.y*=e.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}multiplyScalarX(e){return this.x*=e,this}multiplyScalarY(e){return this.y*=e,this}invertX(){return this.x*=-1,this}invertY(){return this.y*=-1,this}invert(){return this.x*=-1,this.y*=-1,this}normalize(){const e=this.length();return this.divideScalar(e),this}norm=this.normalize;limit(e,t){return Math.abs(this.x)>e&&(this.x*=t),Math.abs(this.y)>e&&(this.y*=t),this}randomizeX(e,t){const r=Math.min(e.x,t.x),h=Math.max(e.x,t.x);return this.x=ae(r,h),this}randomizeY(e,t){const r=Math.min(e.y,t.y),h=Math.max(e.y,t.y);return this.y=ae(r,h),this}randomize(e,t){return this.randomizeX(e,t),this.randomizeY(e,t),this}randomizeAny(e,t){return Math.random()<.5?this.randomizeX(e,t):this.randomizeY(e,t),this}unfloat(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}toFixed(e=8){return this.x=Number(this.x.toFixed(e)),this.y=Number(this.y.toFixed(e)),this}mixX(e,t=.5){return this.x=(1-t)*this.x+t*e.x,this}mixY(e,t=.5){return this.y=(1-t)*this.y+t*e.y,this}mix(e,t=.5){return this.mixX(e,t),this.mixY(e,t),this}clone(){return new J(this.x,this.y)}copyX(e){return this.x=e.x,this}copyY(e){return this.y=e.y,this}copy(e){return this.x=e.x,this.y=e.y,this}zero(){return this.x=0,this.y=0,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}projectOnto(e){const t=(this.x*e.x+this.y*e.y)/(e.x*e.x+e.y*e.y);return this.x=t*e.x,this.y=t*e.y,this}horizontalAngle(){return Math.atan2(this.y,this.x)}horizontalAngleDeg(){return le(this.horizontalAngle())}verticalAngle(){return Math.atan2(this.x,this.y)}verticalAngleDeg(){return le(this.verticalAngle())}angle=this.horizontalAngle;direction=this.horizontalAngle;angleDeg=this.horizontalAngleDeg;rotate(e){const t=this.x*Math.cos(e)-this.y*Math.sin(e),r=this.x*Math.sin(e)+this.y*Math.cos(e);return this.x=t,this.y=r,this}rotateDeg(e){const t=oe(e);return this.rotate(t)}rotateTo(e){return this.rotate(e-this.horizontalAngle())}rotateToDeg(e){const t=oe(e);return this.rotateTo(t)}distanceX(e){return this.x-e.x}absDistanceX(e){return Math.abs(this.distanceX(e))}distanceY(e){return this.y-e.y}absDistanceY(e){return Math.abs(this.distanceY(e))}distance(e){return Math.sqrt(this.distanceSq(e))}distanceSq(e){const t=this.distanceX(e),r=this.distanceY(e);return t*t+r*r}length(){return Math.sqrt(this.lengthSq())}magnitude=this.length;lengthSq(){return this.x*this.x+this.y*this.y}isZero(){return this.x===0&&this.y===0}isEqualTo(e){return this.x===e.x&&this.y===e.y}toString(){return`x: ${this.x}, y: ${this.y}`}toArray(){return[this.x,this.y]}toObject(){return{x:this.x,y:this.y}}}const he=180/Math.PI;function ae(l,e){return Math.random()*(e-l)+l}function le(l){return l*he}function oe(l){return l/he}const ye=function(l,e,t,r,h){return(l-e)/(t-e)*(h-r)+r};function w(l,e){return Math.random()*(e-l)+l}const I=[[10,110,30,250],[255,0,0,220],[255,200,0,190],[0,255,0,160],[255,255,0,130],[0,200,255,100],[200,255,0,70],[255,0,200,40],[255,0,255,10]],_e=()=>{const l=[];l.push({cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:25,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:Math.floor(w(2,4)),color:I[0]});for(let e=0;e<w(5,8);e++)l.push({cellSizeVariationInSegment:w(.93,.99),cellSpacingVariationInSegment:w(.4,.6),nbCellsInSegment:Math.floor(w(2,6)),nextSegmentBaseCellSize:1,branchesMaxAngle:Math.floor(w(40,180)),nbBranches:Math.floor(w(2,4)),color:I[e+1]});return l[1].nbCellsInSegment=10,l},be=[{cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:25,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:I[0]},{cellSizeVariationInSegment:.985,cellSpacingVariationInSegment:.8,nbCellsInSegment:10,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[1]},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[2]},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:1,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[3]},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.5,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:120,nbBranches:2,color:I[4]},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.4,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[5]},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:9,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:I[6]},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.8,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[7]},{cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[8]}];class ze{genes;structure;constructor(){this.genes=be,this.structure=[]}grow(){this.structure=[];const e=[{cell:{position:new J,size:20,color:[200,200,200,200]},agent:{level:0,levelStep:0,direction:new J(0,20)}}];for(;e.length;){const{cell:t,agent:r}=e.shift();if(r.level===this.genes.length)continue;const{cellSpacingVariationInSegment:h,nbCellsInSegment:X,color:N,cellSizeVariationInSegment:V,nextSegmentBaseCellSize:x,branchesMaxAngle:j,nbBranches:P}=this.genes[r.level];if(r.levelStep>=X){const O=-j/2,K=j/2;for(let A=0;A<P;A++){const Q=ye(A,0,P-1,O,K),Z={position:t.position.clone(),size:t.size*x,color:[200,200,200,200]},U={level:r.level+1,levelStep:0,direction:r.direction.clone().rotateDeg(Q)};e.push({cell:Z,agent:U})}continue}const q={...t,position:t.position.clone().add(r.direction.clone().multiplyScalar(h)),size:t.size*V,color:N},T={level:r.level,levelStep:r.levelStep+1,direction:r.direction.clone()};e.push({cell:q,agent:T}),this.structure.push(q)}}}const Ie=(l,e,t)=>{F(e,_e(),!0),t()};var fe=(l,e)=>F(e,!n(e)),Ce=f('<div></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="1"/></div>',1),Me=f('<div class="genes-container svelte-1xx9u18"><div>Level</div> <div>cellSizeVariationInSegment</div> <div>nbCellsInSegment</div> <div>cellSpacingVariationInSegment</div> <div>nextSegmentBaseCellSize</div> <div>branchesMaxAngle</div> <div>nbBranches</div> <!></div>'),Be=f("<div></div>"),Ve=f('<div><input type="number" step="0.1"/></div>'),Ae=f('<div><input type="number" step="1"/></div>'),we=f('<div><input type="number" step="0.1"/></div>'),Xe=f('<div><input type="number" step="0.1"/></div>'),Ye=f('<div><input type="number" step="1"/></div>'),$e=f('<div><input type="number" step="1"/></div>'),De=f('<div class="genes-container-2 svelte-1xx9u18"><div>Level</div> <!> <div>cellSizeVariationInSegment</div> <!> <div>nbCellsInSegment</div> <!> <div>cellSpacingVariationInSegment</div> <!> <div>nextSegmentBaseCellSize</div> <!> <div>branchesMaxAngle</div> <!> <div>nbBranches</div> <!></div>'),ke=f("<h1>Here be flowers</h1> <!> <div><h2>Plant info</h2> <div> </div></div> <span><h2>Genes</h2> <button>Change view</button></span> <button>Randomize plant</button> <!>",1);function Ze(l,e){ge(e,!0);let t;const r=new ze;let h=H(ie([...r.genes]));r.grow();let X=H(ie(r.structure.length)),N=H(!0),V=H(0);const x=()=>{r.genes=n(h),r.grow(),F(X,r.structure.length,!0),F(V,0)},j=d=>{d.setup=()=>{t=d,d.createCanvas(1e3,1e3),d.noStroke()},d.draw=()=>{d.background(240,240,240);for(let y=0;y<n(V);y++){const C=r.structure[y],Y=C.position.x+d.width/2,c=d.height-C.position.y,$=C.size;d.fill(C.color),d.circle(Y,c,$)}n(V)<n(X)&&F(V,Math.min(n(V)+50,n(X)),!0)}};ue(()=>{console.clear(),t?.remove()});var P=ke(),q=o(re(P),2);pe(q,{sketch:j});var T=o(q,2),O=o(g(T),2),K=g(O);v(O),v(T);var A=o(T,2),Q=o(g(A),2);Q.__click=[fe,N],v(A);var Z=o(A,2);Z.__click=[Ie,h,x];var U=o(Z,2);{var ce=d=>{var y=Me(),C=o(g(y),14);M(C,17,()=>n(h),B,(Y,c,$)=>{var E=Ce(),D=re(E);D.textContent=$;var G=o(D,2),u=g(G);m(u),u.__change=x,v(G);var a=o(G,2),_=g(a);m(_),_.__change=x,v(a);var i=o(a,2),s=g(i);m(s),s.__change=x,v(i);var S=o(i,2),W=g(S);m(W),W.__change=x,v(S);var R=o(S,2),L=g(R);m(L),L.__change=x,v(R);var ne=o(R,2),ee=g(ne);m(ee),ee.__change=x,v(ne),te(()=>se(D,`color: ${n(c).color??""}`)),p(u,()=>n(c).cellSizeVariationInSegment,b=>n(c).cellSizeVariationInSegment=b),p(_,()=>n(c).nbCellsInSegment,b=>n(c).nbCellsInSegment=b),p(s,()=>n(c).cellSpacingVariationInSegment,b=>n(c).cellSpacingVariationInSegment=b),p(W,()=>n(c).nextSegmentBaseCellSize,b=>n(c).nextSegmentBaseCellSize=b),p(L,()=>n(c).branchesMaxAngle,b=>n(c).branchesMaxAngle=b),p(ee,()=>n(c).nbBranches,b=>n(c).nbBranches=b),z(Y,E)}),v(y),z(d,y)},de=d=>{var y=De(),C=o(g(y),2);M(C,17,()=>n(h),B,(u,a,_)=>{var i=Be();i.textContent=_,te(()=>se(i,`color: ${n(a).color??""}`)),z(u,i)});var Y=o(C,4);M(Y,17,()=>n(h),B,(u,a,_)=>{var i=Ve(),s=g(i);m(s),s.__change=x,v(i),p(s,()=>n(a).cellSizeVariationInSegment,S=>n(a).cellSizeVariationInSegment=S),z(u,i)});var c=o(Y,4);M(c,17,()=>n(h),B,(u,a,_)=>{var i=Ae(),s=g(i);m(s),s.__change=x,v(i),p(s,()=>n(a).nbCellsInSegment,S=>n(a).nbCellsInSegment=S),z(u,i)});var $=o(c,4);M($,17,()=>n(h),B,(u,a,_)=>{var i=we(),s=g(i);m(s),s.__change=x,v(i),p(s,()=>n(a).cellSpacingVariationInSegment,S=>n(a).cellSpacingVariationInSegment=S),z(u,i)});var E=o($,4);M(E,17,()=>n(h),B,(u,a,_)=>{var i=Xe(),s=g(i);m(s),s.__change=x,v(i),p(s,()=>n(a).nextSegmentBaseCellSize,S=>n(a).nextSegmentBaseCellSize=S),z(u,i)});var D=o(E,4);M(D,17,()=>n(h),B,(u,a,_)=>{var i=Ye(),s=g(i);m(s),s.__change=x,v(i),p(s,()=>n(a).branchesMaxAngle,S=>n(a).branchesMaxAngle=S),z(u,i)});var G=o(D,4);M(G,17,()=>n(h),B,(u,a,_)=>{var i=$e(),s=g(i);m(s),s.__change=x,v(i),p(s,()=>n(a).nbBranches,S=>n(a).nbBranches=S),z(u,i)}),v(y),z(d,y)};me(U,d=>{n(N)?d(ce):d(de,!1)})}te(()=>Se(K,`Nb segments: ${n(X)??""}`)),z(l,P),ve()}xe(["click","change"]);export{Ze as component};
