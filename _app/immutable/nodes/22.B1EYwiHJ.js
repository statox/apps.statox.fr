import"../chunks/NZTpNUN0.js";import{x as Y,y as w,z as Z,s as k,g as e,o as p,f as I,p as n,E as i,a as c,B as ee,aE as ve,C as d,w as B,c as de,aX as fe}from"../chunks/CwNiQ9pF.js";import{d as ae,s as J}from"../chunks/Bf1SZUcQ.js";import{a as ue}from"../chunks/C76KEr6c.js";import{i as N}from"../chunks/BsfdPjp3.js";import{s as re,a as oe}from"../chunks/r7WqoAZa.js";import{m as pe}from"../chunks/E2lFgB8B.js";import{g as _e,u as se,U as ge}from"../chunks/nzju5QSb.js";import{M as ie}from"../chunks/BC3l4Xx2.js";import{M as be}from"../chunks/RXD7QCaT.js";import{P as z}from"../chunks/CpX8xF_L.js";import{r as he,A as ke}from"../chunks/bjlkE-Mo.js";import{s as ye}from"../chunks/BgJCQexd.js";import{e as X,i as K}from"../chunks/BspCBHaR.js";import{r as Q,s as $}from"../chunks/DdYbzavU.js";import{b as W,c as we}from"../chunks/BGC9kyRR.js";import{r as xe}from"../chunks/DSlCupyo.js";import{t as ne}from"../chunks/DvNkpB9c.js";import{b as Se}from"../chunks/BJ-NhU9s.js";import{M as Te}from"../chunks/DKJFl_a9.js";import"../chunks/iCKjD8Bj.js";import{p as Ue}from"../chunks/CkYiTuF2.js";const Le=!1,_a=Object.freeze(Object.defineProperty({__proto__:null,ssr:Le},Symbol.toStringTag,{value:"Module"})),te=()=>he({path:"/reactor/getEntriesForPublic"}),Me=async f=>{const o=z+"/reactor/addEntry",g=await _e();typeof g=="string"&&await ye.post(o).auth(g,{type:"bearer"}).field("name",f.name).field("commaSeparatedTags",f.commaSeparatedTags).attach("file",f.file)};var Ce=p('<span class="tag svelte-16m67n3"> </span>'),Ee=(f,o,g)=>o(e(g)),Ae=p('<video class="medium-margin svelte-16m67n3" style="max-width: 100%" controls></video>',2),Pe=p('<img class="medium-margin svelte-16m67n3"/>'),Re=p('<div><div><b> </b></div> <div class="svelte-16m67n3"></div> <div><button class="full-width svelte-16m67n3"><i class="fas fa-copy"></i> Copy link</button></div></div> <div><a rel="noopener noreferrer" target="blank"><!></a></div>',1),Fe=(f,o)=>ve(o),Be=p('<button class="full-width medium-margin svelte-16m67n3">More...</button>'),Ne=p('<input class="full-width medium-margin svelte-16m67n3" type="text" placeholder="Search by tags or name"/> <div class="container svelte-16m67n3"></div> <!>',1);function Oe(f,o){Y(o,!0);const g=10;let L=w(1),C=w(Z([])),m=w("");const x=(t,a)=>{if(!a.length||t.name.toLowerCase().includes(a.toLowerCase()))return!0;for(const v of t.tags)if(v.toLowerCase().includes(a.toLowerCase()))return!0;return!1},S=t=>{navigator.clipboard.writeText(z+t.uri),ne.push('<i class="fas fa-check"></i> Link copied to clipboard',{duration:1e3,theme:{"--toastBarHeight":0}})},T=t=>t.s3PresignedUrl.includes(".mp4");xe(()=>{k(C,o.reactions.filter(t=>x(t,e(m))).sort((t,a)=>a.creationDateUnix-t.creationDateUnix).slice(0,e(m).length?void 0:e(L)*g),!0)});var b=Ne(),h=I(b);Q(h);var M=n(h,2);X(M,21,()=>e(C),K,(t,a)=>{var l=Re(),v=I(l),_=d(v),j=d(_),D=d(j,!0);i(j),i(_);var A=n(_,2);X(A,21,()=>e(a).tags,K,(y,r)=>{var u=Ce(),H=d(u,!0);i(u),B(()=>J(H,e(r))),c(y,u)}),i(A);var P=n(A,2),O=d(P);O.__click=[Ee,S,a],i(P),i(v);var R=n(v,2),U=d(R),V=d(U);{var q=y=>{var r=Ae();B(()=>$(r,"src",z+e(a).uri)),c(y,r)},G=y=>{var r=Pe();B(()=>{$(r,"src",z+e(a).uri),$(r,"alt",e(a).name)}),c(y,r)};N(V,y=>{T(e(a))?y(q):y(G,!1)})}i(U),i(R),B(()=>{J(D,e(a).name),$(U,"href",z+e(a).uri),$(U,"download",e(a).name)}),c(t,l)}),i(M);var E=n(M,2);{var s=t=>{var a=Be();a.__click=[Fe,L],c(t,a)};N(E,t=>{e(m).length===0&&e(L)*g<o.reactions.length&&t(s)})}W(h,()=>e(m),t=>k(m,t)),c(f,b),ee()}ae(["click"]);var $e=(f,o)=>{e(o)!==void 0&&(e(o).value="")},ze=p('<button class="form-action svelte-1f930i6"><!></button>'),Ie=p('<span class="form-action svelte-1f930i6">Login to upload an entry</span>'),je=p('<div role="dialog" class="modal svelte-1f930i6"><div class="contents svelte-1f930i6"><h4 class="title-bar svelte-1f930i6">Add a new file <button>Close</button></h4> <!> <form class="form-content svelte-1f930i6"><label for="name">Name</label> <input type="text"/> <label for="content">Tags</label> <input type="textarea"/> <label for="file">File</label> <span><input class="file-input svelte-1f930i6" type="file"/> <button aria-label="delete file"><i class="fas fa-times-circle"></i></button></span> <br/> <!></form></div></div>');function De(f,o){Y(o,!0);const[g,L]=re(),C=()=>oe(se,"$user",g);let m=w(Z([])),x=w(""),S=w(""),T=w(void 0),b=w(void 0),h=w(!1);const M=async()=>{k(m,[],!0),e(x)?.length||e(m).push({level:"error",header:"name must be defined"});let a;if(e(b)&&e(b).length&&(a=e(b)[0]),a||e(m).push({level:"error",header:"a file must be uploaded"}),!(e(m).length||!a))try{k(h,!0),await Me({name:e(x),commaSeparatedTags:e(S),file:a}),k(h,!1),o.onUpload(),o.close()}catch(l){k(h,!1);let v=l.message;l instanceof ke&&l.code===401?v="Invalid logged in user":l instanceof ge&&(v="User is logged out");const _=`<strong>Entry not created</strong><br/> ${v}`;ne.push(_,{theme:{"--toastBarBackground":"#FF0000"}})}};var E=de(),s=I(E);{var t=a=>{var l=je(),v=d(l),_=d(v),j=n(d(_));j.__click=function(...r){o.close?.apply(this,r)},i(_);var D=n(_,2);X(D,17,()=>e(m),K,(r,u)=>{ie(r,{get item(){return e(u)}})});var A=n(D,2),P=n(d(A),2);Q(P);var O=n(P,4);Q(O);var R=n(O,4),U=d(R);Se(U,r=>k(T,r),()=>e(T));var V=n(U,2);V.__click=[$e,T],i(R);var q=n(R,4);{var G=r=>{var u=ze();u.__click=M;var H=d(u);{var le=F=>{Te(F,{size:.5,unit:"em",durationSeconds:.5})},ce=F=>{var me=fe("Submit");c(F,me)};N(H,F=>{e(h)?F(le):F(ce,!1)})}i(u),B(()=>u.disabled=e(h)),c(r,u)},y=r=>{var u=Ie();c(r,u)};N(q,r=>{C()?r(G):r(y,!1)})}i(A),i(v),i(l),W(P,()=>e(x),r=>k(x,r)),W(O,()=>e(S),r=>k(S,r)),we(U,()=>e(b),r=>k(b,r)),c(a,l)};N(s,a=>{o.isOpen&&a(t)})}c(f,E),ee(),L()}ae(["click"]);var Ve=(f,o)=>pe.open(De,{onUpload:o}),qe=p("<button>Add an entry</button>"),Ge=p("<p>Something went wrong</p> <p> </p>",1),He=p("<p>Loading data</p>"),Je=p("<!> <h2>Upload</h2> <!> <h2>Content</h2> <!>",1);function ga(f,o){Y(o,!0);const[g,L]=re(),C=()=>oe(se,"$user",g);Ue.set("Reactor");let m=w(Z(te()));const x=()=>k(m,te(),!0);var S=Je(),T=I(S);be(T,{title:"Reactor",description:"My collection of memes"});var b=n(T,4);{var h=s=>{var t=qe();t.__click=[Ve,x],c(s,t)},M=s=>{ie(s,{item:{level:"info",header:"Login to add an entry"}})};N(b,s=>{C()?s(h):s(M,!1)})}var E=n(b,4);ue(E,()=>e(m),s=>{var t=He();c(s,t)},(s,t)=>{Oe(s,{get reactions(){return e(t)}})},(s,t)=>{var a=Ge(),l=n(I(a),2),v=d(l,!0);i(l),B(_=>J(v,_),[()=>JSON.stringify(e(t))]),c(s,a)}),c(f,S),ee(),L()}ae(["click"]);export{ga as component,_a as universal};
