import"../chunks/NZTpNUN0.js";import{a as St}from"../chunks/DkK0P85K.js";import{x as _t,y as K,z as vt,o as f,f as ut,s as Z,p as l,v as Q,a as b,B as yt,g as e,C as h,E as d}from"../chunks/DyWD_MJs.js";import{d as bt,s as ft}from"../chunks/BavMw1sQ.js";import{i as zt}from"../chunks/Do44c4MR.js";import{e as F,i as w}from"../chunks/j2-s9Gm3.js";import{r as m,a as ht}from"../chunks/BPTubluR.js";import{b as x}from"../chunks/Dr6R6WDT.js";import{P as Ft}from"../chunks/3yfWr4Ty.js";class P extends Error{constructor(){super("Tried to divide by 0")}}class U{x=0;y=0;constructor(t=0,n=0){this.x=t,this.y=n}addX(t){return this.x+=t.x,this}addY(t){return this.y+=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addScalarX(t){return this.x+=t,this}addScalarY(t){return this.y+=t,this}subtractX(t){return this.x-=t.x,this}subtractY(t){return this.y-=t.y,this}subtract(t){return this.x-=t.x,this.y-=t.y,this}subtractScalar(t){return this.x-=t,this.y-=t,this}subtractScalarX(t){return this.x-=t,this}subtractScalarY(t){return this.y-=t,this}divideX(t){if(t.x===0)throw new P;return this.x/=t.x,this}divideY(t){if(t.y===0)throw new P;return this.y/=t.y,this}divide(t){if(t.x===0||t.y===0)throw new P;return this.x/=t.x,this.y/=t.y,this}divideScalar(t){if(t===0)throw new P;return this.x/=t,this.y/=t,this}divideScalarX(t){if(t===0)throw new P;return this.x/=t,this}divideScalarY(t){if(t===0)throw new P;return this.y/=t,this}multiplyX(t){return this.x*=t.x,this}multiplyY(t){return this.y*=t.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}multiplyScalarX(t){return this.x*=t,this}multiplyScalarY(t){return this.y*=t,this}invertX(){return this.x*=-1,this}invertY(){return this.y*=-1,this}invert(){return this.x*=-1,this.y*=-1,this}normalize(){const t=this.length();return this.divideScalar(t),this}norm=this.normalize;limit(t,n){return Math.abs(this.x)>t&&(this.x*=n),Math.abs(this.y)>t&&(this.y*=n),this}randomizeX(t,n){const s=Math.min(t.x,n.x),u=Math.max(t.x,n.x);return this.x=gt(s,u),this}randomizeY(t,n){const s=Math.min(t.y,n.y),u=Math.max(t.y,n.y);return this.y=gt(s,u),this}randomize(t,n){return this.randomizeX(t,n),this.randomizeY(t,n),this}randomizeAny(t,n){return Math.random()<.5?this.randomizeX(t,n):this.randomizeY(t,n),this}unfloat(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}toFixed(t=8){return this.x=Number(this.x.toFixed(t)),this.y=Number(this.y.toFixed(t)),this}mixX(t,n=.5){return this.x=(1-n)*this.x+n*t.x,this}mixY(t,n=.5){return this.y=(1-n)*this.y+n*t.y,this}mix(t,n=.5){return this.mixX(t,n),this.mixY(t,n),this}clone(){return new U(this.x,this.y)}copyX(t){return this.x=t.x,this}copyY(t){return this.y=t.y,this}copy(t){return this.x=t.x,this.y=t.y,this}zero(){return this.x=0,this.y=0,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}projectOnto(t){const n=(this.x*t.x+this.y*t.y)/(t.x*t.x+t.y*t.y);return this.x=n*t.x,this.y=n*t.y,this}horizontalAngle(){return Math.atan2(this.y,this.x)}horizontalAngleDeg(){return pt(this.horizontalAngle())}verticalAngle(){return Math.atan2(this.x,this.y)}verticalAngleDeg(){return pt(this.verticalAngle())}angle=this.horizontalAngle;direction=this.horizontalAngle;angleDeg=this.horizontalAngleDeg;rotate(t){const n=this.x*Math.cos(t)-this.y*Math.sin(t),s=this.x*Math.sin(t)+this.y*Math.cos(t);return this.x=n,this.y=s,this}rotateDeg(t){const n=mt(t);return this.rotate(n)}rotateTo(t){return this.rotate(t-this.horizontalAngle())}rotateToDeg(t){const n=mt(t);return this.rotateTo(n)}distanceX(t){return this.x-t.x}absDistanceX(t){return Math.abs(this.distanceX(t))}distanceY(t){return this.y-t.y}absDistanceY(t){return Math.abs(this.distanceY(t))}distance(t){return Math.sqrt(this.distanceSq(t))}distanceSq(t){const n=this.distanceX(t),s=this.distanceY(t);return n*n+s*s}length(){return Math.sqrt(this.lengthSq())}magnitude=this.length;lengthSq(){return this.x*this.x+this.y*this.y}isZero(){return this.x===0&&this.y===0}isEqualTo(t){return this.x===t.x&&this.y===t.y}toString(){return`x: ${this.x}, y: ${this.y}`}toArray(){return[this.x,this.y]}toObject(){return{x:this.x,y:this.y}}}const xt=180/Math.PI;function gt(v,t){return Math.random()*(t-v)+v}function pt(v){return v*xt}function mt(v){return v/xt}const wt=function(v,t,n,s,u){return(v-t)/(n-t)*(u-s)+s},B=(v,t)=>Math.random()*(t-v)+v,I=[[119,114,37,250],[84,119,37,220],[112,181,21,190],[120,211,2,160],[173,211,2,130],[98,54,130,100],[153,83,198,70],[148,39,226,40],[226,39,113,10]],It=()=>{const v=[];v.push({upwardForce:0,allowOffspringBirthFactor:1,cellDeviationFactor:Number(B(.2,1).toFixed(4)),cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:15,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:Math.floor(B(2,4)),color:I[0]});for(let t=0;t<B(5,8);t++)v.push({upwardForce:0,allowOffspringBirthFactor:Number((1-t*.1).toFixed(4)),cellDeviationFactor:Number(B(.2,1).toFixed(4)),cellSizeVariationInSegment:Number(B(.93,.99).toFixed(4)),cellSpacingVariationInSegment:Number(B(.4,.6).toFixed(4)),nbCellsInSegment:Math.floor(B(2,6)),nextSegmentBaseCellSize:1,branchesMaxAngle:Math.floor(B(40,180)),nbBranches:Math.floor(B(2,4)),color:I[t+1]});return v[1].nbCellsInSegment=10,v},Bt=[{upwardForce:0,allowOffspringBirthFactor:1,cellDeviationFactor:.9,cellSizeVariationInSegment:.997,cellSpacingVariationInSegment:.6,nbCellsInSegment:25,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:I[0]},{upwardForce:0,allowOffspringBirthFactor:1,cellDeviationFactor:.9,cellSizeVariationInSegment:.985,cellSpacingVariationInSegment:.8,nbCellsInSegment:10,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[1]},{upwardForce:0,allowOffspringBirthFactor:1,cellDeviationFactor:.8,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[2]},{upwardForce:0,allowOffspringBirthFactor:.9,cellDeviationFactor:.8,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:1,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[3]},{upwardForce:0,allowOffspringBirthFactor:.8,cellDeviationFactor:.8,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.5,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:120,nbBranches:2,color:I[4]},{upwardForce:0,allowOffspringBirthFactor:.8,cellDeviationFactor:.7,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.4,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[5]},{upwardForce:0,allowOffspringBirthFactor:.7,cellDeviationFactor:.7,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.6,nbCellsInSegment:9,nextSegmentBaseCellSize:1,branchesMaxAngle:110,nbBranches:2,color:I[6]},{upwardForce:0,allowOffspringBirthFactor:.7,cellDeviationFactor:.7,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.8,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[7]},{upwardForce:0,allowOffspringBirthFactor:.7,cellDeviationFactor:.6,cellSizeVariationInSegment:.95,cellSpacingVariationInSegment:.7,nbCellsInSegment:4,nextSegmentBaseCellSize:1,branchesMaxAngle:45,nbBranches:2,color:I[8]}];class Ct{genes;structure;constructor(){this.genes=Bt,this.structure=[]}grow(){this.structure=[];const t=[{cell:{position:new U,size:20,color:[200,200,200,200]},agent:{level:0,levelStep:0,direction:new U(0,20)}}];for(;t.length;){const{cell:n,agent:s}=t.shift();if(s.level===this.genes.length)continue;const{allowOffspringBirthFactor:u,cellDeviationFactor:V,cellSpacingVariationInSegment:H,nbCellsInSegment:M,color:g,cellSizeVariationInSegment:W,nextSegmentBaseCellSize:J,branchesMaxAngle:q,nbBranches:A}=this.genes[s.level];if(s.levelStep>=M){const E=-q/2,L=q/2;for(let D=0;D<A;D++){const tt=wt(D,0,A-1,E,L),et={position:n.position.clone(),size:n.size*J,color:[200,200,200,200]},nt={level:s.level+1,levelStep:0,direction:s.direction.clone().rotateDeg(tt)};Math.random()<u&&t.push({cell:et,agent:nt})}continue}const T={...n,position:n.position.clone().add(s.direction.clone().rotateDeg(B(-45,45)*V).multiplyScalar(H)),size:n.size*W,color:g},R={level:s.level,levelStep:s.levelStep+1,direction:s.direction.clone()};t.push({cell:T,agent:R}),this.structure.push(T)}}}const Mt=(v,t,n)=>{Z(t,It(),!0),n()};var Vt=(v,t)=>Z(t,!e(t)),At=f('<div></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="0.1"/></div> <div><input type="number" step="1"/></div> <div><input type="number" step="1"/></div>',1),Dt=f('<div class="genes-container svelte-yvhszb"><div>Level</div> <div>upwardForce</div> <div>allowOffspringBirthFactor</div> <div>cellDeviationFactor</div> <div>cellSizeVariationInSegment</div> <div>nbCellsInSegment</div> <div>cellSpacingVariationInSegment</div> <div>nextSegmentBaseCellSize</div> <div>branchesMaxAngle</div> <div>nbBranches</div> <!></div>'),$t=f("<div></div>"),Ot=f('<div><input type="number" step="0.1"/></div>'),Xt=f('<div><input type="number" step="0.1"/></div>'),Yt=f('<div><input type="number" step="0.1"/></div>'),kt=f('<div><input type="number" step="0.1"/></div>'),Nt=f('<div><input type="number" step="1"/></div>'),Pt=f('<div><input type="number" step="0.1"/></div>'),qt=f('<div><input type="number" step="0.1"/></div>'),Tt=f('<div><input type="number" step="1"/></div>'),Et=f('<div><input type="number" step="1"/></div>'),Gt=f('<div class="genes-container-2 svelte-yvhszb"><div>Level</div> <!> <div>upwardForce</div> <!> <div>allowOffspringBirthFactor</div> <!> <div>cellDeviationFactor</div> <!> <div>cellSizeVariationInSegment</div> <!> <div>nbCellsInSegment</div> <!> <div>cellSpacingVariationInSegment</div> <!> <div>nextSegmentBaseCellSize</div> <!> <div>branchesMaxAngle</div> <!> <div>nbBranches</div> <!></div>'),jt=f("<!> <div><h2>Plant info</h2> <div> </div></div> <span><h2>Genes</h2> <button>Change view</button></span> <button>Randomize plant</button> <!>",1);function te(v,t){_t(t,!0);let n;const s=new Ct;let u=K(vt([...s.genes]));s.grow();let V=K(vt(s.structure.length)),H=K(!0),M=K(0);const g=()=>{s.genes=e(u),s.grow(),Z(V,s.structure.length,!0),Z(M,0)},W=S=>{S.setup=()=>{n=S,S.createCanvas(1e3,600),S.noStroke()},S.draw=()=>{S.background(240,240,240);for(let z=0;z<e(M);z++){const C=s.structure[z],$=C.position.x+S.width/2,o=S.height-C.position.y,O=C.size;S.fill(C.color),S.circle($,o,O)}e(M)<e(V)&&Z(M,Math.min(e(M)+50,e(V)),!0)}};St(()=>{console.clear(),n?.remove()});var J=jt(),q=ut(J);Ft(q,{sketch:W});var A=l(q,2),T=l(h(A),2),R=h(T);d(T),d(A);var E=l(A,2),L=l(h(E),2);L.__click=[Vt,H],d(E);var D=l(E,2);D.__click=[Mt,u,g];var tt=l(D,2);{var et=S=>{var z=Dt(),C=l(h(z),20);F(C,17,()=>e(u),w,($,o,O)=>{var G=At(),X=ut(G);X.textContent=O;var Y=l(X,2),k=h(Y);m(k),k.__change=g,d(Y);var N=l(Y,2),j=h(N);m(j),j.__change=g,d(N);var c=l(N,2),a=h(c);m(a),a.__change=g,d(c);var y=l(c,2),i=h(y);m(i),i.__change=g,d(y);var r=l(y,2),p=h(r);m(p),p.__change=g,d(r);var it=l(r,2),rt=h(it);m(rt),rt.__change=g,d(it);var at=l(it,2),st=h(at);m(st),st.__change=g,d(at);var lt=l(at,2),ot=h(lt);m(ot),ot.__change=g,d(lt);var dt=l(lt,2),ct=h(dt);m(ct),ct.__change=g,d(dt),Q(()=>ht(X,`color: ${e(o).color??""}`)),x(k,()=>e(o).upwardForce,_=>e(o).upwardForce=_),x(j,()=>e(o).allowOffspringBirthFactor,_=>e(o).allowOffspringBirthFactor=_),x(a,()=>e(o).cellDeviationFactor,_=>e(o).cellDeviationFactor=_),x(i,()=>e(o).cellSizeVariationInSegment,_=>e(o).cellSizeVariationInSegment=_),x(p,()=>e(o).nbCellsInSegment,_=>e(o).nbCellsInSegment=_),x(rt,()=>e(o).cellSpacingVariationInSegment,_=>e(o).cellSpacingVariationInSegment=_),x(st,()=>e(o).nextSegmentBaseCellSize,_=>e(o).nextSegmentBaseCellSize=_),x(ot,()=>e(o).branchesMaxAngle,_=>e(o).branchesMaxAngle=_),x(ct,()=>e(o).nbBranches,_=>e(o).nbBranches=_),b($,G)}),d(z),b(S,z)},nt=S=>{var z=Gt(),C=l(h(z),2);F(C,17,()=>e(u),w,(c,a,y)=>{var i=$t();i.textContent=y,Q(()=>ht(i,`color: ${e(a).color??""}`)),b(c,i)});var $=l(C,4);F($,17,()=>e(u),w,(c,a,y)=>{var i=Ot(),r=h(i);m(r),r.__change=g,d(i),x(r,()=>e(a).upwardForce,p=>e(a).upwardForce=p),b(c,i)});var o=l($,4);F(o,17,()=>e(u),w,(c,a,y)=>{var i=Xt(),r=h(i);m(r),r.__change=g,d(i),x(r,()=>e(a).allowOffspringBirthFactor,p=>e(a).allowOffspringBirthFactor=p),b(c,i)});var O=l(o,4);F(O,17,()=>e(u),w,(c,a,y)=>{var i=Yt(),r=h(i);m(r),r.__change=g,d(i),x(r,()=>e(a).cellDeviationFactor,p=>e(a).cellDeviationFactor=p),b(c,i)});var G=l(O,4);F(G,17,()=>e(u),w,(c,a,y)=>{var i=kt(),r=h(i);m(r),r.__change=g,d(i),x(r,()=>e(a).cellSizeVariationInSegment,p=>e(a).cellSizeVariationInSegment=p),b(c,i)});var X=l(G,4);F(X,17,()=>e(u),w,(c,a,y)=>{var i=Nt(),r=h(i);m(r),r.__change=g,d(i),x(r,()=>e(a).nbCellsInSegment,p=>e(a).nbCellsInSegment=p),b(c,i)});var Y=l(X,4);F(Y,17,()=>e(u),w,(c,a,y)=>{var i=Pt(),r=h(i);m(r),r.__change=g,d(i),x(r,()=>e(a).cellSpacingVariationInSegment,p=>e(a).cellSpacingVariationInSegment=p),b(c,i)});var k=l(Y,4);F(k,17,()=>e(u),w,(c,a,y)=>{var i=qt(),r=h(i);m(r),r.__change=g,d(i),x(r,()=>e(a).nextSegmentBaseCellSize,p=>e(a).nextSegmentBaseCellSize=p),b(c,i)});var N=l(k,4);F(N,17,()=>e(u),w,(c,a,y)=>{var i=Tt(),r=h(i);m(r),r.__change=g,d(i),x(r,()=>e(a).branchesMaxAngle,p=>e(a).branchesMaxAngle=p),b(c,i)});var j=l(N,4);F(j,17,()=>e(u),w,(c,a,y)=>{var i=Et(),r=h(i);m(r),r.__change=g,d(i),x(r,()=>e(a).nbBranches,p=>e(a).nbBranches=p),b(c,i)}),d(z),Q(()=>ht(z,`--nb-columns: ${1+e(u).length}`)),b(S,z)};zt(tt,S=>{e(H)?S(et):S(nt,!1)})}Q(()=>ft(R,`Nb segments: ${e(V)??""}`)),b(v,J),yt()}bt(["click","change"]);export{te as component};
