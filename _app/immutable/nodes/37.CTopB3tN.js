import"../chunks/DsnmJJEf.js";import"../chunks/Bdxdj0h6.js";import{p as W,h as s,C as D,d as L,g as e,b as T,s as a,f as A,i as r,e as E,r as G,a as F}from"../chunks/C1Jxye1l.js";import{i as j}from"../chunks/BAFXAy0q.js";import{g as q}from"../chunks/ydLoT6Dn.js";import"../chunks/DJ90tpFZ.js";import{p as z}from"../chunks/rc8jUsVI.js";/* empty css                */import"../chunks/CYl4EDKT.js";import{i as J}from"../chunks/BAKOb8xY.js";import{r as f,c as K}from"../chunks/Z-lh6Sw0.js";import{b as v}from"../chunks/DeqYhWtL.js";import{F as O,a as Q,c as V,h as X}from"../chunks/C_XgmlF_.js";import{M as Y}from"../chunks/E57deykY.js";import{c as I}from"../chunks/Cd670Sty.js";var Z=T('<label for="css-selector">CSS selector</label> <input type="textarea"/>',1),ee=T('<label for="name">Name</label> <input type="text"/> <label for="check-interval">Check interval</label> <!> <label for="notification-message">Notification message (the @mention is automatically added)</label> <input type="textarea"/> <label for="watch-type">Watcher type</label> <select id="watch-type"><option>CSS</option><option>HASH</option></select> <label for="content">URL</label> <input type="textarea"/> <!> <!>',1);function te(S,u){W(u,!0);let o=s(D([])),i=s(""),n=s(""),c=s(""),m=s(""),p=s(0),l=s("CSS"),b=s(!1);const $=async()=>{r(o,[],!0),e(i)?.length||e(o).push({level:"error",header:"name must be defined"}),e(n)||e(o).push({level:"error",header:"notification message must be defined"}),e(l)==="CSS"&&!e(m)&&e(o).push({level:"error",header:"A CSS watcher must have a css selector defined"}),e(p)<900&&e(o).push({level:"error",header:"Check interval too small. Must be >= 15mn"});try{new URL(e(c))}catch{e(o).push({level:"error",header:"The URL is invalid"})}if(!e(o).length)try{r(b,!0),e(l)==="CSS"?await I({name:e(i),notificationMessage:e(n),url:e(c),cssSelector:e(m),checkIntervalSeconds:e(p),watchType:e(l)}):e(l)==="HASH"&&await I({name:e(i),notificationMessage:e(n),url:e(c),checkIntervalSeconds:e(p),watchType:e(l)}),u.onUpload()}catch(h){X(h)}finally{r(b,!1)}};O(S,{title:"Add a new watcher",backUrl:"/webwatcher",get noticeMessages(){return e(o)},children:(h,ae)=>{Q(h,{children:(R,re)=>{var C=ee(),g=a(A(C),2);f(g);var k=a(g,4);Y(k,{allowedUnits:["minutes","hours","days"],defaultDuration:{value:1,unit:"hours"},get valueInSeconds(){return e(p)},set valueInSeconds(t){r(p,t,!0)}});var _=a(k,4);f(_);var d=a(_,4),y=E(d);y.value=y.__value="CSS";var M=a(y);M.value=M.__value="HASH",G(d);var w=a(d,4);f(w);var H=a(w,2);{var N=t=>{var U=Z(),x=a(A(U),2);f(x),v(x,()=>e(m),B=>r(m,B)),F(t,U)};J(H,t=>{e(l)==="CSS"&&t(N)})}var P=a(H,2);V(P,{onclick:$,get loading(){return e(b)}}),v(g,()=>e(i),t=>r(i,t)),v(_,()=>e(n),t=>r(n,t)),K(d,()=>e(l),t=>r(l,t)),v(w,()=>e(c),t=>r(c,t)),F(R,C)}})},$$slots:{default:!0}}),L()}function ge(S,u){W(u,!1),z.set({name:"Web Watchers",showAuthInHeader:!0}),j(),te(S,{onUpload:()=>q("/webwatcher")}),L()}export{ge as component};
