import{s as se,e as k,a as U,A as W,c as C,g as I,b as A,f as p,m as g,i as y,P as Q,E as z,n as D,B as be,t as ae,d as oe,z as S,h as P,j as ie,C as X,G as Ce,k as we,p as ye,K as Ee,y as $e}from"../chunks/scheduler.BljvbZn4.js";import{h as pe,u as Te}from"../chunks/await_block.p7-CHnkn.js";import{S as ce,i as ue,g as Pe,t as x,c as Le,a as J,b as Y,d as Z,m as ee,e as te}from"../chunks/index.BkauvWu_.js";import{a as F}from"../chunks/public.FeUBmDTS.js";import{r as Ue,A as Ie,M as Ne}from"../chunks/Main.Bawp38tx.js";import{g as Ae,t as ke,u as Be,U as Me}from"../chunks/SvelteToast.svelte_svelte_type_style_lang.Cb6bDeUm.js";import{s as Se}from"../chunks/client.CXFlBm-D.js";import{M as De}from"../chunks/Main.DZLQDgvb.js";import{e as le}from"../chunks/each.D3bwR6rE.js";const Oe=!1,ct=Object.freeze(Object.defineProperty({__proto__:null,ssr:Oe},Symbol.toStringTag,{value:"Module"})),me=()=>Ue({path:"/reactor/getEntriesForPublic"}),Ve=async n=>{const e=F+"/reactor/addEntry",l=await Ae();typeof l=="string"&&await Se.post(e).auth(l,{type:"bearer"}).field("name",n.name).field("commaSeparatedTags",n.commaSeparatedTags).attach("file",n.file)};function _e(n,e,l){const t=n.slice();return t[10]=e[l],t}function he(n,e,l){const t=n.slice();return t[13]=e[l],t}function de(n){let e,l=n[13]+"",t;return{c(){e=k("span"),t=ae(l),this.h()},l(r){e=C(r,"SPAN",{class:!0});var s=A(e);t=oe(s,l),s.forEach(p),this.h()},h(){g(e,"class","tag svelte-16m67n3")},m(r,s){y(r,e,s),P(e,t)},p(r,s){s&8&&l!==(l=r[13]+"")&&ie(t,l)},d(r){r&&p(e)}}}function He(n){let e,l,t;return{c(){e=k("img"),this.h()},l(r){e=C(r,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){g(e,"class","medium-margin svelte-16m67n3"),X(e.src,l=F+n[10].uri)||g(e,"src",l),g(e,"alt",t=n[10].name)},m(r,s){y(r,e,s)},p(r,s){s&8&&!X(e.src,l=F+r[10].uri)&&g(e,"src",l),s&8&&t!==(t=r[10].name)&&g(e,"alt",t)},d(r){r&&p(e)}}}function Re(n){let e,l;return{c(){e=k("video"),this.h()},l(t){e=C(t,"VIDEO",{class:!0,style:!0,src:!0}),A(e).forEach(p),this.h()},h(){g(e,"class","medium-margin svelte-16m67n3"),Ce(e,"max-width","100%"),e.controls=!0,X(e.src,l=F+n[10].uri)||g(e,"src",l)},m(t,r){y(t,e,r)},p(t,r){r&8&&!X(e.src,l=F+t[10].uri)&&g(e,"src",l)},d(t){t&&p(e)}}}function ve(n){let e,l,t,r=n[10].name+"",s,c,h,a,u,m,i=`<i class="fas fa-copy"></i>
                    Copy link`,v,o,_,w,N,E,f,$,M,H=le(n[10].tags),L=[];for(let T=0;T<H.length;T+=1)L[T]=de(he(n,H,T));function q(){return n[7](n[10])}function O(T,d){return d&8&&(w=null),w==null&&(w=!!T[5](T[10])),w?Re:He}let j=O(n,-1),B=j(n);return{c(){e=k("div"),l=k("div"),t=k("b"),s=ae(r),c=U(),h=k("div");for(let T=0;T<L.length;T+=1)L[T].c();a=U(),u=k("div"),m=k("button"),m.innerHTML=i,v=U(),o=k("div"),_=k("a"),B.c(),f=U(),this.h()},l(T){e=C(T,"DIV",{});var d=A(e);l=C(d,"DIV",{});var b=A(l);t=C(b,"B",{});var V=A(t);s=oe(V,r),V.forEach(p),b.forEach(p),c=I(d),h=C(d,"DIV",{class:!0});var G=A(h);for(let ne=0;ne<L.length;ne+=1)L[ne].l(G);G.forEach(p),a=I(d),u=C(d,"DIV",{});var R=A(u);m=C(R,"BUTTON",{class:!0,"data-svelte-h":!0}),S(m)!=="svelte-2xhnct"&&(m.innerHTML=i),R.forEach(p),d.forEach(p),v=I(T),o=C(T,"DIV",{});var K=A(o);_=C(K,"A",{href:!0,download:!0,rel:!0,target:!0});var fe=A(_);B.l(fe),fe.forEach(p),f=I(K),K.forEach(p),this.h()},h(){g(h,"class","svelte-16m67n3"),g(m,"class","full-width svelte-16m67n3"),g(_,"href",N=F+n[10].uri),g(_,"download",E=n[10].name),g(_,"rel","noopener noreferrer"),g(_,"target","blank")},m(T,d){y(T,e,d),P(e,l),P(l,t),P(t,s),P(e,c),P(e,h);for(let b=0;b<L.length;b+=1)L[b]&&L[b].m(h,null);P(e,a),P(e,u),P(u,m),y(T,v,d),y(T,o,d),P(o,_),B.m(_,null),P(o,f),$||(M=z(m,"click",q),$=!0)},p(T,d){if(n=T,d&8&&r!==(r=n[10].name+"")&&ie(s,r),d&8){H=le(n[10].tags);let b;for(b=0;b<H.length;b+=1){const V=he(n,H,b);L[b]?L[b].p(V,d):(L[b]=de(V),L[b].c(),L[b].m(h,null))}for(;b<L.length;b+=1)L[b].d(1);L.length=H.length}j===(j=O(n,d))&&B?B.p(n,d):(B.d(1),B=j(n),B&&(B.c(),B.m(_,null))),d&8&&N!==(N=F+n[10].uri)&&g(_,"href",N),d&8&&E!==(E=n[10].name)&&g(_,"download",E)},d(T){T&&(p(e),p(v),p(o)),be(L,T),B.d(),$=!1,M()}}}function ge(n){let e,l="More...",t,r;return{c(){e=k("button"),e.textContent=l,this.h()},l(s){e=C(s,"BUTTON",{class:!0,"data-svelte-h":!0}),S(e)!=="svelte-3fputj"&&(e.textContent=l),this.h()},h(){g(e,"class","full-width medium-margin svelte-16m67n3")},m(s,c){y(s,e,c),t||(r=z(e,"click",n[8]),t=!0)},p:D,d(s){s&&p(e),t=!1,r()}}}function qe(n){let e,l,t,r,s,c,h,a=le(n[3]),u=[];for(let i=0;i<a.length;i+=1)u[i]=ve(_e(n,a,i));let m=n[2].length===0&&n[1]*re<n[0].length&&ge(n);return{c(){e=k("input"),l=U(),t=k("div");for(let i=0;i<u.length;i+=1)u[i].c();r=U(),m&&m.c(),s=W(),this.h()},l(i){e=C(i,"INPUT",{class:!0,type:!0,placeholder:!0}),l=I(i),t=C(i,"DIV",{class:!0});var v=A(t);for(let o=0;o<u.length;o+=1)u[o].l(v);v.forEach(p),r=I(i),m&&m.l(i),s=W(),this.h()},h(){g(e,"class","full-width medium-margin svelte-16m67n3"),g(e,"type","text"),g(e,"placeholder","Search by tags or name"),g(t,"class","container svelte-16m67n3")},m(i,v){y(i,e,v),Q(e,n[2]),y(i,l,v),y(i,t,v);for(let o=0;o<u.length;o+=1)u[o]&&u[o].m(t,null);y(i,r,v),m&&m.m(i,v),y(i,s,v),c||(h=z(e,"input",n[6]),c=!0)},p(i,[v]){if(v&4&&e.value!==i[2]&&Q(e,i[2]),v&56){a=le(i[3]);let o;for(o=0;o<a.length;o+=1){const _=_e(i,a,o);u[o]?u[o].p(_,v):(u[o]=ve(_),u[o].c(),u[o].m(t,null))}for(;o<u.length;o+=1)u[o].d(1);u.length=a.length}i[2].length===0&&i[1]*re<i[0].length?m?m.p(i,v):(m=ge(i),m.c(),m.m(s.parentNode,s)):m&&(m.d(1),m=null)},i:D,o:D,d(i){i&&(p(e),p(l),p(t),p(r),p(s)),be(u,i),m&&m.d(i),c=!1,h()}}}const re=10;function ze(n,e,l){let{reactions:t}=e,r=1,s=[],c="";const h=(o,_)=>{if(!_.length||o.name.toLowerCase().includes(_.toLowerCase()))return!0;for(const N of o.tags)if(N.toLowerCase().includes(_.toLowerCase()))return!0;return!1},a=o=>{navigator.clipboard.writeText(F+o.uri),ke.push('<i class="fas fa-check"></i> Link copied to clipboard',{duration:1e3,theme:{"--toastBarHeight":0}})},u=o=>o.s3PresignedUrl.includes(".mp4");function m(){c=this.value,l(2,c)}const i=o=>a(o),v=()=>l(1,r++,r);return n.$$set=o=>{"reactions"in o&&l(0,t=o.reactions)},n.$$.update=()=>{n.$$.dirty&7&&l(3,s=t.filter(o=>h(o,c)).sort((o,_)=>_.creationDateUnix-o.creationDateUnix).slice(0,c.length?void 0:r*re))},[t,r,c,s,a,u,m,i,v]}class Fe extends ce{constructor(e){super(),ue(this,e,ze,qe,se,{reactions:0})}}function je(n){let e,l;return e=new Ne({props:{item:{level:"info",header:"Login to upload content"}}}),{c(){Y(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,r){ee(e,t,r),l=!0},p:D,i(t){l||(J(e.$$.fragment,t),l=!0)},o(t){x(e.$$.fragment,t),l=!1},d(t){te(e,t)}}}function Ge(n){let e,l,t,r="Name",s,c,h,a,u,m="Tags",i,v,o,_,w,N="File",E,f,$,M,H='<i class="fas fa-times-circle"></i>',L,q,O,j="Upload",B,T;return{c(){e=k("div"),l=k("p"),t=k("label"),t.textContent=r,s=U(),c=k("input"),h=U(),a=k("p"),u=k("label"),u.textContent=m,i=U(),v=k("input"),o=U(),_=k("p"),w=k("label"),w.textContent=N,E=U(),f=k("input"),$=U(),M=k("button"),M.innerHTML=H,L=U(),q=k("p"),O=k("button"),O.textContent=j,this.h()},l(d){e=C(d,"DIV",{class:!0});var b=A(e);l=C(b,"P",{class:!0});var V=A(l);t=C(V,"LABEL",{for:!0,"data-svelte-h":!0}),S(t)!=="svelte-bs9sy6"&&(t.textContent=r),s=I(V),c=C(V,"INPUT",{type:!0,class:!0}),V.forEach(p),h=I(b),a=C(b,"P",{class:!0});var G=A(a);u=C(G,"LABEL",{for:!0,"data-svelte-h":!0}),S(u)!=="svelte-1myp42m"&&(u.textContent=m),i=I(G),v=C(G,"INPUT",{type:!0,class:!0}),G.forEach(p),b.forEach(p),o=I(d),_=C(d,"P",{class:!0});var R=A(_);w=C(R,"LABEL",{for:!0,"data-svelte-h":!0}),S(w)!=="svelte-180hc3e"&&(w.textContent=N),E=I(R),f=C(R,"INPUT",{class:!0,type:!0}),$=I(R),M=C(R,"BUTTON",{"data-svelte-h":!0}),S(M)!=="svelte-1q80dng"&&(M.innerHTML=H),R.forEach(p),L=I(d),q=C(d,"P",{});var K=A(q);O=C(K,"BUTTON",{"data-svelte-h":!0}),S(O)!=="svelte-15774uw"&&(O.textContent=j),K.forEach(p),this.h()},h(){g(t,"for","name"),g(c,"type","text"),g(c,"class","svelte-248e0t"),g(l,"class","meta-section-item svelte-248e0t"),g(u,"for","content"),g(v,"type","textarea"),g(v,"class","svelte-248e0t"),g(a,"class","meta-section-item svelte-248e0t"),g(e,"class","meta-section svelte-248e0t"),g(w,"for","file"),g(f,"class","file-input svelte-248e0t"),g(f,"type","file"),g(_,"class","file-section svelte-248e0t")},m(d,b){y(d,e,b),P(e,l),P(l,t),P(l,s),P(l,c),Q(c,n[0]),P(e,h),P(e,a),P(a,u),P(a,i),P(a,v),Q(v,n[1]),y(d,o,b),y(d,_,b),P(_,w),P(_,E),P(_,f),n[9](f),P(_,$),P(_,M),y(d,L,b),y(d,q,b),P(q,O),B||(T=[z(c,"input",n[6]),z(v,"input",n[7]),z(f,"change",n[8]),z(M,"click",n[10]),z(O,"click",n[5])],B=!0)},p(d,b){b&1&&c.value!==d[0]&&Q(c,d[0]),b&2&&Q(v,d[1])},i:D,o:D,d(d){d&&(p(e),p(o),p(_),p(L),p(q)),n[9](null),B=!1,$e(T)}}}function xe(n){let e,l,t,r;const s=[Ge,je],c=[];function h(a,u){return a[4]?0:1}return e=h(n),l=c[e]=s[e](n),{c(){l.c(),t=W()},l(a){l.l(a),t=W()},m(a,u){c[e].m(a,u),y(a,t,u),r=!0},p(a,[u]){let m=e;e=h(a),e===m?c[e].p(a,u):(Pe(),x(c[m],1,1,()=>{c[m]=null}),Le(),l=c[e],l?l.p(a,u):(l=c[e]=s[e](a),l.c()),J(l,1),l.m(t.parentNode,t))},i(a){r||(J(l),r=!0)},o(a){x(l),r=!1},d(a){a&&p(t),c[e].d(a)}}}function Je(n,e,l){let t;we(n,Be,w=>l(4,t=w));const r=ye();let s,c="",h,a;const u=async()=>{try{if(!(s!=null&&s.length))throw new Error("A name is required for upload");let w;if(a&&a.length&&(w=a[0]),!w)throw new Error("A file is required for upload");await Ve({name:s,commaSeparatedTags:c,file:w}),r("upload")}catch(w){let N=w.message;w instanceof Ie&&w.code===401?N="Invalid logged in user":w instanceof Me&&(N="User is logged out");const E=`<strong>Entry not created</strong><br/> ${N}`;ke.push(E,{theme:{"--toastBarBackground":"#FF0000"}})}};function m(){s=this.value,l(0,s)}function i(){c=this.value,l(1,c)}function v(){a=this.files,l(3,a)}function o(w){Ee[w?"unshift":"push"](()=>{h=w,l(2,h)})}return[s,c,h,a,t,u,m,i,v,o,()=>{l(2,h.value="",h)}]}class Ke extends ce{constructor(e){super(),ue(this,e,Je,xe,se,{})}}function Qe(n){let e,l="Something went wrong",t,r,s=JSON.stringify(n[3])+"",c;return{c(){e=k("p"),e.textContent=l,t=U(),r=k("p"),c=ae(s)},l(h){e=C(h,"P",{"data-svelte-h":!0}),S(e)!=="svelte-171fb2d"&&(e.textContent=l),t=I(h),r=C(h,"P",{});var a=A(r);c=oe(a,s),a.forEach(p)},m(h,a){y(h,e,a),y(h,t,a),y(h,r,a),P(r,c)},p(h,a){a&1&&s!==(s=JSON.stringify(h[3])+"")&&ie(c,s)},i:D,o:D,d(h){h&&(p(e),p(t),p(r))}}}function We(n){let e,l;return e=new Fe({props:{reactions:n[2]}}),{c(){Y(e.$$.fragment)},l(t){Z(e.$$.fragment,t)},m(t,r){ee(e,t,r),l=!0},p(t,r){const s={};r&1&&(s.reactions=t[2]),e.$set(s)},i(t){l||(J(e.$$.fragment,t),l=!0)},o(t){x(e.$$.fragment,t),l=!1},d(t){te(e,t)}}}function Xe(n){let e,l="Loading data";return{c(){e=k("p"),e.textContent=l},l(t){e=C(t,"P",{"data-svelte-h":!0}),S(e)!=="svelte-ezyzhc"&&(e.textContent=l)},m(t,r){y(t,e,r)},p:D,i:D,o:D,d(t){t&&p(e)}}}function Ye(n){let e,l,t,r="Reactor",s,c,h="Upload",a,u,m,i,v="Content",o,_,w,N;e=new De({props:{title:"Reactor",description:"My collection of memes"}}),u=new Ke({}),u.$on("upload",n[1]);let E={ctx:n,current:null,token:null,hasCatch:!0,pending:Xe,then:We,catch:Qe,value:2,error:3,blocks:[,,,]};return pe(w=n[0],E),{c(){Y(e.$$.fragment),l=U(),t=k("h2"),t.textContent=r,s=U(),c=k("h3"),c.textContent=h,a=U(),Y(u.$$.fragment),m=U(),i=k("h3"),i.textContent=v,o=U(),_=W(),E.block.c()},l(f){Z(e.$$.fragment,f),l=I(f),t=C(f,"H2",{"data-svelte-h":!0}),S(t)!=="svelte-3o4hy8"&&(t.textContent=r),s=I(f),c=C(f,"H3",{"data-svelte-h":!0}),S(c)!=="svelte-18fi3zp"&&(c.textContent=h),a=I(f),Z(u.$$.fragment,f),m=I(f),i=C(f,"H3",{"data-svelte-h":!0}),S(i)!=="svelte-1qnf76d"&&(i.textContent=v),o=I(f),_=W(),E.block.l(f)},m(f,$){ee(e,f,$),y(f,l,$),y(f,t,$),y(f,s,$),y(f,c,$),y(f,a,$),ee(u,f,$),y(f,m,$),y(f,i,$),y(f,o,$),y(f,_,$),E.block.m(f,E.anchor=$),E.mount=()=>_.parentNode,E.anchor=_,N=!0},p(f,[$]){n=f,E.ctx=n,$&1&&w!==(w=n[0])&&pe(w,E)||Te(E,n,$)},i(f){N||(J(e.$$.fragment,f),J(u.$$.fragment,f),J(E.block),N=!0)},o(f){x(e.$$.fragment,f),x(u.$$.fragment,f);for(let $=0;$<3;$+=1){const M=E.blocks[$];x(M)}N=!1},d(f){f&&(p(l),p(t),p(s),p(c),p(a),p(m),p(i),p(o),p(_)),te(e,f),te(u,f),E.block.d(f),E.token=null,E=null}}}function Ze(n,e,l){let t=me();return[t,()=>l(0,t=me())]}class ut extends ce{constructor(e){super(),ue(this,e,Ze,Ye,se,{})}}export{ut as component,ct as universal};
