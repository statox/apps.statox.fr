import"../chunks/NZTpNUN0.js";import{o as ae,a as re}from"../chunks/D8ZVDlyY.js";import{p as ne,b as m,s as i,f as c,a as n,d as oe,e as r,g as d,h as a,c as j,i as B,r as N,t as O,j as V}from"../chunks/tjCGPzdr.js";import{d as se,s as W}from"../chunks/DOKer7p_.js";import{i as v}from"../chunks/BsrVr-Z0.js";import{B as M,a as Y}from"../chunks/CBhOl9Kc.js";import{P as ie}from"../chunks/CpX8xF_L.js";var le=m("<p>Connecting to the server…</p>"),pe=m("<p>Waiting for an opponent to connect…</p>"),ve=m("<p> </p> <!>",1),_e=m("<p>Something went wrong. Board is not defined.</p>"),fe=m('<p> </p> <button>New game</button> <span style="font-weight: bold"><!></span> <!>',1),ge=m("<p>Disconnected</p> <button>New game</button>",1),me=m("<h3>Simple WebSocket Client</h3> <!> <!> <!> <!> <!>",1);function he(q,z){ne(z,!0);let l,A=d(null),_=d(null),f=d(null),h=d(""),w=d(null),p=d("connecting");const F=ie.replace(/^http?/,"ws");ae(()=>{C()}),re(()=>{l&&l.close()});const C=()=>{l=new WebSocket(F),r(p,"connecting"),r(_,null),r(f,null),r(w,null),r(h,null),l.onopen=()=>{r(p,"waiting_for_opponent")},l.onclose=e=>{r(p,"game_over"),r(h,e.reason,!0)},l.onmessage=e=>{const t=JSON.parse(e.data);t.type==="game_ready"?(r(p,"playing"),r(A,t.youAre,!0),r(_,t.board,!0)):t.type==="update_board"?(r(_,t.board,!0),r(f,t.boardState,!0),r(w,t.winningCells,!0)):t.type==="waiting_for_opponent"&&r(f,null)}},E=e=>{if(!l||l.readyState!==WebSocket.OPEN)return;const t=JSON.stringify({move:e});l.send(t)};var L=me(),U=i(c(L),2);{var H=e=>{var t=le();n(e,t)};v(U,e=>{a(p)==="connecting"&&e(H)})}var D=i(U,2);{var K=e=>{var t=pe();n(e,t)};v(D,e=>{a(p)==="waiting_for_opponent"&&e(K)})}var G=i(D,2);{var Q=e=>{var t=j(),g=c(t);{var k=o=>{var u=ve(),b=c(u),P=B(b);N(b);var x=i(b,2);Y(x,{nbColumns:7,nbRows:6,get board(){return a(_)},get winningCells(){return a(w)},onMove:E}),O(()=>W(P,`You are Player ${a(A)??""}`)),n(o,u)},y=o=>{var u=_e();n(o,u)};v(g,o=>{a(_)!==null?o(k):o(y,!1)})}n(e,t)};v(G,e=>{a(p)==="playing"&&e(Q)})}var I=i(G,2);{var T=e=>{var t=fe(),g=c(t),k=B(g);N(g);var y=i(g,2);y.__click=C;var o=i(y,2),u=B(o);{var b=s=>{var S=V("Game Over");n(s,S)},P=s=>{var S=j(),ee=c(S);{var te=R=>{var J=V();O(()=>W(J,`Player ${a(f)??""} wins`)),n(R,J)};v(ee,R=>{(a(f)===M.winPlayer1||a(f)===M.winPlayer2)&&R(te)},!0)}n(s,S)};v(u,s=>{a(f)===M.draw?s(b):s(P,!1)})}N(o);var x=i(o,2);{var $=s=>{Y(s,{nbColumns:7,nbRows:6,get board(){return a(_)},get winningCells(){return a(w)},onMove:E})};v(x,s=>{a(_)!==null&&s($)})}O(()=>W(k,`Game over - ${a(h)??""}`)),n(e,t)};v(I,e=>{a(p)==="game_over"&&e(T)})}var X=i(I,2);{var Z=e=>{var t=ge(),g=i(c(t),2);g.__click=C,n(e,t)};v(X,e=>{a(p)==="disconnected"&&e(Z)})}n(q,L),oe()}se(["click"]);export{he as component};
