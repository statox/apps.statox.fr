import"../chunks/NZTpNUN0.js";import{p as Y,h as x,aj as Z,i as y,g as e,b as p,f as I,s as n,r as i,a as c,d as ee,at as de,e as m,t as N,c as me,j as ue}from"../chunks/ClDZ5lex.js";import{d as te,s as J}from"../chunks/DGwtKS1M.js";import{a as fe}from"../chunks/BC66ksJp.js";import{i as O}from"../chunks/Dqk1RIi9.js";import{s as re,a as oe}from"../chunks/NlAokIjw.js";import{m as pe}from"../chunks/CRAA7vF-.js";import{g as ge,u as se,U as _e}from"../chunks/ctHO_Lze.js";import{M as ie}from"../chunks/EONi0t3B.js";import{M as be}from"../chunks/CJX-clmZ.js";import{P as B}from"../chunks/CpX8xF_L.js";import{r as he,A as ye}from"../chunks/D8J3ngjD.js";import{s as ke}from"../chunks/BgJCQexd.js";import{e as K,i as Q}from"../chunks/D_hHaaFd.js";import{r as W,s as j}from"../chunks/DYzGdg2Z.js";import{b as X,d as xe}from"../chunks/rn1jzQv-.js";import{r as we}from"../chunks/FS1mVvE4.js";import{t as ne}from"../chunks/iJxvbM-6.js";import{b as Se}from"../chunks/CtHNUjIA.js";import{M as Te}from"../chunks/66zRogOR.js";import"../chunks/Dt4LyF16.js";import{p as Ue}from"../chunks/f74QZuov.js";const Le=!1,gt=Object.freeze(Object.defineProperty({__proto__:null,ssr:Le},Symbol.toStringTag,{value:"Module"})),ae=()=>he({path:"/reactor/getEntriesForPublic"}),Me=async u=>{const o=B+"/reactor/addEntry",_=await ge();typeof _=="string"&&await ke.post(o).auth(_,{type:"bearer"}).field("name",u.name).field("commaSeparatedTags",u.commaSeparatedTags).attach("file",u.file)};var Ce=p('<span class="tag svelte-noox7t"> </span>'),Ae=(u,o,_)=>o(e(_)),Pe=p('<video class="medium-margin svelte-noox7t" style="max-width: 100%" controls></video>',2),Re=p('<img class="medium-margin svelte-noox7t"/>'),Ee=p('<div><div><b> </b></div> <div class="svelte-noox7t"></div> <div><button class="full-width svelte-noox7t"><i class="fas fa-copy"></i> Copy link</button></div></div> <div><a rel="noopener noreferrer" target="blank"><!></a></div>',1),Fe=(u,o)=>de(o),Ne=p('<button class="full-width medium-margin svelte-noox7t">More...</button>'),Oe=p('<input class="full-width medium-margin svelte-noox7t" type="text" placeholder="Search by tags or name"/> <div class="container svelte-noox7t"></div> <!>',1);function $e(u,o){Y(o,!0);const _=10;let L=x(1),C=x(Z([])),v=x("");const w=(a,t)=>{if(!t.length||a.name.toLowerCase().includes(t.toLowerCase()))return!0;for(const d of a.tags)if(d.toLowerCase().includes(t.toLowerCase()))return!0;return!1},S=a=>{navigator.clipboard.writeText(B+a.uri),ne.push('<i class="fas fa-check"></i> Link copied to clipboard',{duration:1e3,theme:{"--toastBarHeight":0}})},T=a=>a.s3PresignedUrl.includes(".mp4");we(()=>{y(C,o.reactions.filter(a=>w(a,e(v))).sort((a,t)=>t.creationDateUnix-a.creationDateUnix).slice(0,e(v).length?void 0:e(L)*_),!0)});var b=Oe(),h=I(b);W(h);var M=n(h,2);K(M,21,()=>e(C),Q,(a,t)=>{var l=Ee(),d=I(l),g=m(d),z=m(g),D=m(z,!0);i(z),i(g);var P=n(g,2);K(P,21,()=>e(t).tags,Q,(k,r)=>{var f=Ce(),H=m(f,!0);i(f),N(()=>J(H,e(r))),c(k,f)}),i(P);var R=n(P,2),$=m(R);$.__click=[Ae,S,t],i(R),i(d);var E=n(d,2),U=m(E),V=m(U);{var q=k=>{var r=Pe();N(()=>j(r,"src",B+e(t).uri)),c(k,r)},G=k=>{var r=Re();N(()=>{j(r,"src",B+e(t).uri),j(r,"alt",e(t).name)}),c(k,r)};O(V,k=>{T(e(t))?k(q):k(G,!1)})}i(U),i(E),N(()=>{J(D,e(t).name),j(U,"href",B+e(t).uri),j(U,"download",e(t).name)}),c(a,l)}),i(M);var A=n(M,2);{var s=a=>{var t=Ne();t.__click=[Fe,L],c(a,t)};O(A,a=>{e(v).length===0&&e(L)*_<o.reactions.length&&a(s)})}X(h,()=>e(v),a=>y(v,a)),c(u,b),ee()}te(["click"]);var je=(u,o)=>{e(o)!==void 0&&(e(o).value="")},Be=p('<button class="form-action svelte-1kgynly"><!></button>'),Ie=p('<span class="form-action svelte-1kgynly">Login to upload an entry</span>'),ze=p('<div role="dialog" class="modal svelte-1kgynly"><div class="contents svelte-1kgynly"><h4 class="title-bar svelte-1kgynly">Add a new file <button>Close</button></h4> <!> <form class="form-content svelte-1kgynly"><label for="name">Name</label> <input type="text"/> <label for="content">Tags</label> <input type="textarea"/> <label for="file">File</label> <span><input class="file-input svelte-1kgynly" type="file"/> <button aria-label="delete file"><i class="fas fa-times-circle"></i></button></span> <br/> <!></form></div></div>');function De(u,o){Y(o,!0);const _=()=>oe(se,"$user",L),[L,C]=re();let v=x(Z([])),w=x(""),S=x(""),T=x(void 0),b=x(void 0),h=x(!1);const M=async()=>{y(v,[],!0),e(w)?.length||e(v).push({level:"error",header:"name must be defined"});let t;if(e(b)&&e(b).length&&(t=e(b)[0]),t||e(v).push({level:"error",header:"a file must be uploaded"}),!(e(v).length||!t))try{y(h,!0),await Me({name:e(w),commaSeparatedTags:e(S),file:t}),y(h,!1),o.onUpload(),o.close()}catch(l){y(h,!1);let d=l.message;l instanceof ye&&l.code===401?d="Invalid logged in user":l instanceof _e&&(d="User is logged out");const g=`<strong>Entry not created</strong><br/> ${d}`;ne.push(g,{theme:{"--toastBarBackground":"#FF0000"}})}};var A=me(),s=I(A);{var a=t=>{var l=ze(),d=m(l),g=m(d),z=n(m(g));z.__click=function(...r){o.close?.apply(this,r)},i(g);var D=n(g,2);K(D,17,()=>e(v),Q,(r,f)=>{ie(r,{get item(){return e(f)}})});var P=n(D,2),R=n(m(P),2);W(R);var $=n(R,4);W($);var E=n($,4),U=m(E);Se(U,r=>y(T,r),()=>e(T));var V=n(U,2);V.__click=[je,T],i(E);var q=n(E,4);{var G=r=>{var f=Be();f.__click=M;var H=m(f);{var le=F=>{Te(F,{size:.5,unit:"em",durationSeconds:.5})},ce=F=>{var ve=ue("Submit");c(F,ve)};O(H,F=>{e(h)?F(le):F(ce,!1)})}i(f),N(()=>f.disabled=e(h)),c(r,f)},k=r=>{var f=Ie();c(r,f)};O(q,r=>{_()?r(G):r(k,!1)})}i(P),i(d),i(l),X(R,()=>e(w),r=>y(w,r)),X($,()=>e(S),r=>y(S,r)),xe(U,()=>e(b),r=>y(b,r)),c(t,l)};O(s,t=>{o.isOpen&&t(a)})}c(u,A),ee(),C()}te(["click"]);var Ve=(u,o)=>pe.open(De,{onUpload:o}),qe=p("<button>Add an entry</button>"),Ge=p("<p>Something went wrong</p> <p> </p>",1),He=p("<p>Loading data</p>"),Je=p("<!> <h2>Upload</h2> <!> <h2>Content</h2> <!>",1);function _t(u,o){Y(o,!0);const _=()=>oe(se,"$user",L),[L,C]=re();Ue.set("Reactor");let v=x(Z(ae()));const w=()=>y(v,ae(),!0);var S=Je(),T=I(S);be(T,{title:"Reactor",description:"My collection of memes"});var b=n(T,4);{var h=s=>{var a=qe();a.__click=[Ve,w],c(s,a)},M=s=>{ie(s,{item:{level:"info",header:"Login to add an entry"}})};O(b,s=>{_()?s(h):s(M,!1)})}var A=n(b,4);fe(A,()=>e(v),s=>{var a=He();c(s,a)},(s,a)=>{$e(s,{get reactions(){return e(a)}})},(s,a)=>{var t=Ge(),l=n(I(t),2),d=m(l,!0);i(l),N(g=>J(d,g),[()=>JSON.stringify(e(a))]),c(s,t)}),c(u,S),ee(),C()}te(["click"]);export{_t as component,gt as universal};
