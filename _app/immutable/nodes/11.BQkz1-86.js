import"../chunks/CWj6FrbW.js";import{i as te}from"../chunks/DyVAq43h.js";import{p as U,v as w,G as h,C as y,y as f,i as e,aR as ae,H as _,a as k,x as $,w as R,g as p,E as q,aV as re,c as oe,f as ne}from"../chunks/CGiGqk7P.js";import{i as C}from"../chunks/Cc712tkr.js";import{a as D,s as O}from"../chunks/Bo8eQkir.js";import{u as G,U as se}from"../chunks/DPC4cLuF.js";import{M as H}from"../chunks/BLNcyNr3.js";import{d as E,s as ie,r as le}from"../chunks/C57t7CU5.js";import{e as Q,i as V}from"../chunks/ZXkaPWj7.js";import{r as F}from"../chunks/BbjtQk7y.js";import{b as N}from"../chunks/SGPRxWVV.js";import{A as de}from"../chunks/DULH4Exk.js";import{M as ue}from"../chunks/CKFnamwM.js";import{t as j}from"../chunks/DcgF9Wk6.js";import{a as ve,b as ce}from"../chunks/fGrmgdRb.js";import{g as me}from"../chunks/DNuAwZD8.js";import{I as fe}from"../chunks/DeyMpdej.js";import{o as pe}from"../chunks/CaQVVKkx.js";import{p as ge}from"../chunks/DzVEKABi.js";import{p as _e}from"../chunks/DIQnpm5d.js";const be=(g,a)=>{p(a,!1)};var he=(g,a,i)=>a(e(i)),ye=w('<div class="option svelte-10zooem"> </div>'),ke=w('<div class="dropdown svelte-10zooem"></div>'),xe=w('<span><input type="text" class="svelte-10zooem"/> <!></span>');function we(g,a){U(a,!0);const i=t=>t.normalize("NFD").replace(/[\u0300-\u036f]/g,"");let r=ge(a,"value",15),o=y(!1),c=ae(()=>a.options.filter(t=>r().length<2?!1:i(t).toLowerCase().includes(i(r()).toLowerCase())));function v(t){r(t),p(o,!0)}var u=xe(),n=h(u);F(n),n.__input=[be,o];var s=f(n,2);{var l=t=>{var b=ke();Q(b,21,()=>e(c),V,(A,z)=>{var x=ye();x.__click=[he,v,z];var L=h(x,!0);_(x),R(()=>ie(L,e(z))),k(A,x)}),_(b),k(t,b)};C(s,t=>{e(c).length>0&&!e(o)&&t(l)})}_(u),N(n,r),k(g,u),$()}E(["input","click"]);const Ie=(g,a,i,r,o)=>{e(a)&&i.onAdd({name:e(a),quantity:e(r),unit:e(o)})};var ze=w('<div class="input-container svelte-1mzmydd"><label for="name">Ingredient</label> <!> <label for="quantity">Quantity</label> <input type="number"/> <label for="quantity">Unit</label> <input type="text"/> <button><i class="fa fa-solid fa-plus"></i></button></div>');function Le(g,a){U(a,!0);let i=y(q([])),r=y(""),o=y(void 0),c=y(void 0);pe(async()=>{p(i,(await ve()).ingredients.sort((t,b)=>t<b?1:0).map(t=>t.name),!0)});var v=ze(),u=f(h(v),2);we(u,{get options(){return e(i)},get value(){return e(r)},set value(t){p(r,t,!0)}});var n=f(u,4);F(n);var s=f(n,4);F(s);var l=f(s,2);l.__click=[Ie,r,a,o,c],_(v),N(n,()=>e(o),t=>p(o,t)),N(s,()=>e(c),t=>p(c,t)),k(g,v),$()}E(["click"]);const Ne=async(g,a,i,r,o,c,v)=>{var u,n;if(p(a,[],!0),(u=e(i))!=null&&u.length||e(a).push({level:"error",header:"Name must be defined"}),(n=e(r))!=null&&n.length||e(a).push({level:"error",header:"Content must be defined"}),!e(a).length)try{p(o,!0),await ce({name:e(i),content:e(r),ingredients:c}),p(o,!1),v.onUpload()}catch(s){p(o,!1);let l=s.message;s instanceof de&&s.code===401?l="Invalid logged in user":s instanceof se&&(l="User is logged out");const t=`<strong>Entry not created</strong><br/> ${l}`;j.push(t,{theme:{"--toastBarBackground":"#FF0000"}})}};var Ce=()=>me("/cookbook"),Fe=w('<button class="form-action svelte-1603erd"><!></button>'),Ue=w('<span class="form-action svelte-1603erd">Login to upload an entry</span>'),$e=w('<div class="contents svelte-1603erd"><span class="title-bar svelte-1603erd"><h2>Add a new recipe</h2> <button class="svelte-1603erd">Back to list</button></span> <!> <div class="form-content svelte-1603erd"><label for="name">Name</label> <input type="text"/> <label for="ingredients">New ingredient</label> <div><!></div> <label for="ingredients">List of ingredients</label> <div><!></div> <label for="content">Instructions</label> <textarea rows="10" cols="50"></textarea></div> <!></div>');function Ae(g,a){U(a,!0);const[i,r]=O(),o=()=>D(G,"$user",i);let c=y(q([])),v=y(!1),u=y(""),n=y(""),s=q([]);const l=d=>{if(s.find(m=>m.name===d.name)){const m=d.name+" already added";j.push(m,{theme:{"--toastBarBackground":"#FF0000"}});return}s.push(d)};var t=$e(),b=h(t),A=f(h(b),2);A.__click=[Ce],_(b);var z=f(b,2);Q(z,17,()=>e(c),V,(d,m)=>{H(d,{get item(){return e(m)}})});var x=f(z,2),L=f(h(x),2);F(L);var B=f(L,4),J=h(B);Le(J,{onAdd:l}),_(B);var M=f(B,4),K=h(M);fe(K,{get ingredients(){return s},editable:!0}),_(M);var S=f(M,4);le(S),_(x);var P=f(x,2);{var T=d=>{var m=Fe();m.__click=[Ne,c,u,n,v,s,a];var X=h(m);{var Y=I=>{ue(I,{size:.5,unit:"em",durationSeconds:.5})},Z=I=>{var ee=re("Submit");k(I,ee)};C(X,I=>{e(v)?I(Y):I(Z,!1)})}_(m),R(()=>m.disabled=e(v)),k(d,m)},W=d=>{var m=Ue();k(d,m)};C(P,d=>{o()?d(T):d(W,!1)})}_(t),N(L,()=>e(u),d=>p(u,d)),N(S,()=>e(n),d=>p(n,d)),k(g,t),$(),r()}E(["click"]);function Ze(g,a){U(a,!1);const[i,r]=O(),o=()=>D(G,"$user",i);_e.set("Cookbook");const c=()=>{console.log("New recipe created")};te();var v=oe(),u=ne(v);{var n=l=>{Ae(l,{onUpload:c})},s=l=>{H(l,{item:{level:"info",header:"Login to add an entry"}})};C(u,l=>{o()?l(n):l(s,!1)})}k(g,v),$(),r()}export{Ze as component};
