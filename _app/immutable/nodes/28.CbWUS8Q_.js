import"../chunks/DsnmJJEf.js";import{p as Y,b as v,f as $,s,g as e,aL as me,r as o,h as w,i as b,a as l,d as Z,U as ve,e as c,t as I,C as ae,c as ue,j as fe}from"../chunks/C3-yz8dw.js";import{d as ee,s as G}from"../chunks/DUwLERL-.js";import{a as pe}from"../chunks/BczP4ff2.js";import{i as O}from"../chunks/Ceeih1bB.js";import{s as re,a as oe}from"../chunks/k7vEulbC.js";import{m as ge}from"../chunks/BN9xPd9q.js";import{u as se}from"../chunks/Byefvy9Z.js";import{M as ie}from"../chunks/BCRe70JM.js";import{M as _e}from"../chunks/cADELSPa.js";import{P as z}from"../chunks/CELBgAxi.js";import{c as be}from"../chunks/RZZgkjFT.js";import{s as he}from"../chunks/bLM0CJ-A.js";import{e as K,i as Q}from"../chunks/C63BUUd7.js";import{r as W,s as j}from"../chunks/C4tlimJ_.js";import{b as X,d as ye}from"../chunks/CVqt2Uny.js";import{t as ne}from"../chunks/L5I2oL6d.js";import{b as xe}from"../chunks/DuPGlERk.js";import{U as ke}from"../chunks/BWptIUEw.js";import{A as we}from"../chunks/CuMzzfZD.js";import{M as Me}from"../chunks/8lDCG3vb.js";import"../chunks/CrquYXKP.js";import"../chunks/DIkBcL1r.js";import{p as Se}from"../chunks/BQF7YunG.js";const Ue=!1,ut=Object.freeze(Object.defineProperty({__proto__:null,ssr:Ue},Symbol.toStringTag,{value:"Module"})),te=be.reactor.getEntriesForPublic,Le=async h=>{const d=z+"/reactor/addEntry";await he.post(d).withCredentials().field("name",h.name).field("commaSeparatedTags",h.commaSeparatedTags).attach("file",h.file)};var Ce=v('<span class="tag svelte-noox7t"> </span>'),Te=v('<video class="medium-margin svelte-noox7t" style="max-width: 100%" controls></video>',2),Ae=v('<img class="medium-margin svelte-noox7t"/>'),Ee=v('<div><div><b> </b></div> <div class="svelte-noox7t"></div> <div><button class="full-width svelte-noox7t"><i class="fas fa-copy"></i> Copy link</button></div></div> <div><a rel="noopener noreferrer" target="blank"><!></a></div>',1),Pe=v('<button class="full-width medium-margin svelte-noox7t">More...</button>'),Re=v('<input class="full-width medium-margin svelte-noox7t" type="text" placeholder="Search by tags or name"/> <div class="container svelte-noox7t"></div> <!>',1);function Fe(h,d){Y(d,!0);const C=10;let S=w(1),y=w("");const p=me(()=>d.reactions.filter(a=>x(a,e(y))).sort((a,t)=>t.creationDateUnix-a.creationDateUnix).slice(0,e(y).length?void 0:e(S)*C)),x=(a,t)=>{if(!t.length||a.name.toLowerCase().includes(t.toLowerCase()))return!0;for(const n of a.tags)if(n.toLowerCase().includes(t.toLowerCase()))return!0;return!1},U=a=>{navigator.clipboard.writeText(z+a.uri),ne.push('<i class="fas fa-check"></i> Link copied to clipboard',{duration:1e3,theme:{"--toastBarHeight":0}})},k=a=>a.s3PresignedUrl.includes(".mp4");var g=Re(),u=$(g);W(u);var L=s(u,2);K(L,21,()=>e(p),Q,(a,t)=>{var i=Ee(),n=$(i),f=c(n),A=c(f),D=c(A,!0);o(A),o(f);var E=s(f,2);K(E,21,()=>e(t).tags,Q,(_,r)=>{var m=Ce(),q=c(m,!0);o(m),I(()=>G(q,e(r))),l(_,m)}),o(E);var P=s(E,2),N=c(P);N.__click=()=>U(e(t)),o(P),o(n);var R=s(n,2),M=c(R),H=c(M);{var V=_=>{var r=Te();I(()=>j(r,"src",z+e(t).uri)),l(_,r)},J=_=>{var r=Ae();I(()=>{j(r,"src",z+e(t).uri),j(r,"alt",e(t).name)}),l(_,r)};O(H,_=>{k(e(t))?_(V):_(J,!1)})}o(M),o(R),I(()=>{G(D,e(t).name),j(M,"href",z+e(t).uri),j(M,"download",e(t).name)}),l(a,i)}),o(L);var T=s(L,2);{var B=a=>{var t=Pe();t.__click=()=>ve(S),l(a,t)};O(T,a=>{e(y).length===0&&e(S)*C<d.reactions.length&&a(B)})}X(u,()=>e(y),a=>b(y,a)),l(h,g),Z()}ee(["click"]);var Ie=v('<button class="form-action svelte-1kgynly"><!></button>'),Oe=v('<span class="form-action svelte-1kgynly">Login to upload an entry</span>'),Be=v('<div role="dialog" class="modal svelte-1kgynly"><div class="contents svelte-1kgynly"><h4 class="title-bar svelte-1kgynly">Add a new file <button>Close</button></h4> <!> <form class="form-content svelte-1kgynly"><label for="name">Name</label> <input type="text"/> <label for="content">Tags</label> <input type="textarea"/> <label for="file">File</label> <span><input class="file-input svelte-1kgynly" type="file"/> <button aria-label="delete file"><i class="fas fa-times-circle"></i></button></span> <br/> <!></form></div></div>');function Ne(h,d){Y(d,!0);const C=()=>oe(se,"$user",S),[S,y]=re();let p=w(ae([])),x=w(""),U=w(""),k=w(void 0),g=w(void 0),u=w(!1);const L=async()=>{b(p,[],!0),e(x)?.length||e(p).push({level:"error",header:"name must be defined"});let t;if(e(g)&&e(g).length&&(t=e(g)[0]),t||e(p).push({level:"error",header:"a file must be uploaded"}),!(e(p).length||!t))try{b(u,!0),await Le({name:e(x),commaSeparatedTags:e(U),file:t}),b(u,!1),d.onUpload(),d.close()}catch(i){b(u,!1);let n=i.message;i instanceof we&&i.code===401?n="Invalid logged in user":i instanceof ke&&(n="User is logged out");const f=`<strong>Entry not created</strong><br/> ${n}`;ne.push(f,{theme:{"--toastBarBackground":"#FF0000"}})}};var T=ue(),B=$(T);{var a=t=>{var i=Be(),n=c(i),f=c(n),A=s(c(f));A.__click=function(...r){d.close?.apply(this,r)},o(f);var D=s(f,2);K(D,17,()=>e(p),Q,(r,m)=>{ie(r,{get item(){return e(m)}})});var E=s(D,2),P=s(c(E),2);W(P);var N=s(P,4);W(N);var R=s(N,4),M=c(R);xe(M,r=>b(k,r),()=>e(k));var H=s(M,2);H.__click=()=>{e(k)!==void 0&&(e(k).value="")},o(R);var V=s(R,4);{var J=r=>{var m=Ie();m.__click=L;var q=c(m);{var le=F=>{Me(F,{size:.5,unit:"em",durationSeconds:.5})},ce=F=>{var de=fe("Submit");l(F,de)};O(q,F=>{e(u)?F(le):F(ce,!1)})}o(m),I(()=>m.disabled=e(u)),l(r,m)},_=r=>{var m=Oe();l(r,m)};O(V,r=>{C()?r(J):r(_,!1)})}o(E),o(n),o(i),X(P,()=>e(x),r=>b(x,r)),X(N,()=>e(U),r=>b(U,r)),ye(M,()=>e(g),r=>b(g,r)),l(t,i)};O(B,t=>{d.isOpen&&t(a)})}l(h,T),Z(),y()}ee(["click"]);var je=v("<button>Add an entry</button>"),ze=v("<p>Something went wrong</p> <p> </p>",1),$e=v("<p>Loading data</p>"),De=v("<!> <h2>Upload</h2> <!> <h2>Content</h2> <!>",1);function ft(h,d){Y(d,!0);const C=()=>oe(se,"$user",S),[S,y]=re(),p={name:"Reactor",description:"My collection of memes",showAuthInHeader:!0};Se.set(p);let x=w(ae(te()));const U=()=>b(x,te(),!0);var k=De(),g=$(k);_e(g,{get title(){return p.name},get description(){return p.description}});var u=s(g,4);{var L=a=>{var t=je();t.__click=()=>ge.open(Ne,{onUpload:U}),l(a,t)},T=a=>{ie(a,{item:{level:"info",header:"Login to add an entry"}})};O(u,a=>{C()?a(L):a(T,!1)})}var B=s(u,4);pe(B,()=>e(x),a=>{var t=$e();l(a,t)},(a,t)=>{Fe(a,{get reactions(){return e(t)}})},(a,t)=>{var i=ze(),n=s($(i),2),f=c(n,!0);o(n),I(A=>G(f,A),[()=>JSON.stringify(e(t))]),l(a,i)}),l(h,k),Z(),y()}ee(["click"]);export{ft as component,ut as universal};
