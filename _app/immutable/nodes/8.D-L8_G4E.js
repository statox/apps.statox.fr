import"../chunks/disclose-version.Bg9kRutz.js";import{i as Z}from"../chunks/legacy.C6Jsm68G.js";import{p as C,aF as x,w as m,g as e,aG as _,n as F,s as f,aH as b,aa as ee,k as E,o as te,v as ae}from"../chunks/index-client.CwKaIs20.js";import{f as S,a as h,t as w,u as re,q as oe,e as ne}from"../chunks/template.7grJUHbA.js";import{i as $}from"../chunks/if.Bi_20hhT.js";import{s as D,a as O}from"../chunks/store.ChaSGJXD.js";import{u as R,U as ie}from"../chunks/service.q9RfI6or.js";import{M as G}from"../chunks/Main.BgwN8zOH.js";import{e as H,i as Q}from"../chunks/each.DKzLuYBh.js";import{r as q}from"../chunks/attributes.Dc62wPgd.js";import{b as A}from"../chunks/input.DRsL7Czo.js";import{p as N}from"../chunks/proxy.CJQ3oePJ.js";import{A as se}from"../chunks/index.CCVS0Esp.js";import{M as le}from"../chunks/Main.r7rNSox8.js";import{t as de}from"../chunks/SvelteToast.svelte_svelte_type_style_lang.DRXwEw9Z.js";import{a as ue,b as ve}from"../chunks/api.CLq8Sm3S.js";import{g as ce}from"../chunks/entry.UoDXXENS.js";import{I as me}from"../chunks/IngredientsList.Bwx8EGuD.js";import{s as fe}from"../chunks/render.CCvbYkc4.js";import{p as pe}from"../chunks/props.C12I74pf.js";import{p as ge}from"../chunks/Main.svelte_svelte_type_style_lang.D3Nk8NBC.js";const _e=(p,a)=>{f(a,!1)};var be=(p,a,s)=>a(e(s)),he=w('<div class="option svelte-10zooem"> </div>'),ke=w('<div class="dropdown svelte-10zooem"></div>'),ye=w('<span><input type="text" class="svelte-10zooem"> <!></span>');function xe(p,a){C(a,!0);const s=t=>t.normalize("NFD").replace(/[\u0300-\u036f]/g,"");let r=pe(a,"value",15),o=b(!1),c=ee(()=>a.options.filter(t=>r().length<2?!1:s(t).toLowerCase().includes(s(r()).toLowerCase())));function u(t){r(t),f(o,!0)}var d=ye(),n=x(d);q(n),n.__input=[_e,o];var i=m(n,2);{var l=t=>{var k=ke();H(k,21,()=>e(c),Q,(U,I)=>{var y=he();y.__click=[be,u,I];var z=x(y,!0);_(y),E(()=>fe(z,e(I))),h(U,y)}),_(k),h(t,k)};$(i,t=>{e(c).length>0&&!e(o)&&t(l)})}_(d),A(n,r),h(p,d),F()}S(["input","click"]);const we=(p,a,s,r,o)=>{e(a)&&s.onAdd({name:e(a),quantity:e(r),unit:e(o)})};var Ie=w('<div class="input-container svelte-yrmwio"><label for="name">Ingredient</label> <!> <label for="quantity">Quantity</label> <input type="number"> <label for="quantity">Unit</label> <input type="text"> <button><i class="fa fa-solid fa-plus"></i></button></div>');function Le(p,a){C(a,!0);let s=b(N([])),r=b(""),o=b(void 0),c=b(void 0);te(async()=>{f(s,N((await ue()).ingredients.sort((t,k)=>t<k?1:0).map(t=>t.name)))});var u=Ie(),d=m(x(u),2);xe(d,{get options(){return e(s)},get value(){return e(r)},set value(t){f(r,N(t))}});var n=m(d,4);q(n);var i=m(n,4);q(i);var l=m(i,2);l.__click=[we,r,a,o,c],_(u),A(n,()=>e(o),t=>f(o,t)),A(i,()=>e(c),t=>f(c,t)),h(p,u),F()}S(["click"]);const Ne=async(p,a,s,r,o,c,u)=>{var d,n;if(f(a,N([])),(d=e(s))!=null&&d.length||e(a).push({level:"error",header:"Name must be defined"}),(n=e(r))!=null&&n.length||e(a).push({level:"error",header:"Content must be defined"}),!e(a).length)try{f(o,!0),await ve({name:e(s),content:e(r),ingredients:c}),f(o,!1),u.onUpload()}catch(i){f(o,!1);let l=i.message;i instanceof se&&i.code===401?l="Invalid logged in user":i instanceof ie&&(l="User is logged out");const t=`<strong>Entry not created</strong><br/> ${l}`;de.push(t,{theme:{"--toastBarBackground":"#FF0000"}})}};var ze=()=>ce("/cookbook"),Ae=w('<button class="form-action svelte-kmn9ao"><!></button>'),Ue=w('<span class="form-action svelte-kmn9ao">Login to upload an entry</span>'),$e=w('<div class="contents svelte-kmn9ao"><h2 class="title-bar svelte-kmn9ao">Add a new recipe</h2> <button>Back to list</button> <!> <div class="form-content svelte-kmn9ao"><label for="name">Name</label> <input type="text"> <label for="ingredients">New ingredient</label> <div><!></div> <label for="ingredients">List of ingredients</label> <div><!></div> <label for="content">Instructions</label> <textarea rows="10" cols="50"></textarea></div> <!></div>');function qe(p,a){C(a,!0);const[s,r]=D(),o=()=>O(R,"$user",s);let c=b(N([])),u=b(!1),d=b(""),n=b(""),i=N([]);const l=v=>{i.push(v),console.log("Added ingredient"),console.log(i)};var t=$e(),k=m(x(t),2);k.__click=[ze];var U=m(k,2);H(U,17,()=>e(c),Q,(v,g)=>{G(v,{get item(){return e(g)}})});var I=m(U,2),y=m(x(I),2);q(y);var z=m(y,4),j=x(z);Le(j,{onAdd:l}),_(z);var M=m(z,4),J=x(M);me(J,{get ingredients(){return i},editable:!0}),_(M);var B=m(M,4);re(B),_(I);var K=m(I,2);{var P=v=>{var g=Ae();g.__click=[Ne,c,d,n,u,i,a];var V=x(g);{var W=L=>{le(L,{size:.5,unit:"em",durationSeconds:.5})},X=L=>{var Y=oe("Submit");h(L,Y)};$(V,L=>{e(u)?L(W):L(X,!1)})}_(g),E(()=>g.disabled=e(u)),h(v,g)},T=v=>{var g=Ue();h(v,g)};$(K,v=>{o()?v(P):v(T,!1)})}_(t),A(y,()=>e(d),v=>f(d,v)),A(B,()=>e(n),v=>f(n,v)),h(p,t),F(),r()}S(["click"]);function Ze(p,a){C(a,!1);const[s,r]=D(),o=()=>O(R,"$user",s);ge.set("Cookbook");const c=()=>{console.log("New recipe created")};Z();var u=ne(),d=ae(u);{var n=l=>{qe(l,{onUpload:c})},i=l=>{G(l,{item:{level:"info",header:"Login to add an entry"}})};$(d,l=>{o()?l(n):l(i,!1)})}h(p,u),F(),r()}export{Ze as component};
