import"../chunks/NZTpNUN0.js";import"../chunks/BIh37Rxm.js";import{p as A,d as _,s as d,g as e,e as ae,b as h,r as f,a as B,c as v,t as Q,W as E,bo as re,f as oe}from"../chunks/yfIaCavW.js";import{f as w,a as y,t as ne,c as se}from"../chunks/_u8npTyQ.js";import{i as F}from"../chunks/DvWUsNSo.js";import{i as ie}from"../chunks/B0B7sKuP.js";import{s as W,a as j}from"../chunks/1jKlADew.js";import{u as G}from"../chunks/C9v2jvCL.js";import{M as H}from"../chunks/DIOlz2gI.js";import{d as D}from"../chunks/CjDXmnel.js";import{e as J,i as K}from"../chunks/CjLfmKGv.js";import{r as U}from"../chunks/D5raxYZo.js";import{b as N}from"../chunks/rehqRcrF.js";import{A as le,U as de}from"../chunks/CYe5J-qk.js";import{M as ue}from"../chunks/DEdAW5jv.js";import{t as R}from"../chunks/BUQmhhdO.js";import{a as ce,b as ve}from"../chunks/BvxQbidH.js";import{g as me}from"../chunks/DYS6TYbM.js";import{I as pe}from"../chunks/De5FMCOj.js";import{o as fe}from"../chunks/BM9Aa3-5.js";import{s as ge}from"../chunks/BltxeNjO.js";import{p as be}from"../chunks/DibrhvKt.js";import{p as _e}from"../chunks/DMubeFcW.js";var he=w('<div class="option svelte-hwqdr1"> </div>'),ye=w('<div class="dropdown svelte-hwqdr1"></div>'),ke=w('<span><input type="text" class="svelte-hwqdr1"/> <!></span>');function xe(x,m){A(m,!0);const g=t=>t.normalize("NFD").replace(/[\u0300-\u036f]/g,"");let i=be(m,"value",15),p=h(!1),n=ae(()=>m.options.filter(t=>i().length<2?!1:g(t).toLowerCase().includes(g(i()).toLowerCase())));function u(t){i(t),v(p,!0)}const c=()=>{v(p,!1)};var l=ke(),o=_(l);U(o),o.__input=c;var s=d(o,2);{var M=t=>{var b=ye();J(b,21,()=>e(n),K,(C,q)=>{var k=he();k.__click=()=>u(e(q));var L=_(k,!0);f(k),Q(()=>ge(L,e(q))),y(C,k)}),f(b),y(t,b)};F(s,t=>{e(n).length>0&&!e(p)&&t(M)})}f(l),N(o,i),y(x,l),B()}D(["input","click"]);var we=w('<div class="input-container svelte-yzduke"><label for="name">Ingredient</label> <!> <label for="quantity">Quantity</label> <input type="number"/> <label for="quantity">Unit</label> <input type="text"/> <button><i class="fa fa-solid fa-plus"></i></button></div>');function Ie(x,m){A(m,!0);let g=h(E([])),i=h(""),p=h(void 0),n=h(void 0);const u=()=>{e(i)&&m.onAdd({name:e(i),quantity:e(p),unit:e(n)})};fe(async()=>{v(g,(await ce()).ingredients.sort((t,b)=>t<b?1:0).map(t=>t.name),!0)});var c=we(),l=d(_(c),2);xe(l,{get options(){return e(g)},get value(){return e(i)},set value(t){v(i,t,!0)}});var o=d(l,4);U(o);var s=d(o,4);U(s);var M=d(s,2);M.__click=u,f(c),N(o,()=>e(p),t=>v(p,t)),N(s,()=>e(n),t=>v(n,t)),y(x,c),B()}D(["click"]);var Me=w('<button class="form-action svelte-1ycbaol"><!></button>'),qe=w('<span class="form-action svelte-1ycbaol">Login to upload an entry</span>'),Le=w('<div class="contents svelte-1ycbaol"><span class="title-bar svelte-1ycbaol"><h2>Add a new recipe</h2> <button class="svelte-1ycbaol">Back to list</button></span> <!> <div class="form-content svelte-1ycbaol"><label for="name">Name</label> <input type="text"/> <label for="ingredients">New ingredient</label> <div><!></div> <label for="ingredients">List of ingredients</label> <div><!></div> <label for="content">Instructions</label> <textarea rows="10" cols="50"></textarea></div> <!></div>');function Ne(x,m){A(m,!0);const g=()=>W(G,"$user",i),[i,p]=j();let n=h(E([])),u=h(!1),c=h(""),l=h(""),o=E([]);const s=a=>{if(o.find(r=>r.name===a.name)){const r=a.name+" already added";R.push(r,{theme:{"--toastBarBackground":"#FF0000"}});return}o.push(a)},M=async()=>{if(v(n,[],!0),e(c)?.length||e(n).push({level:"error",header:"Name must be defined"}),e(l)?.length||e(n).push({level:"error",header:"Content must be defined"}),!e(n).length)try{v(u,!0),await ve({name:e(c),content:e(l),ingredients:o}),v(u,!1),m.onUpload()}catch(a){v(u,!1);let r=a.message;a instanceof le&&a.code===401?r="Invalid logged in user":a instanceof de&&(r="User is logged out");const S=`<strong>Entry not created</strong><br/> ${r}`;R.push(S,{theme:{"--toastBarBackground":"#FF0000"}})}};var t=Le(),b=_(t),C=d(_(b),2);C.__click=()=>me("/cookbook"),f(b);var q=d(b,2);J(q,17,()=>e(n),K,(a,r)=>{H(a,{get item(){return e(r)}})});var k=d(q,2),L=d(_(k),2);U(L);var $=d(L,4),P=_($);Ie(P,{onAdd:s}),f($);var z=d($,4),T=_(z);pe(T,{get ingredients(){return o},editable:!0}),f(z);var O=d(z,4);re(O),f(k);var V=d(k,2);{var X=a=>{var r=Me();r.__click=M;var S=_(r);{var Z=I=>{ue(I,{size:.5,unit:"em",durationSeconds:.5})},ee=I=>{var te=ne("Submit");y(I,te)};F(S,I=>{e(u)?I(Z):I(ee,!1)})}f(r),Q(()=>r.disabled=e(u)),y(a,r)},Y=a=>{var r=qe();y(a,r)};F(V,a=>{g()?a(X):a(Y,!1)})}f(t),N(L,()=>e(c),a=>v(c,a)),N(O,()=>e(l),a=>v(l,a)),y(x,t),B(),p()}D(["click"]);function Ye(x,m){A(m,!1);const g=()=>W(G,"$user",i),[i,p]=j();_e.set("Cookbook");const n=()=>{console.log("New recipe created")};ie();var u=se(),c=oe(u);{var l=s=>{Ne(s,{onUpload:n})},o=s=>{H(s,{item:{level:"info",header:"Login to add an entry"}})};F(c,s=>{g()?s(l):s(o,!1)})}y(x,u),B(),p()}export{Ye as component};
