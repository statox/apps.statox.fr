import"../chunks/DsnmJJEf.js";import"../chunks/CrquYXKP.js";import{p as N,b as w,e as _,s as d,g as e,aL as ae,h,r as f,a as y,d as U,i as v,t as j,C as E,bf as re,j as oe,c as ne,f as se}from"../chunks/C3-yz8dw.js";import{i as C}from"../chunks/Ceeih1bB.js";import{i as ie}from"../chunks/C_vsOW3i.js";import{a as H,s as Q}from"../chunks/k7vEulbC.js";import{u as G}from"../chunks/Byefvy9Z.js";import{M as J}from"../chunks/BCRe70JM.js";import{d as D,s as le}from"../chunks/DUwLERL-.js";import{e as K,i as P}from"../chunks/C63BUUd7.js";import{r as F}from"../chunks/C4tlimJ_.js";import{b as A}from"../chunks/CVqt2Uny.js";import{U as de}from"../chunks/BWptIUEw.js";import{A as ue}from"../chunks/CuMzzfZD.js";import"../chunks/RZZgkjFT.js";import{M as ce}from"../chunks/8lDCG3vb.js";import{t as R}from"../chunks/L5I2oL6d.js";import{a as ve,b as me}from"../chunks/DLJbMfq2.js";import{g as pe}from"../chunks/-sNYeQhT.js";import{I as fe}from"../chunks/pxrlWqnF.js";import{o as ge}from"../chunks/TYev8Wwd.js";import{p as be}from"../chunks/AreF8hsU.js";import"../chunks/DgRn7El4.js";import{p as _e}from"../chunks/BQF7YunG.js";var he=w('<div class="option svelte-hwqdr1"> </div>'),ye=w('<div class="dropdown svelte-hwqdr1"></div>'),ke=w('<span><input type="text" class="svelte-hwqdr1"/> <!></span>');function xe(x,m){N(m,!0);const g=t=>t.normalize("NFD").replace(/[\u0300-\u036f]/g,"");let i=be(m,"value",15),p=h(!1),n=ae(()=>m.options.filter(t=>i().length<2?!1:g(t).toLowerCase().includes(g(i()).toLowerCase())));function u(t){i(t),v(p,!0)}const c=()=>{v(p,!1)};var l=ke(),o=_(l);F(o),o.__input=c;var s=d(o,2);{var M=t=>{var b=ye();K(b,21,()=>e(n),P,(B,L)=>{var k=he();k.__click=()=>u(e(L));var q=_(k,!0);f(k),j(()=>le(q,e(L))),y(B,k)}),f(b),y(t,b)};C(s,t=>{e(n).length>0&&!e(p)&&t(M)})}f(l),A(o,i),y(x,l),U()}D(["input","click"]);var we=w('<div class="input-container svelte-yzduke"><label for="name">Ingredient</label> <!> <label for="quantity">Quantity</label> <input type="number"/> <label for="quantity">Unit</label> <input type="text"/> <button><i class="fa fa-solid fa-plus"></i></button></div>');function Ie(x,m){N(m,!0);let g=h(E([])),i=h(""),p=h(void 0),n=h(void 0);const u=()=>{e(i)&&m.onAdd({name:e(i),quantity:e(p),unit:e(n)})};ge(async()=>{v(g,(await ve()).ingredients.sort((t,b)=>t<b?1:0).map(t=>t.name),!0)});var c=we(),l=d(_(c),2);xe(l,{get options(){return e(g)},get value(){return e(i)},set value(t){v(i,t,!0)}});var o=d(l,4);F(o);var s=d(o,4);F(s);var M=d(s,2);M.__click=u,f(c),A(o,()=>e(p),t=>v(p,t)),A(s,()=>e(n),t=>v(n,t)),y(x,c),U()}D(["click"]);var Me=w('<button class="form-action svelte-1ycbaol"><!></button>'),Le=w('<span class="form-action svelte-1ycbaol">Login to upload an entry</span>'),qe=w('<div class="contents svelte-1ycbaol"><span class="title-bar svelte-1ycbaol"><h2>Add a new recipe</h2> <button class="svelte-1ycbaol">Back to list</button></span> <!> <div class="form-content svelte-1ycbaol"><label for="name">Name</label> <input type="text"/> <label for="ingredients">New ingredient</label> <div><!></div> <label for="ingredients">List of ingredients</label> <div><!></div> <label for="content">Instructions</label> <textarea rows="10" cols="50"></textarea></div> <!></div>');function Ae(x,m){N(m,!0);const g=()=>H(G,"$user",i),[i,p]=Q();let n=h(E([])),u=h(!1),c=h(""),l=h(""),o=E([]);const s=a=>{if(o.find(r=>r.name===a.name)){const r=a.name+" already added";R.push(r,{theme:{"--toastBarBackground":"#FF0000"}});return}o.push(a)},M=async()=>{if(v(n,[],!0),e(c)?.length||e(n).push({level:"error",header:"Name must be defined"}),e(l)?.length||e(n).push({level:"error",header:"Content must be defined"}),!e(n).length)try{v(u,!0),await me({name:e(c),content:e(l),ingredients:o}),v(u,!1),m.onUpload()}catch(a){v(u,!1);let r=a.message;a instanceof ue&&a.code===401?r="Invalid logged in user":a instanceof de&&(r="User is logged out");const S=`<strong>Entry not created</strong><br/> ${r}`;R.push(S,{theme:{"--toastBarBackground":"#FF0000"}})}};var t=qe(),b=_(t),B=d(_(b),2);B.__click=()=>pe("/cookbook"),f(b);var L=d(b,2);K(L,17,()=>e(n),P,(a,r)=>{J(a,{get item(){return e(r)}})});var k=d(L,2),q=d(_(k),2);F(q);var $=d(q,4),T=_($);Ie(T,{onAdd:s}),f($);var z=d($,4),V=_(z);fe(V,{get ingredients(){return o},editable:!0}),f(z);var O=d(z,4);re(O),f(k);var W=d(k,2);{var X=a=>{var r=Me();r.__click=M;var S=_(r);{var Z=I=>{ce(I,{size:.5,unit:"em",durationSeconds:.5})},ee=I=>{var te=oe("Submit");y(I,te)};C(S,I=>{e(u)?I(Z):I(ee,!1)})}f(r),j(()=>r.disabled=e(u)),y(a,r)},Y=a=>{var r=Le();y(a,r)};C(W,a=>{g()?a(X):a(Y,!1)})}f(t),A(q,()=>e(c),a=>v(c,a)),A(O,()=>e(l),a=>v(l,a)),y(x,t),U(),p()}D(["click"]);function Ze(x,m){N(m,!1);const g=()=>H(G,"$user",i),[i,p]=Q();_e.set({name:"Cookbook",showAuthInHeader:!0});const n=()=>{console.log("New recipe created")};ie();var u=ne(),c=se(u);{var l=s=>{Ae(s,{onUpload:n})},o=s=>{J(s,{item:{level:"info",header:"Login to add an entry"}})};C(c,s=>{g()?s(l):s(o,!1)})}y(x,u),U(),p()}export{Ze as component};
