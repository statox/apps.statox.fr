import"../chunks/NZTpNUN0.js";import{p as Y,h as y,a8 as Z,i as b,g as e,b as u,f as z,s as i,r as s,a as l,d as ee,ai as de,e as d,t as N,c as ve,j as fe}from"../chunks/D1gec7hp.js";import{s as G}from"../chunks/DqykZqCX.js";import{a as ue}from"../chunks/DUUXyBGe.js";import{i as O}from"../chunks/BQPfd91e.js";import{d as te}from"../chunks/DBXcV7xI.js";import{s as re,a as oe}from"../chunks/CTwF8py8.js";import{m as pe}from"../chunks/ByalMWNf.js";import{u as se}from"../chunks/BBlE0Nps.js";import{M as ie}from"../chunks/YtpDVHPi.js";import{M as ge}from"../chunks/Di7uKeDF.js";import{P as j}from"../chunks/CELBgAxi.js";import{a as _e,A as be}from"../chunks/2lPW6M_J.js";import{s as he}from"../chunks/BgJCQexd.js";import{e as K,i as Q}from"../chunks/Bf0AB_A0.js";import{r as W,s as I}from"../chunks/CwBosGx5.js";import{b as X,d as ye}from"../chunks/cDPM8xt1.js";import{r as xe}from"../chunks/BRRE2dsJ.js";import{t as ne}from"../chunks/D0NjBZpJ.js";import{b as ke}from"../chunks/DvHoaid2.js";import{U as we}from"../chunks/BWptIUEw.js";import{M as Se}from"../chunks/CKDshnsL.js";import"../chunks/CFBOyxUo.js";import"../chunks/DXsQ0dHU.js";import{p as Ue}from"../chunks/L7JTY0uw.js";const Le=!1,ut=Object.freeze(Object.defineProperty({__proto__:null,ssr:Le},Symbol.toStringTag,{value:"Module"})),ae=_e.reactor.getEntriesForPublic,Me=async x=>{const v=j+"/reactor/addEntry";await he.post(v).withCredentials().field("name",x.name).field("commaSeparatedTags",x.commaSeparatedTags).attach("file",x.file)};var Te=u('<span class="tag svelte-noox7t"> </span>'),Ce=u('<video class="medium-margin svelte-noox7t" style="max-width: 100%" controls></video>',2),Re=u('<img class="medium-margin svelte-noox7t"/>'),Ee=u('<div><div><b> </b></div> <div class="svelte-noox7t"></div> <div><button class="full-width svelte-noox7t"><i class="fas fa-copy"></i> Copy link</button></div></div> <div><a rel="noopener noreferrer" target="blank"><!></a></div>',1),Pe=u('<button class="full-width medium-margin svelte-noox7t">More...</button>'),Ae=u('<input class="full-width medium-margin svelte-noox7t" type="text" placeholder="Search by tags or name"/> <div class="container svelte-noox7t"></div> <!>',1);function Fe(x,v){Y(v,!0);const T=10;let L=y(1),C=y(Z([])),c=y("");const w=(a,t)=>{if(!t.length||a.name.toLowerCase().includes(t.toLowerCase()))return!0;for(const m of a.tags)if(m.toLowerCase().includes(t.toLowerCase()))return!0;return!1},S=a=>{navigator.clipboard.writeText(j+a.uri),ne.push('<i class="fas fa-check"></i> Link copied to clipboard',{duration:1e3,theme:{"--toastBarHeight":0}})},k=a=>a.s3PresignedUrl.includes(".mp4");xe(()=>{b(C,v.reactions.filter(a=>w(a,e(c))).sort((a,t)=>t.creationDateUnix-a.creationDateUnix).slice(0,e(c).length?void 0:e(L)*T),!0)});var g=Ae(),_=z(g);W(_);var M=i(_,2);K(M,21,()=>e(C),Q,(a,t)=>{var n=Ee(),m=z(n),p=d(m),$=d(p),D=d($,!0);s($),s(p);var E=i(p,2);K(E,21,()=>e(t).tags,Q,(h,r)=>{var f=Te(),q=d(f,!0);s(f),N(()=>G(q,e(r))),l(h,f)}),s(E);var P=i(E,2),B=d(P);B.__click=()=>S(e(t)),s(P),s(m);var A=i(m,2),U=d(A),V=d(U);{var H=h=>{var r=Ce();N(()=>I(r,"src",j+e(t).uri)),l(h,r)},J=h=>{var r=Re();N(()=>{I(r,"src",j+e(t).uri),I(r,"alt",e(t).name)}),l(h,r)};O(V,h=>{k(e(t))?h(H):h(J,!1)})}s(U),s(A),N(()=>{G(D,e(t).name),I(U,"href",j+e(t).uri),I(U,"download",e(t).name)}),l(a,n)}),s(M);var R=i(M,2);{var o=a=>{var t=Pe();t.__click=()=>de(L),l(a,t)};O(R,a=>{e(c).length===0&&e(L)*T<v.reactions.length&&a(o)})}X(_,()=>e(c),a=>b(c,a)),l(x,g),ee()}te(["click"]);var Ne=u('<button class="form-action svelte-1kgynly"><!></button>'),Oe=u('<span class="form-action svelte-1kgynly">Login to upload an entry</span>'),Be=u('<div role="dialog" class="modal svelte-1kgynly"><div class="contents svelte-1kgynly"><h4 class="title-bar svelte-1kgynly">Add a new file <button>Close</button></h4> <!> <form class="form-content svelte-1kgynly"><label for="name">Name</label> <input type="text"/> <label for="content">Tags</label> <input type="textarea"/> <label for="file">File</label> <span><input class="file-input svelte-1kgynly" type="file"/> <button aria-label="delete file"><i class="fas fa-times-circle"></i></button></span> <br/> <!></form></div></div>');function Ie(x,v){Y(v,!0);const T=()=>oe(se,"$user",L),[L,C]=re();let c=y(Z([])),w=y(""),S=y(""),k=y(void 0),g=y(void 0),_=y(!1);const M=async()=>{b(c,[],!0),e(w)?.length||e(c).push({level:"error",header:"name must be defined"});let t;if(e(g)&&e(g).length&&(t=e(g)[0]),t||e(c).push({level:"error",header:"a file must be uploaded"}),!(e(c).length||!t))try{b(_,!0),await Me({name:e(w),commaSeparatedTags:e(S),file:t}),b(_,!1),v.onUpload(),v.close()}catch(n){b(_,!1);let m=n.message;n instanceof be&&n.code===401?m="Invalid logged in user":n instanceof we&&(m="User is logged out");const p=`<strong>Entry not created</strong><br/> ${m}`;ne.push(p,{theme:{"--toastBarBackground":"#FF0000"}})}};var R=ve(),o=z(R);{var a=t=>{var n=Be(),m=d(n),p=d(m),$=i(d(p));$.__click=function(...r){v.close?.apply(this,r)},s(p);var D=i(p,2);K(D,17,()=>e(c),Q,(r,f)=>{ie(r,{get item(){return e(f)}})});var E=i(D,2),P=i(d(E),2);W(P);var B=i(P,4);W(B);var A=i(B,4),U=d(A);ke(U,r=>b(k,r),()=>e(k));var V=i(U,2);V.__click=()=>{e(k)!==void 0&&(e(k).value="")},s(A);var H=i(A,4);{var J=r=>{var f=Ne();f.__click=M;var q=d(f);{var le=F=>{Se(F,{size:.5,unit:"em",durationSeconds:.5})},ce=F=>{var me=fe("Submit");l(F,me)};O(q,F=>{e(_)?F(le):F(ce,!1)})}s(f),N(()=>f.disabled=e(_)),l(r,f)},h=r=>{var f=Oe();l(r,f)};O(H,r=>{T()?r(J):r(h,!1)})}s(E),s(m),s(n),X(P,()=>e(w),r=>b(w,r)),X(B,()=>e(S),r=>b(S,r)),ye(U,()=>e(g),r=>b(g,r)),l(t,n)};O(o,t=>{v.isOpen&&t(a)})}l(x,R),ee(),C()}te(["click"]);var je=u("<button>Add an entry</button>"),ze=u("<p>Something went wrong</p> <p> </p>",1),$e=u("<p>Loading data</p>"),De=u("<!> <h2>Upload</h2> <!> <h2>Content</h2> <!>",1);function pt(x,v){Y(v,!0);const T=()=>oe(se,"$user",L),[L,C]=re();Ue.set("Reactor");let c=y(Z(ae()));const w=()=>b(c,ae(),!0);var S=De(),k=z(S);ge(k,{title:"Reactor",description:"My collection of memes"});var g=i(k,4);{var _=o=>{var a=je();a.__click=()=>pe.open(Ie,{onUpload:w}),l(o,a)},M=o=>{ie(o,{item:{level:"info",header:"Login to add an entry"}})};O(g,o=>{T()?o(_):o(M,!1)})}var R=i(g,4);ue(R,()=>e(c),o=>{var a=$e();l(o,a)},(o,a)=>{Fe(o,{get reactions(){return e(a)}})},(o,a)=>{var t=ze(),n=i(z(t),2),m=d(n,!0);s(n),N(p=>G(m,p),[()=>JSON.stringify(e(a))]),l(o,t)}),l(x,S),ee(),C()}te(["click"]);export{pt as component,ut as universal};
