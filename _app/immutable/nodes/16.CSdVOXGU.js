import"../chunks/NZTpNUN0.js";import{z as re,A as Z,B as se,p as L,f as O,F as k,x as R,a as m,E as le,v as E,s as w,g as s,aZ as b,G as M,a_ as j,c as q}from"../chunks/Br9SMxIB.js";import{d as ie,s as ae}from"../chunks/BBzb7ThI.js";import{i as D}from"../chunks/CvXxFVm9.js";import{e as H,i as J}from"../chunks/D1-nhZYT.js";import{a as oe,s as ce,c as K}from"../chunks/DWdbj9D8.js";import{M as ue}from"../chunks/DKmGubEx.js";var _=(e=>(e[e.notOver=0]="notOver",e[e.winPlayer1=1]="winPlayer1",e[e.winPlayer2=2]="winPlayer2",e[e.draw=3]="draw",e))(_||{});const x=7,p=6,u=4;class fe extends Error{constructor(t){super("Can't play in column "+t)}}const N=(e,t)=>e[t].length!==p,ve=e=>{const t=x*p,n=e.reduce((l,c)=>l+c.length,0);return t===n},ge=e=>{for(let t=0;t<x;t++)for(let n=0;n<p;n++){if(e[t].length<n||!e[t][n])continue;const l=e[t][n];let c=0,f=0,v=0,i=0;for(let r=0;r<u;r++)n+r<=e[t].length&&e[t][n+r]===l&&c++,t+r<e.length&&e[t+r][n]===l&&f++,t+r<e.length&&n+r<=e[t+r].length&&e[t+r][n+r]===l&&v++,t+r<e.length&&n-r>=0&&e[t+r][n-r]===l&&i++;if(c===u||f===u||v===u||i===u)return l}return null},he=e=>{if(P(e)===0)return null;for(let t=0;t<x;t++)for(let n=0;n<p;n++){if(e[t].length<n||!e[t][n])continue;const l=e[t][n],c=[],f=[],v=[],i=[];for(let r=0;r<u;r++)n+r<=e[t].length&&e[t][n+r]===l&&c.push([n+r,t]),t+r<e.length&&e[t+r][n]===l&&f.push([n,t+r]),t+r<e.length&&n+r<=e[t+r].length&&e[t+r][n+r]===l&&v.push([n+r,t+r]),t+r<e.length&&n-r>=0&&e[t+r][n-r]===l&&i.push([n-r,t+r]);if(c.length===u)return c;if(f.length===u)return f;if(v.length===u)return v;if(i.length===u)return i}return null},P=e=>{if(ve(e))return 3;const t=ge(e);return t===1?1:t===2?2:0},Q=(e,t,n)=>{if(!N(e,n))throw new fe(n);return e[n].push(t),e},pe=e=>{const t=[];for(let l=0;l<e.length;l++)e[l].length<p&&t.push(l);const n=Math.floor(Math.random()*t.length);return t[n]},me=(e,t)=>{const n=pe(e);return Q(e,t,n)},_e=(e,t,n)=>{w(t,Array.from({length:7},()=>[]),!0),w(n,1)};var we=(e,t,n,l)=>t(s(n),s(l)),ye=L("<div><button><div></div></button></div>"),de=L('<!> <div class="main"><h3>Gravitrip</h3></div> <span><button>Restart game</button> <span style="font-weight: bold"><!></span></span> <div class="board svelte-1bdwycb"></div>',1);function Ie(e,t){re(t,!0);let n=Z(se(Array.from({length:7},()=>[]))),l=b(()=>P(s(n))),c=b(()=>he(s(n)));const f=Array.from({length:p},(o,a)=>a),v=Array.from({length:x},(o,a)=>a);let i=Z(1);const r=(o,a)=>{s(i)===1&&N(s(n),o)&&P(s(n))===_.notOver&&(w(n,Q(s(n),a,o),!0),w(i,s(i)===1?2:1,!0),setTimeout(()=>U(),300))},U=()=>{s(i)===2&&P(s(n))===_.notOver&&(w(n,me(s(n),s(i)),!0),w(i,s(i)===1?2:1,!0))},X=(o,a)=>s(c)===null?!1:s(c).filter(h=>h[0]===o&&h[1]===a).length>0;var W=de(),F=O(W);ue(F,{title:"Gravitrip",description:"Gravitrip"});var A=E(F,4),$=k(A);$.__click=[_e,n,i];var z=E($,2),Y=k(z);{var B=o=>{var a=j("Game Over");m(o,a)},S=o=>{var a=q(),h=O(a);{var G=y=>{var g=j();R(()=>ae(g,`Player ${s(l)??""} wins`)),m(y,g)};D(h,y=>{(s(l)===_.winPlayer1||s(l)===_.winPlayer2)&&y(G)},!0)}m(o,a)};D(Y,o=>{s(l)===_.draw?o(B):o(S,!1)})}M(z),M(A);var C=E(A,2);H(C,21,()=>f.reverse(),J,(o,a)=>{var h=q(),G=O(h);H(G,17,()=>v,J,(y,g)=>{var I=ye(),d=k(I);let T;d.__click=[we,r,g,i];var ee=k(d);let V;M(d),M(I),R((te,ne)=>{ce(d,"aria-label","col-"+s(g)),T=K(d,1,"outer-cell svelte-1bdwycb",null,T,te),V=K(ee,1,"cell svelte-1bdwycb",null,V,ne)},[()=>({"winning-cell":X(s(a),s(g))}),()=>({player1:s(n)[s(g)][s(a)]===1,player2:s(n)[s(g)][s(a)]===2})]),m(y,I)}),m(o,h)}),M(C),R(()=>oe(C,`--nb-col: ${x}; --nb-row: ${p}`)),m(e,W),le()}ie(["click"]);export{Ie as component};
