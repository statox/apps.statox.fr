import"../chunks/NZTpNUN0.js";import"../chunks/DvQ7C2d6.js";import{p as A,b as w,i as _,s as d,g as e,j as ae,e as h,r as f,a as y,d as B,h as v,t as j,a8 as E,b8 as re,k as oe,c as ne,f as se}from"../chunks/BjuhH6lp.js";import{i as F}from"../chunks/Cw8fytvj.js";import{i as ie}from"../chunks/CIh8kkY-.js";import{s as Q,a as G}from"../chunks/u5ZAmcyg.js";import{u as H,A as le,U as de}from"../chunks/DHfKupDm.js";import{M as J}from"../chunks/DaF2b9q9.js";import{d as D,s as ue}from"../chunks/BHQPUIUI.js";import{e as K,i as P}from"../chunks/CLKJSt8A.js";import{r as U}from"../chunks/DEs50KOR.js";import{b as N}from"../chunks/BszEGJcu.js";import{M as ce}from"../chunks/Cm6lANdz.js";import{t as R}from"../chunks/Djhp2DQ4.js";import{a as ve,b as me}from"../chunks/DKxYhzyq.js";import{g as pe}from"../chunks/BPf85_O0.js";import{I as fe}from"../chunks/DuYoX_lX.js";import{o as ge}from"../chunks/C8sgD566.js";import{p as be}from"../chunks/9qhOkvj8.js";import{p as _e}from"../chunks/DEIc314f.js";var he=w('<div class="option svelte-hwqdr1"> </div>'),ye=w('<div class="dropdown svelte-hwqdr1"></div>'),ke=w('<span><input type="text" class="svelte-hwqdr1"/> <!></span>');function xe(x,m){A(m,!0);const g=t=>t.normalize("NFD").replace(/[\u0300-\u036f]/g,"");let i=be(m,"value",15),p=h(!1),n=ae(()=>m.options.filter(t=>i().length<2?!1:g(t).toLowerCase().includes(g(i()).toLowerCase())));function u(t){i(t),v(p,!0)}const c=()=>{v(p,!1)};var l=ke(),o=_(l);U(o),o.__input=c;var s=d(o,2);{var M=t=>{var b=ye();K(b,21,()=>e(n),P,(C,q)=>{var k=he();k.__click=()=>u(e(q));var L=_(k,!0);f(k),j(()=>ue(L,e(q))),y(C,k)}),f(b),y(t,b)};F(s,t=>{e(n).length>0&&!e(p)&&t(M)})}f(l),N(o,i),y(x,l),B()}D(["input","click"]);var we=w('<div class="input-container svelte-yzduke"><label for="name">Ingredient</label> <!> <label for="quantity">Quantity</label> <input type="number"/> <label for="quantity">Unit</label> <input type="text"/> <button><i class="fa fa-solid fa-plus"></i></button></div>');function Ie(x,m){A(m,!0);let g=h(E([])),i=h(""),p=h(void 0),n=h(void 0);const u=()=>{e(i)&&m.onAdd({name:e(i),quantity:e(p),unit:e(n)})};ge(async()=>{v(g,(await ve()).ingredients.sort((t,b)=>t<b?1:0).map(t=>t.name),!0)});var c=we(),l=d(_(c),2);xe(l,{get options(){return e(g)},get value(){return e(i)},set value(t){v(i,t,!0)}});var o=d(l,4);U(o);var s=d(o,4);U(s);var M=d(s,2);M.__click=u,f(c),N(o,()=>e(p),t=>v(p,t)),N(s,()=>e(n),t=>v(n,t)),y(x,c),B()}D(["click"]);var Me=w('<button class="form-action svelte-1ycbaol"><!></button>'),qe=w('<span class="form-action svelte-1ycbaol">Login to upload an entry</span>'),Le=w('<div class="contents svelte-1ycbaol"><span class="title-bar svelte-1ycbaol"><h2>Add a new recipe</h2> <button class="svelte-1ycbaol">Back to list</button></span> <!> <div class="form-content svelte-1ycbaol"><label for="name">Name</label> <input type="text"/> <label for="ingredients">New ingredient</label> <div><!></div> <label for="ingredients">List of ingredients</label> <div><!></div> <label for="content">Instructions</label> <textarea rows="10" cols="50"></textarea></div> <!></div>');function Ne(x,m){A(m,!0);const g=()=>Q(H,"$user",i),[i,p]=G();let n=h(E([])),u=h(!1),c=h(""),l=h(""),o=E([]);const s=a=>{if(o.find(r=>r.name===a.name)){const r=a.name+" already added";R.push(r,{theme:{"--toastBarBackground":"#FF0000"}});return}o.push(a)},M=async()=>{if(v(n,[],!0),e(c)?.length||e(n).push({level:"error",header:"Name must be defined"}),e(l)?.length||e(n).push({level:"error",header:"Content must be defined"}),!e(n).length)try{v(u,!0),await me({name:e(c),content:e(l),ingredients:o}),v(u,!1),m.onUpload()}catch(a){v(u,!1);let r=a.message;a instanceof le&&a.code===401?r="Invalid logged in user":a instanceof de&&(r="User is logged out");const S=`<strong>Entry not created</strong><br/> ${r}`;R.push(S,{theme:{"--toastBarBackground":"#FF0000"}})}};var t=Le(),b=_(t),C=d(_(b),2);C.__click=()=>pe("/cookbook"),f(b);var q=d(b,2);K(q,17,()=>e(n),P,(a,r)=>{J(a,{get item(){return e(r)}})});var k=d(q,2),L=d(_(k),2);U(L);var $=d(L,4),T=_($);Ie(T,{onAdd:s}),f($);var z=d($,4),V=_(z);fe(V,{get ingredients(){return o},editable:!0}),f(z);var O=d(z,4);re(O),f(k);var W=d(k,2);{var X=a=>{var r=Me();r.__click=M;var S=_(r);{var Z=I=>{ce(I,{size:.5,unit:"em",durationSeconds:.5})},ee=I=>{var te=oe("Submit");y(I,te)};F(S,I=>{e(u)?I(Z):I(ee,!1)})}f(r),j(()=>r.disabled=e(u)),y(a,r)},Y=a=>{var r=qe();y(a,r)};F(W,a=>{g()?a(X):a(Y,!1)})}f(t),N(L,()=>e(c),a=>v(c,a)),N(O,()=>e(l),a=>v(l,a)),y(x,t),B(),p()}D(["click"]);function Ve(x,m){A(m,!1);const g=()=>Q(H,"$user",i),[i,p]=G();_e.set("Cookbook");const n=()=>{console.log("New recipe created")};ie();var u=ne(),c=se(u);{var l=s=>{Ne(s,{onUpload:n})},o=s=>{J(s,{item:{level:"info",header:"Login to add an entry"}})};F(c,s=>{g()?s(l):s(o,!1)})}y(x,u),B(),p()}export{Ve as component};
