import"./disclose-version.Bg9kRutz.js";import{aY as B,p as G,aH as E,aN as H,g as m,s as k,o as K,aV as N,aF as O,aG as D,w as I,k as V,n as Y}from"./index-client.CwKaIs20.js";import{m as J,s as M,a as P,t as F}from"./template.O5anSWHx.js";import{i as Q}from"./if.Bi_20hhT.js";import{h as R}from"./html.0La2KL8r.js";import{a as U}from"./attributes.CgIpNMpF.js";import{t as W}from"./service.C6Mx57nS.js";import{p as x}from"./proxy.CJQ3oePJ.js";import{s as X,a as Z}from"./store.ChaSGJXD.js";const $=()=>performance.now(),p={tick:e=>requestAnimationFrame(e),now:()=>$(),tasks:new Set};function L(){const e=p.now();p.tasks.forEach(t=>{t.c(e)||(p.tasks.delete(t),t.f())}),p.tasks.size!==0&&p.tick(L)}function tt(e){let t;return p.tasks.size===0&&p.tick(L),{promise:new Promise(f=>{p.tasks.add(t={c:e,f})}),abort(){p.tasks.delete(t)}}}function S(e){return e}function yt(e){const t=e-1;return t*t*t+1}const et={duration:4e3,initial:1,next:0,pausable:!1,dismissable:!0,reversed:!1,intro:{x:256}};function st(){const{subscribe:e,update:t}=B([]),f={};let c=0;function i(n="default",r={}){return f[n]=r,f}function s(n,r){const a={target:"default",msg:n,...r},l=f[a.target]||{},d={...et,...l,...a,theme:{...l.theme,...a.theme},classes:[...l.classes||[],...a.classes||[]],id:++c};return t(y=>d.reversed?[...y,d]:[d,...y]),c}function o(n){t(r=>{if(!r.length||n===0)return[];if(n===void 0){const a=Math.max(...r.map(l=>l.id));return r.filter(l=>l.id!==a)}return typeof n=="number"?r.filter(a=>a.id!==n):r.filter(a=>a.target!==n.target)})}return{subscribe:e,push:s,pop:o,_init:i}}const nt=st();function z(e){return Object.prototype.toString.call(e)==="[object Date]"}function A(e,t){if(e===t||e!==e)return()=>e;const f=typeof e;if(f!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const c=t.map((i,s)=>A(e[s],i));return i=>c.map(s=>s(i))}if(f==="object"){if(!e||!t)throw new Error("Object cannot be null");if(z(e)&&z(t)){const s=e.getTime(),n=t.getTime()-s;return r=>new Date(s+r*n)}const c=Object.keys(t),i={};return c.forEach(s=>{i[s]=A(e[s],t[s])}),s=>{const o={};return c.forEach(n=>{o[n]=i[n](s)}),o}}if(f==="number"){const c=t-e;return i=>e+i*c}return()=>t}function rt(e,t={}){const f=B(e);let c,i=e;function s(o,n){if(i=o,e==null)return f.set(e=o),Promise.resolve();let r=c,a=!1,{delay:l=0,duration:d=400,easing:y=S,interpolate:_=A}={...t,...n};if(d===0)return r&&(r.abort(),r=null),f.set(e=i),Promise.resolve();const b=p.now()+l;let g;return c=tt(h=>{if(h<b)return!0;a||(g=_(e,o),typeof d=="function"&&(d=d(e,o)),a=!0),r&&(r.abort(),r=null);const w=h-b;return w>d?(f.set(e=o),!1):(f.set(e=g(y(w/d))),!0)}),c.promise}return{set:s,update:(o,n)=>s(o(i,e),n),subscribe:f.subscribe}}var it=(e,t)=>{e instanceof KeyboardEvent&&["Enter"," "].includes(e.key)&&t()},ot=F('<div class="_toastBtn pe svelte-1yg7ke" role="button" tabindex="0"></div>'),at=F('<div role="status" class="_toastItem svelte-1yg7ke"><div class="_toastMsg svelte-1yg7ke"><!></div> <!> <progress class="_toastBar svelte-1yg7ke"></progress></div>');function ht(e,t){G(t,!0);const[f,c]=X(),i=()=>Z(a,"$progress",f);let s=E(x(t.item.initial)),o=E(x(t.item.initial)),n=E(!1),r;const a=rt(t.item.initial,{duration:t.item.duration,easing:S});function l(){nt.pop(t.item.id)}function d(){(i()===1||i()===0)&&l()}function y(){!m(n)&&i()!==m(s)&&(a.set(i(),{duration:0}),k(n,!0))}function _(){if(m(n)){const u=t.item.duration;if(u!==void 0&&m(o)!==void 0&&m(s)!==void 0){const v=u-u*((i()-m(o))/(m(s)-m(o)));a.set(m(s),{duration:v}).then(d)}k(n,!1)}}function b(u=document){if(u.hidden===void 0)return;const v=()=>u.hidden?y():_(),j="visibilitychange";u.addEventListener(j,v),r=()=>u.removeEventListener(j,v),v()}H(()=>{if(m(s)!==t.item.next){if(k(s,x(t.item.next)),k(o,x(i())),k(n,!1),m(s)===void 0)throw Error("Toast with undefined next");a.set(m(s)).then(d)}}),K(b),N(()=>{var u;(u=t.item)!=null&&u.onpop&&t.item.onpop(t.item.id),r==null||r()});var g=at(),h=O(g),w=O(h);R(w,()=>t.item.msg,!1,!1),D(h);var T=I(h,2);{var q=u=>{var v=ot();v.__click=l,v.__keydown=[it,l],P(u,v)};Q(T,u=>{t.item.dismissable&&u(q)})}var C=I(T,2);D(g),V(()=>{W(g,"pe",t.item.pausable),U(C,i())}),M("mouseenter",g,()=>{t.item.pausable&&y()}),M("mouseleave",g,_),P(e,g),Y(),c()}J(["click","keydown"]);export{ht as T,yt as c,tt as l,nt as t};
