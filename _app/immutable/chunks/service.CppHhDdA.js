import{p as l}from"./stores.FrlLjo_N.js";import{w as r,g as d}from"./entry.DMFvKCAJ.js";import{o as u}from"./auth0-spa-js.production.esm.D13UjCU2.js";import{b as g,c as h,d as m,e as w}from"./public.xpUinP6t.js";import{x as a}from"./scheduler.C95i7-0j.js";const i={domain:g,clientId:h,audience:m,callback:w};class U extends Error{constructor(){super("USER_LOGGED_OUT")}}const e=r(),s=r(),C=async()=>{const t=await u({domain:i.domain,clientId:i.clientId,authorizationParams:{redirect_uri:i.callback,audience:i.audience},cacheLocation:"localstorage",useRefreshTokens:!0});e.set(t);const o=window.location.search;if((o.includes("code=")||o.includes("error="))&&o.includes("state=")){const{appState:c}=await a(e).handleRedirectCallback();window.history.replaceState({},document.title,window.location.pathname),d(c.returnTo||"/")}await a(e).isAuthenticated()?s.set(await a(e).getUser()):s.set(void 0),n()},L=()=>{const t=a(l).url.pathname;a(e).loginWithRedirect({appState:{returnTo:t}})},k=()=>a(e).logout(),y=async()=>{var t;try{const o=await((t=a(e))==null?void 0:t.getTokenSilently());return s.set(await a(e).getUser()),o}catch{throw s.set(void 0),new U}},n=async()=>{var t;try{const o=await((t=a(e))==null?void 0:t.getTokenSilently());return s.set(await a(e).getUser()),o}catch{s.set(void 0)}setTimeout(n,1e3*60*5)};export{U,L as a,y as g,C as i,k as l,s as u};
