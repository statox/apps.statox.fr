import"./disclose-version.Bg9kRutz.js";import{a$ as B,p as K,aX as E,aP as X,g as m,s as _,v as Y,aY as G,al as O,am as P,z,w as H,x as J}from"./index-client.CflxByDC.js";import{n as N,f as D,a as I,t as L}from"./template.BNipMNgO.js";import{i as Q}from"./if.DypW3AvO.js";import{h as R}from"./html.DzN11szd.js";import{a as U}from"./attributes.Cbh5jV0V.js";import{t as V}from"./service.CBRyajoN.js";import{a as x}from"./props.B1tCRvRm.js";import{s as W,a as Z}from"./store.Bv-UhthR.js";const $=()=>performance.now(),p={tick:e=>requestAnimationFrame(e),now:()=>$(),tasks:new Set};function S(){const e=p.now();p.tasks.forEach(t=>{t.c(e)||(p.tasks.delete(t),t.f())}),p.tasks.size!==0&&p.tick(S)}function tt(e){let t;return p.tasks.size===0&&p.tick(S),{promise:new Promise(f=>{p.tasks.add(t={c:e,f})}),abort(){p.tasks.delete(t)}}}function q(e){return e}function yt(e){const t=e-1;return t*t*t+1}const et={duration:4e3,initial:1,next:0,pausable:!1,dismissable:!0,reversed:!1,intro:{x:256}};function st(){const{subscribe:e,update:t}=B([]),f={};let c=0;function i(n="default",r={}){return f[n]=r,f}function s(n,r){const a={target:"default",msg:n,...r},l=f[a.target]||{},d={...et,...l,...a,theme:{...l.theme,...a.theme},classes:[...l.classes||[],...a.classes||[]],id:++c};return t(y=>d.reversed?[...y,d]:[d,...y]),c}function o(n){t(r=>{if(!r.length||n===0)return[];if(n===void 0){const a=Math.max(...r.map(l=>l.id));return r.filter(l=>l.id!==a)}return typeof n=="number"?r.filter(a=>a.id!==n):r.filter(a=>a.target!==n.target)})}return{subscribe:e,push:s,pop:o,_init:i}}const nt=st();function M(e){return Object.prototype.toString.call(e)==="[object Date]"}function A(e,t){if(e===t||e!==e)return()=>e;const f=typeof e;if(f!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const c=t.map((i,s)=>A(e[s],i));return i=>c.map(s=>s(i))}if(f==="object"){if(!e||!t)throw new Error("Object cannot be null");if(M(e)&&M(t)){const s=e.getTime(),n=t.getTime()-s;return r=>new Date(s+r*n)}const c=Object.keys(t),i={};return c.forEach(s=>{i[s]=A(e[s],t[s])}),s=>{const o={};return c.forEach(n=>{o[n]=i[n](s)}),o}}if(f==="number"){const c=t-e;return i=>e+i*c}return()=>t}function rt(e,t={}){const f=B(e);let c,i=e;function s(o,n){if(i=o,e==null)return f.set(e=o),Promise.resolve();let r=c,a=!1,{delay:l=0,duration:d=400,easing:y=q,interpolate:b=A}={...t,...n};if(d===0)return r&&(r.abort(),r=null),f.set(e=i),Promise.resolve();const k=p.now()+l;let g;return c=tt(h=>{if(h<k)return!0;a||(g=b(e,o),typeof d=="function"&&(d=d(e,o)),a=!0),r&&(r.abort(),r=null);const w=h-k;return w>d?(f.set(e=o),!1):(f.set(e=g(y(w/d))),!0)}),c.promise}return{set:s,update:(o,n)=>s(o(i,e),n),subscribe:f.subscribe}}var it=(e,t)=>{e instanceof KeyboardEvent&&["Enter"," "].includes(e.key)&&t()},ot=L('<div class="_toastBtn pe svelte-1yg7ke" role="button" tabindex="0"></div>'),at=L('<div role="status" class="_toastItem svelte-1yg7ke"><div class="_toastMsg svelte-1yg7ke"><!></div> <!> <progress class="_toastBar svelte-1yg7ke"></progress></div>');function ht(e,t){K(t,!0);const[f,c]=W(),i=()=>Z(a,"$progress",f);let s=E(x(t.item.initial)),o=E(x(t.item.initial)),n=E(!1),r;const a=rt(t.item.initial,{duration:t.item.duration,easing:q});function l(){nt.pop(t.item.id)}function d(){(i()===1||i()===0)&&l()}function y(){!m(n)&&i()!==m(s)&&(a.set(i(),{duration:0}),_(n,!0))}function b(){if(m(n)){const u=t.item.duration;if(u!==void 0&&m(o)!==void 0&&m(s)!==void 0){const v=u-u*((i()-m(o))/(m(s)-m(o)));a.set(m(s),{duration:v}).then(d)}_(n,!1)}}function k(u=document){if(u.hidden===void 0)return;const v=()=>u.hidden?y():b(),j="visibilitychange";u.addEventListener(j,v),r=()=>u.removeEventListener(j,v),v()}X(()=>{if(m(s)!==t.item.next){if(_(s,x(t.item.next)),_(o,x(i())),_(n,!1),m(s)===void 0)throw Error("Toast with undefined next");a.set(m(s)).then(d)}}),Y(k),G(()=>{var u;(u=t.item)!=null&&u.onpop&&t.item.onpop(t.item.id),r==null||r()});var g=at(),h=O(g),w=O(h);R(w,()=>t.item.msg,!1,!1),P(h);var T=z(h,2);{var C=u=>{var v=ot();v.__click=l,v.__keydown=[it,l],I(u,v)};Q(T,u=>{t.item.dismissable&&u(C)})}var F=z(T,2);P(g),H(()=>{V(g,"pe",t.item.pausable),U(F,i())}),D("mouseenter",g,()=>{t.item.pausable&&y()}),D("mouseleave",g,b),I(e,g),J(),c()}N(["click","keydown"]);export{ht as T,yt as c,tt as l,nt as t};
